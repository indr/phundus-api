!function(a){function b(a){var b="01",c={};for(var d in a){var e=parseInt(b,2);c[a[d]]={bitMask:e,title:a[d]},b=(e<<1).toString(2)}return c}function c(a,b){var c={};for(var d in a){var e,f;if("string"==typeof a[d])if("*"===a[d]){f="";for(e in b)f+="1";c[d]={bitMask:parseInt(f,2)}}else console.log("Access Control Error: Could not parse '"+a[d]+"' as access definition for level '"+d+"'");else{f=0;for(e in a[d])b.hasOwnProperty(a[d][e])?f|=b[a[d][e]].bitMask:console.log("Access Control Error: Could not find role '"+a[d][e]+"' in registered roles while building access for '"+d+"'");c[d]={bitMask:f}}}return c}var d={roles:["public","user","manager","admin"],accessLevels:{"public":"*",anon:["public"],user:["user","manager","admin"],manager:["manager","admin"],admin:["admin"]}};a.userRoles=b(d.roles),a.accessLevels=c(d.accessLevels,a.userRoles)}("undefined"==typeof exports?this.routingConfig={}:exports);var app=angular.module("phundusApp",["angularMoment","blueimp.fileupload","leaflet-directive","ngCookies","ngHolder","ngMessages","ngResource","ngSanitize","smart-table","ui.bootstrap","ui.gravatar","ui.router","ui.tinymce","mwl.confirm"]).constant("_",window._).constant("$",window.$).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(a,b,c,d){var e=window.routingConfig.accessLevels;a.state("public",{"abstract":!0,template:"<ui-view/>",data:{access:e["public"]}}).state("public.feedback",{url:"/feedback",templateUrl:"views/public/feedback.html",controller:"MetaFeedbackCtrl"}).state("public.index",{url:"/",templateUrl:"views/shop/index.html",controller:"ShopIndexCtrl"}).state("public.shop-item",{url:"/shop/:itemId",templateUrl:"views/shop/shop-item.html",controller:"ShopItemCtrl",resolve:{itemId:["$stateParams",function(a){return a.itemId}]}}).state("public.organizations",{url:"/organizations",templateUrl:"views/organizations.html",controller:"OrganizationsCtrl"}).state("public.organization",{url:"/organizations/:organizationId",templateUrl:"views/organizations/home.html",controller:"OrganizationCtrl",resolve:{organizationId:["$stateParams",function(a){return a.organizationId}]}}).state("public.logout",{url:"/logout",templateUrl:"views/account/logout.html",controller:"LogoutCtrl"}).state("public.404",{url:"/404",templateUrl:"views/404.html"}).state("public.debug",{url:"/debug",templateUrl:"views/debug.html",controller:"DebugCtrl"}).state("public.validate-account",{url:"/validate/account?key",templateUrl:"views/public/validate-account.html",controller:"MetaValidateCtrl",resolve:{key:["$stateParams",function(a){return console.log(a),a.key}]}}).state("public.validate-e-mail-address",{url:"/validate/email-address?key",templateUrl:"views/public/validate-email-address.html",controller:"MetaValidateCtrl",resolve:{key:["$stateParams",function(a){return a.key}]}}),a.state("anon",{"abstract":!0,template:"<ui-view/>",data:{access:e.anon}}).state("anon.signup",{url:"/signup",templateUrl:"views/account/signup.html",controller:"SignUp"}).state("anon.login",{url:"/login",data:{access:e["public"]},templateUrl:"views/account/login.html",controller:"LoginCtrl"}).state("anon.loggedout",{url:"/logged-out",templateUrl:"views/account/logged-out.html"}).state("anon.reset-password",{url:"/forgot",templateUrl:"views/account/reset-password.html",controller:"ResetPasswordCtrl"}),a.state("cart",{url:"/cart",data:{access:e.user},templateUrl:"views/shop/cart.html",controller:"ShopCartCtrl",resolve:{userId:["Auth",function(a){return a.user.userId}]}}).state("checkout",{url:"/checkout",data:{access:e.user},templateUrl:"views/shop/checkout.html",controller:"ShopCheckoutCtrl",resolve:{userId:["Auth",function(a){return a.user.userId}]}}).state("user",{"abstract":!0,url:"/users/:userId",data:{access:e.user},template:'<ph-user-navbar data-user-id="userId"></ph-user-navbar><ui-view/>',controller:"UsersCtrl",resolve:{userId:["$stateParams",function(a){return a.userId}]}}).state("user.home",{url:"",templateUrl:"views/users/home.html",controller:"UsersHomeCtrl"}).state("user.account",{url:"/account",templateUrl:"views/users/account.html",controller:"UsersAccountCtrl"}).state("user.articles",{"abstract":!0,url:"/articles",template:"<ui-view/>"}).state("user.articles.index",{url:"/",templateUrl:"views/users/articles.html",controller:"UsersArticlesIndexCtrl"}).state("user.articles.article",{"abstract":!0,url:"/articles/:articleId/:articleShortId",template:'<ph-user-article-navbar data-user-id="userId" data-article-id="articleId" data-article-short-id="articleShortId"></ph-user-article-navbar><ui-view/>',controller:["$scope","userId","articleId","articleShortId",function(a,b,c,d){a.userId=b,a.articleId=c,a.articleShortId=d}],resolve:{articleId:["$stateParams",function(a){return a.articleId}],articleShortId:["$stateParams",function(a){return a.articleShortId}]}}).state("user.articles.article.actions",{url:"/actions",templateUrl:"views/inventory/article-actions.html",controller:"ArticlesActionsCtrl"}).state("user.articles.article.details",{url:"/",templateUrl:"views/manage/edit-article-details.html",controller:"UsersArticlesDetailsCtrl"}).state("user.articles.article.description",{url:"/description",templateUrl:"views/manage/edit-article-description.html",controller:"UsersArticlesDescriptionCtrl"}).state("user.articles.article.specification",{url:"/specification",templateUrl:"views/manage/edit-article-specification.html",controller:"UsersArticlesSpecificationCtrl"}).state("user.articles.article.stock",{url:"/stock",templateUrl:"views/manage/edit-article-stock.html",controller:"UsersArticlesStockCtrl"}).state("user.articles.article.files",{url:"/files",templateUrl:"views/manage/edit-article-files.html",controller:"UsersArticlesFilesCtrl"}).state("user.orders",{"abstract":!0,url:"/orders",template:"<ui-view/>"}).state("user.orders.index",{url:"/",templateUrl:"views/users/orders.html",controller:"ManageUserOrdersCtrl"}).state("user.orders.order",{url:"/{orderId}",templateUrl:"views/users/order.html",controller:"ManageUserOrderCtrl",resolve:{orderId:["$stateParams",function(a){return a.orderId}]}}),a.state("manage",{"abstract":!0,data:{access:e.user},url:"/manage",template:"<ui-view></ui-view>"}).state("manage.organization",{"abstract":!0,data:{access:e.manager},url:"/organizations/{organizationId}",template:'<ph-organization-navbar data-organization-id="organizationId"></ph-organization-navbar><ui-view></ui-view>',controller:["$scope","organizationId",function(a,b){a.organizationId=b}],resolve:{organizationId:["$stateParams",function(a){return a.organizationId}]}}).state("manage.organization.applications",{url:"/applications/",templateUrl:"views/organizations/applications.html",controller:"ManageOrganizationApplicationsCtrl"}).state("manage.organization.files",{url:"/files/",templateUrl:"views/organizations/files.html",controller:["$scope","organizationId",function(a,b){a.url="/api/v0/organizations/"+b+"/files"}]}).state("manage.organization.members",{url:"/members/",templateUrl:"views/organizations/members.html",controller:"ManageOrganizationMembersCtrl"}).state("manage.organization.orders",{url:"/orders/",templateUrl:"views/organizations/orders.html",controller:"ManageOrganizationOrdersCtrl"}).state("manage.organization.order",{url:"/orders/{orderId}",templateUrl:"views/organizations/order.html",controller:"ManageOrganizationOrderCtrl",resolve:{orderId:["$stateParams",function(a){return a.orderId}]}}).state("manage.organization.settings",{url:"/settings",controller:"ManageOrganizationsSettingsCtrl",templateUrl:"views/manage/organization-settings.html"}),a.state("organizations",{"abstract":!0,data:{access:e.manager},url:"/organizations/{organizationId}",template:'<ph-organization-navbar data-organization-id="organizationId"></ph-organization-navbar><ui-view/>',controller:["$scope","organizationId",function(a,b){a.organizationId=b}],resolve:{organizationId:["$stateParams",function(a){return a.organizationId}]}}).state("organizations.stores",{"abstract":!0,url:"/stores",template:"<ui-view/>"}).state("organizations.stores.index",{url:"/",template:'<ph-store store="store" data-is-editable="true" loaded="true"></ph-store>',controller:"OrganizationsStoreCtrl"}).state("organizations.articles",{"abstract":!0,url:"/articles",template:"<ui-view/>"}).state("organizations.articles.index",{url:"/",templateUrl:"views/organizations/articles.html",controller:"OrganizationsArticlesCtrl"}).state("organizations.articles.edit",{"abstract":!0,url:"/:articleId/:articleShortId",template:'<ph-organization-article-navbar data-organization-id="organizationId" data-article-id="articleId" data-article-short-id="articleShortId"></ph-organization-article-navbar><ui-view/>',controller:["$scope","organizationId","articleId","articleShortId",function(a,b,c,d){a.organizationId=b,a.articleId=c,a.articleShortId=d}],resolve:{articleId:["$stateParams",function(a){return a.articleId}],articleShortId:["$stateParams",function(a){return a.articleShortId}]}}).state("organizations.articles.edit.actions",{url:"/actions",templateUrl:"views/inventory/article-actions.html",controller:"ArticlesActionsCtrl"}).state("organizations.articles.edit.details",{url:"/",templateUrl:"views/manage/edit-article-details.html",controller:"OrganizationsArticlesDetailsCtrl"}).state("organizations.articles.edit.description",{url:"/description",templateUrl:"views/manage/edit-article-description.html",controller:"OrganizationsArticlesDescriptionCtrl"}).state("organizations.articles.edit.specification",{url:"/specification",templateUrl:"views/manage/edit-article-specification.html",controller:"OrganizationsArticlesSpecificationCtrl"}).state("organizations.articles.edit.stock",{url:"/stock",templateUrl:"views/manage/edit-article-stock.html",controller:"OrganizationsArticlesStockCtrl"}).state("organizations.articles.edit.files",{url:"/files",templateUrl:"views/manage/edit-article-files.html",controller:"OrganizationsArticlesFilesCtrl"}).state("organizations.settings",{url:"/settings",templateUrl:"views/organizations/settings.html",controller:"OrganizationsSettingsCtrl"}).state("organizations.contact-details",{url:"/contact",templateUrl:"views/organizations/edit-contact-details.html",controller:"OrganizationsEditContactDetailsCtrl"}).state("organizations.startpage",{url:"/startpage",templateUrl:"views/organizations/edit-startpage.html",controller:"OrganizationsEditStartpageCtrl"}),a.state("admin",{"abstract":!0,template:"<ui-view/>",data:{access:e.admin},url:"/admin"}).state("admin.eventLog",{url:"/event-log",templateUrl:"views/admin/eventlog.html",controller:"AdminEventLogCtrl"}).state("admin.mails",{url:"/mails/",templateUrl:"views/admin/mails.html",controller:"AdminMailsIndexCtrl"}).state("admin.organizations",{url:"/organizations/",templateUrl:"views/admin/organizations.html",controller:"AdminOrganizationsIndexCtrl"}).state("admin.schemaUpdate",{url:"/schema-update",template:"<pre>{{schemaUpdate}}</pre>",controller:"AdminSchemaUpdateCtrl"}).state("admin.status",{url:"/status",template:'<div class="page-header"><h1>Status</h1></div><pre>{{data | json}}</pre>',controller:"AdminStatusCtrl"}).state("admin.users",{url:"/users/",templateUrl:"views/admin/users.html",controller:"AdminUsersIndexCtrl"}),b.otherwise("/404"),c.html5Mode(!1),b.rule(function(a,b){return"file"!==b.protocol()&&""===b.path()?"/":void 0}),d.interceptors.push(["$q","$location",function(a,b){return{responseError:function(c){return(401===c.status||403===c.status)&&(b.search("returnPath",encodeURI(b.path())),b.path("/#/login")),a.reject(c)}}}])}]);angular.module("phundusApp").config(["uibDatepickerPopupConfig",function(a){a.clearText="Leeren",a.currentText="Heute",a.closeText="Schliessen"}]),angular.module("phundusApp").config(["$httpProvider","fileUploadProvider",function(a,b){delete a.defaults.headers.common["X-Requested-With"],b.defaults.redirect=window.location.href.replace(/\/[^\/]*$/,"/cors/result.html?%s")}]),angular.module("phundusApp").filter("orderStatusText",function(){return function(a){return{Pending:"Provisorisch",Approved:"Bestätigt",Rejected:"Abgelehnt",Closed:"Abgeschlossen"}[a]}}),angular.module("phundusApp").controller("MyFileUploadCtrl",["_","$scope","$http","Alert","$filter","$window","$timeout",function(a,b,c,d){var e=b.url;b.options={url:e},b.loadingFiles=!0,c.get(e).then(function(a){b.loadingFiles=!1,b.queue=a.data.files||[]},function(){b.loadingFiles=!1}),b.toggleIsPreview=function(f){b.isPreviewSubmitting=f.isPreviewSubmitting=!0,c.patch(e+"/"+f.name,{isPreview:f.isPreview}).then(function(){b.isPreviewSubmitting=f.isPreviewSubmitting=!1,a.forEach(b.queue,function(a){a.isPreview=f===a})},function(){b.isPreviewSubmitting=f.isPreviewSubmitting=!1,f.isPreview=!1,d.error("Fehler beim Setzen als Vorschaubild.")})}}]).controller("FileDestroyController",["$scope","$http",function(a,b){var c,d=a.file;d.url?(d.$state=function(){return c},d.$destroy=function(){return c="pending",b({url:d.deleteUrl,method:d.deleteType}).then(function(){c="resolved",a.clear(d)},function(){c="rejected"})}):d.$cancel||d._index||(d.$cancel=function(){a.clear(d)})}]),app.filter("unique",function(){return function(a,b){if(!a)return a;var c,d={},e=a.length,f=[];for(c=0;e>c;c+=1)d[a[c][b]]=a[c];for(c in d)f.push(d[c]);return f}}),app.run(["$rootScope","$state","$location","Auth","Alert","confirmationPopoverDefaults","amMoment",function(a,b,c,d,e,f,g){a.isTestEnv=/(^localhost)|(^acceptance)/.test(c.host()),a.isLocalEnv=/(^localhost)/.test(c.host()),a.$state=b,f.confirmButtonType="primary",f.confirmText="Ja",f.cancelText="Nein",g.changeLocale("de"),a.$on("$stateChangeStart",function(a,c,f,g){"data"in c&&"access"in c.data?d.authorize(c.data.access,void 0,f.organizationId)||(e.error("Seems like you tried accessing a route you don't have access to..."),a.preventDefault(),"^"===g.url&&(d.isLoggedIn()?b.go("anon.login"):b.go("anon.login"))):(e.error("Access undefined for this state."),a.preventDefault())})}]),angular.module("phundusApp").controller("UsersAccountCtrl",["$scope","Alert","AccountChangeEmailAddress","AccountChangePassword",function(a,b,c,d){a.submitChangeEmailAddress=function(){a.formChangeEmailAddress.$submitting=!0,c.post(a.changeEmailAddress,function(){a.formChangeEmailAddress.$submitting=!1,a.formChangeEmailAddress&&(a.formChangeEmailAddress.$setPristine(),a.formChangeEmailAddress.$setUntouched()),a.changeEmailAddress={},b.success("Das Bestätigungs-E-Mail wurde versendet.")},function(){a.formChangeEmailAddress.$submitting=!1,b.error("Fehler beim Ändern der E-Mail-Addresse.")})},a.submitChangePassword=function(){a.formChangePassword.$submitting=!0,d.post(a.changePassword,function(){a.formChangePassword.$submitting=!1,a.formChangePassword&&(a.formChangePassword.$setPristine(),a.formChangePassword.$setUntouched()),a.changePassword={},b.success("Das Passwort wurde geändert.")},function(){a.formChangePassword.$submitting=!1,b.error("Fehler beim Ändern des Passworts.")})}}]),angular.module("phundusApp").controller("ResetPasswordCtrl",["$scope","Alert","AccountResetPassword",function(a,b,c){a.submitted=!1,a.submit=function(){a.form.$submitting=!0,c.post(a.resetPassword,function(){a.form.$submitting=!1,a.submitted=!0},function(){a.form.$submitting=!1,b.error("Fehler beim Zurücksetzen des Passworts.")})}}]),angular.module("phundusApp").controller("AdminEventLogCtrl",["$scope","EventLog","Alert",function(a,b,c){b.query(function(b){a.eventLog=b},function(){c.error("Fehler beim Laden des Eventlogs.")})}]),angular.module("phundusApp").controller("AdminMailsIndexCtrl",["$scope","Mails","Auth","Alert",function(a,b,c,d){a.loading=!0,a.userRoles=c.userRoles,b.query(function(b){a.rowCollection=b.results,a.displayedCollection=[].concat(a.rowCollection),a.loading=!1},function(){d.error("Fehler beim Laden der E-Mails."),a.loading=!1}),a["delete"]=function(c){c?b["delete"]({mailId:c.mailId},function(){var b=a.rowCollection.indexOf(c);-1!==b&&a.rowCollection.splice(b,1)}):b["delete"]({},function(){a.rowCollection=[]})}}]),angular.module("phundusApp").controller("AdminOrganizationsIndexCtrl",["$scope","AdminOrganizations","Organizations","Auth","Alert","$window","$state",function(a,b,c,d,e,f,g){a.loading=!0,b.query(function(b){a.rowCollection=b.results,a.displayedCollection=[].concat(a.rowCollection),a.loading=!1},function(){e.error("Fehler beim Laden der Organisationen."),a.loading=!1}),a.establishOrganization=function(){var a=f.prompt("Name der neuen Organisation","");a&&c.post({name:a},function(a){e.success("Die Organisation wurde erfolgreich gegründet."),g.go("public.organization",{organizationId:a.organizationId})},function(){e.error("Fehler beim Gründen der Organisation.")})}}]),angular.module("phundusApp").controller("AdminSchemaUpdateCtrl",["$scope","SchemaUpdate","Alert",function(a,b,c){a.loading=!0,b.query(function(b){a.loading=!1,a.schemaUpdate=b.script},function(){a.loading=!1,c.error("Fehler beim Laden des Schema-Updates.")})}]),angular.module("phundusApp").controller("AdminUsersIndexCtrl",["$scope","AdminUsers","Alert",function(a,b,c){b.query({},function(b){a.rowCollection=b.results,a.displayedCollection=[].concat(a.rowCollection)},function(){c.error("Fehler beim Laden der Benutzer.")}),a.toggleIsApproved=function(a){a.isApprovedSubmitting=!0,b.patch({userId:a.userId,isApproved:a.isApproved},function(){a.isApprovedSubmitting=!1},function(){a.isApproved=!a.isApproved,a.isApprovedSubmitting=!1,c.error("Fehler beim Bestätigen des Benutzers.")})},a.toggleIsLocked=function(a){a.isLockedSubmitting=!0,b.patch({userId:a.userId,isLocked:a.isLocked},function(){a.isLockedSubmitting=!1},function(){a.isLocked=!a.isLocked,a.isLockedSubmitting=!1,c.error("Fehler beim Sperren/Entsperren des Benutzers.")})},a.toggleIsAdmin=function(a){a.isAdminSubmitting=!0,b.patch({userId:a.userId,isAdmin:a.isAdmin},function(){a.isAdminSubmitting=!1},function(){a.isAdmin=!a.isAdmin,a.isAdminSubmitting=!1,c.error("Fehler beim Setzen der Rolle des Benutzers.")})}}]),angular.module("phundusApp").controller("AdminStatusCtrl",["$scope","$resource","Alert",function(a,b,c){b("/api/v0/status").get({},function(b){a.data=b},function(){c.error("Fehler beim Laden der Statusinformationen.")})}]),angular.module("phundusApp").controller("DebugCtrl",["$","$scope","$http","$cookies","$timeout","$location","Alert",function(a,b,c,d,e,f,g){b.status={},b.host=f.host(),c.get("/api/v0/status").success(function(a){b.status=a}),b.toggleCartPopover=function(){a("#popover-glyphicon-cart").popover("show"),e(function(){a("#popover-glyphicon-cart").popover("hide")},4e3,!0)},b.cookies=d.getAll(),b.alertMsg="Alert message",b.addError=function(){g.error(b.alertMsg)},b.addDanger=function(){g.danger(b.alertMsg)},b.addWarning=function(){g.warning(b.alertMsg)},b.addSuccess=function(){g.success(b.alertMsg)}}]),angular.module("phundusApp").controller("ArticlesActionsCtrl",["$scope","articleId","ArticlesActions","Alert",function(a,b,c,d){c.get({articleId:b},function(b){a.actions=b.results},function(a){d.error("Fehler beim Laden der Artikel-Aktivitäten: "+a.data.message)})}]),angular.module("phundusApp").controller("LoginCtrl",["$scope","$location","$window","Auth","Alert",function(a,b,c,d,e){a.rememberMe=!1,a.login=function(){a.loginForm.$submitting=!0,d.login({username:a.username,password:a.password,rememberme:a.rememberMe},function(){var d=b.search().ReturnUrl;if(d)c.location.href=d;else{var e=b.search().returnPath||"/";delete b.search().returnPath,b.path(e)}a.loginForm.$submitting=!1},function(b){a.loginForm.$submitting=!1,e.error("Fehler bei der Anmeldung: "+b.message)})},a.range=function(a,b,c){c=c||1;for(var d=[],e=a;b>=e;e+=c)d.push(e);return d},a.autoLogin=function(b,c){a.username=b,a.password=c||"1234",a.login()}}]),angular.module("phundusApp").controller("LogoutCtrl",["$scope","$location","$window","Auth",function(a,b,c,d){d.isLoggedIn?d.logout(function(){b.path("/logged-out")},function(b){var c="Der Server hat nicht geantwortet.";b&&(c=b.message),a.errorMessage="Fehler bei der Abmeldung: "+c}):b.path("/logged-out")}]),angular.module("phundusApp").controller("MetaFeedbackCtrl",["$scope","Auth","Alert","Feedback",function(a,b,c,d){a.feedback={emailAddress:b.user.username||void 0},a.submitted=!1,a.submit=function(){a.form.$submitting=!0,d.post(a.feedback,function(){a.form.$submitting=!1,a.submitted=!0},function(){a.form.$submitting=!1,c.error("Fehler beim Senden des Feedbacks.")})}}]),angular.module("phundusApp").controller("MetaValidateCtrl",["$scope","Auth","Alert","Validate","key","$timeout",function(a,b,c,d,e,f){a.validate={key:e},a.submitted=!1,a.submit=function(){a.form.$submitting=!0,d.post(a.validate,function(){a.form.$submitting=!1,a.submitted=!0},function(){a.form.$submitting=!1,c.error("Fehler beim Validieren des Keys.")})},void 0!==e&&f(a.submit)}]),angular.module("phundusApp").controller("AddOrderItemModalInstCtrl",["$scope","$uibModalInstance","lessorId","orderId","item","$http",function(a,b,c,d,e,f){e?(a.fromUtc=e.fromUtc,a.toUtc=e.toUtc,a.amount=e.amount):(a.fromUtc=new Date,a.toUtc=new Date,a.amount=1),a.getArticles=function(a){return f.get("/api/v0/articles",{params:{ownerId:c,q:a}}).then(function(a){return a.data.results})},a.ok=function(){a.addItemForm.$valid&&b.close({lessorId:c,orderId:d,articleId:a.selected.id,fromUtc:a.fromUtc,toUtc:a.toUtc,amount:a.amount})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("phundusApp").controller("CreateArticleModalInstCtrl",["$scope","$uibModalInstance","ownerId",function(a,b,c){a.name="",a.amount=1,a.ok=function(){a.form.$valid&&b.close({ownerId:c,name:a.name,amount:a.amount})},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("phundusApp").controller("CreateOrderModalInstCtrl",["$scope","$uibModalInstance","ownerId","$http",function(a,b,c,d){a.getMembers=function(a){return d.get("/api/v0/organizations/"+c+"/members",{params:{username:a}}).then(function(a){return a.data.results.map(function(a){return a})})},a.ok=function(){b.close(a.selected)},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("phundusApp").controller("NavCtrl",["$rootScope","$scope","$state","$location","$window","Auth","Alert",function(a,b,c,d,e,f,g){a.alerts=g.alerts,a.dismissAlert=function(a,b){g.dismiss(a,b)},b.user=f.user,b.userRoles=f.userRoles,b.accessLevels=f.accessLevels,b.queryString="",b.search=function(){e.location.href="/shop/Search?queryString="+b.queryString},b.logout=function(){f.logout(function(){d.path("/logged-out")},function(a){g.error(a)})}}]),angular.module("phundusApp").controller("OrganizationsCtrl",["$scope","Organizations","Alert",function(a,b,c){a.loading=!0,b.query(function(b){a.organizations=b.results,a.displayedOrganizations=[].concat(a.organizations),a.loading=!1},function(){c.error("Fehler beim Laden der Organisationen."),a.loading=!1})}]),angular.module("phundusApp").controller("OrganizationCtrl",["organizationId","$scope","$sce","$window","Alert","Auth","Organizations","Relationships","Applications","leafletData","leafletMarkersHelpers","$timeout",function(a,b,c,d,e,f,g,h,i,j,k,l){b.loading=!0,b.accessLevels=f.accessLevels,b.organization=null,b.organizationId=a,b.hasContactOptions=function(){return b.organization&&(b.organization.address||b.organization.emailAddress||b.organization.website)},g.get({organizationId:a},function(d){b.organization=d,b.startpage=c.trustAsHtml(d.startpage),l(function(){b.organization.stores[0]&&b.organization.stores[0].coordinate&&j.getMap().then(function(a){var c=b.organization.stores[0].coordinate,d={lat:c.latitude,lng:c.longitude};a.setView(d,14),b.marker?b.marker.setLatLng(d):(b.marker=k.createMarker(d),b.marker.addTo(a))})},0),f.isLoggedIn()&&h.get(a,function(a){b.relationship=a.result},function(){e.error("Fehler beim Laden des Mitgliedschaftsstatus.")})},function(){e.error("Fehler beim Laden der Organisation.")}),b.join=function(){b.isJoining=!0,i.post({organizationId:a},function(){b.isJoining=!1,e.info("Die Mitgliedschaft wurde beantragt. Du erhältst ein E-Mail wenn ein Administrator diese bestätigt oder ablehnt."),b.relationship={status:"application",timestamp:new Date}},function(){b.isJoining=!1,e.error("Fehler beim Beantragen der Mitgliedschaft.")})}}]),angular.module("phundusApp").controller("OrganizationsEditContactDetailsCtrl",["_","$scope","organizationId","Organizations","Alert","$state",function(a,b,c,d,e,f){b.contactDetails=null,d.get({organizationId:c},function(a){b.contactDetails=a.contactDetails},function(){e.error("Fehler beim Laden der Einstellungen.")});var g=function(){f.go("public.organization",{organizationId:c})};b.submit=function(){b.form.$submitting=!0,d.patch({organizationId:c,contactDetails:b.contactDetails},function(){b.form.$submitting=!1,e.success("Die Einstellungen wurde erfolgreich gespeichert."),g()},function(){b.form.$submitting=!1,e.error("Fehler beim Speichern der Einstellungen.")})},b.cancel=g}]),angular.module("phundusApp").controller("OrganizationsEditStartpageCtrl",["$scope","organizationId","Organizations","Alert","$state",function(a,b,c,d,e){a.data={},c.get({organizationId:b},function(b){a.data.startpage=b.startpage},function(){d.error("Fehler beim Laden der Startseite.")});var f=function(){e.go("public.organization",{organizationId:b})};a.submit=function(){a.form.$submitting=!0,c.patch({organizationId:b,startpage:a.data.startpage},function(){a.form.$submitting=!1,d.success("Die Startseite wurde erfolgreich gespeichert."),f()},function(){a.form.$submitting=!1,d.error("Fehler beim Speichern der Startseite.")})},a.cancel=f}]),angular.module("phundusApp").controller("OrganizationsSettingsCtrl",["_","$scope","organizationId","OrganizationSettings","Alert",function(a,b,c,d,e){d.get({organizationId:c},function(c){b.publicFormReset=a.pick(c,["organizationId","publicRental"]),b.publicFormModel=angular.copy(b.publicFormReset)},function(a){e.error("Fehler beim Laden der Einstellungen: "+(angular.isDefined(a.message)?a.message:"Unbekannter Fehler."))}),b.submit=function(a,b){console.log(b),a.$submitting=!0,d.patch(b,function(){a.$submitting=!1,e.success("Die Einstellungen wurden erfolgreich gespeichert.")},function(b){a.$submitting=!1,e.error("Fehler beim Speichern der Einstellungen: "+(angular.isDefined(b.message)?b.message:"Unbekannter Fehler."))})},b.reset=function(a,b){angular.copy(b,a)}}]),angular.module("phundusApp").controller("OrganizationsStoreCtrl",["$scope","organizationId","Stores","Alert",function(a,b,c,d){a.store=null,c.query({ownerId:b},function(b){a.store=b.stores[0]||null,a.store||d.error("Die Materialstelle konnte nicht gefunden werden. Kontaktiere bitte das phundus-Team.")},function(){d.error("Fehler beim Laden der Materialstelle.")})}]),angular.module("phundusApp").controller("ManageOrganizationsSettingsCtrl",["$scope","organizationId",function(a,b){a.organizationId=b}]),angular.module("phundusApp").controller("ManageOrganizationApplicationsCtrl",["_","$scope","organizationId","Applications","Members","Alert",function(a,b,c,d,e,f){d.query({organizationId:c},function(a){b.rowCollection=a,b.displayedCollection=[].concat(b.rowCollection)},function(){f.error("Fehler beim Laden der Beitrittsanfragen.")}),b.approve=function(a){a.isApproving=!0,e.post({organizationId:c,applicationId:a.applicationId},function(){a.isApproved=!0,a.isApproving=!1;var c=b.rowCollection.indexOf(a);-1!==c&&b.rowCollection.splice(c,1)},function(){a.isApproving=!1,f.error("Fehler beim Bestätigen der Beitrittsanfrage.")})},b.reject=function(a){a.isRejecting=!0,d["delete"]({organizationId:c,applicationId:a.applicationId},function(){a.isRejected=!0,a.isRejecting=!1;var c=b.rowCollection.indexOf(a);-1!==c&&b.rowCollection.splice(c,1)},function(){a.isRejecting=!1,f.error("Fehler beim Ablehnen der Beitrittsanfrage.")})}}]),angular.module("phundusApp").controller("OrganizationsArticlesCtrl",["_","$scope","$window","Articles","Auth","Alert","organizationId","$uibModal","$state",function(a,b,c,d,e,f,g,h,i){b.loading=!0,b.userRoles=e.userRoles,b.organizationId=g,d.query({ownerId:g},function(a){b.articles=a.results,b.displayedArticles=[].concat(b.articles),b.loading=!1},function(){f.error("Fehler beim Laden der Artikel."),b.loading=!1}),b["delete"]=function(e,g){c.confirm('Möchtest du den Artikel "'+g+'" wirklich löschen?')&&d["delete"]({articleId:e},function(){f.success('Der Artikel "'+g+'" wurder erfolgreich gelöscht.'),a.remove(b.displayedArticles,{id:e}),a.remove(b.articles,{id:e})},function(){f.error('Fehler beim Löschen des Artikels "'+g+'".')})},b.createArticle=function(){var a=h.open({templateUrl:"views/modals/create-article.html",controller:"CreateArticleModalInstCtrl",resolve:{ownerId:function(){return g}}});a.result.then(function(a){d.post(a,function(a){i.go("organizations.articles.edit.details",{organizationId:g,articleShortId:a.articleShortId,articleId:a.articleId})},function(){f.error("Fehler beim Erstellen des Materials.")})})}}]),angular.module("phundusApp").controller("OrganizationsArticlesDetailsCtrl",["_","$scope","$state","organizationId","articleShortId","Articles","Alert",function(a,b,c,d,e,f,g){b.organizationId=d,b.articleId=e,b.article=null,f.get({ownerId:d,articleId:e},function(c){b.article=c,b.pricesFormReset=a.pick(c,["publicPrice","memberPrice"]),b.pricesFormModel=angular.copy(b.pricesFormReset)},function(){g.error("Fehler beim Laden des Artikels.")}),b.submit=function(){b.form.$submitting=!0,f.patch({ownerId:d,articleId:e,name:b.article.name,brand:b.article.brand,grossStock:b.article.grossStock,color:b.article.color},function(){b.form.$submitting=!1,g.success("Das Material wurde erfolgreich gespeichert.")},function(){b.form.$submitting=!1,g.error("Fehler beim Speichern des Material.")})},b.submitPrices=function(a,c){console.log(c),a.$submitting=!0,f.patch({articleId:e,prices:c},function(){b.pricesFormReset=angular.copy(b.pricesFormModel),a.$setPristine(),a.$submitting=!1,g.success("Die Einstellungen wurden erfolgreich gespeichert.")},function(b){a.$submitting=!1,g.error("Fehler beim Speichern der Einstellungen: "+(angular.isDefined(b.message)?b.message:"Unbekannter Fehler."))})},b.resetPrices=function(a,b,c){angular.copy(c,b),a.$setPristine()}}]),angular.module("phundusApp").controller("OrganizationsArticlesDescriptionCtrl",["$scope","$state","organizationId","articleShortId","Articles","Alert",function(a,b,c,d,e,f){a.organizationId=c,a.articleId=d,a.data={},e.get({ownerId:c,articleId:d},function(b){a.data.description=b.description},function(){f.error("Fehler beim Laden der Beschreibung.")}),a.submit=function(){a.form.$submitting=!0,e.patch({ownerId:c,articleId:d,description:a.data.description},function(){a.form.$submitting=!1,f.success("Die Beschreibung wurde erfolgreich gespeichert.")},function(){a.form.$submitting=!1,f.error("Fehler beim Speichern der Beschreibung.")})},a.cancel=function(){b.go("organizations.articles.index",{organizationId:c})}}]),angular.module("phundusApp").controller("OrganizationsArticlesSpecificationCtrl",["$scope","$state","organizationId","articleShortId","Articles","Alert",function(a,b,c,d,e,f){a.organizationId=c,a.articleId=d,a.data={},e.get({ownerId:c,articleId:d},function(b){a.data.specification=b.specification},function(){f.error("Fehler beim Laden der Spezifikation.")}),a.submit=function(){a.form.$submitting=!0,e.patch({ownerId:c,articleId:d,specification:a.data.specification},function(){a.form.$submitting=!1,f.success("Die Spezifikation wurde erfolgreich gespeichert.")},function(){a.form.$submitting=!1,f.error("Fehler beim Speichern der Spezifikation.")})},a.cancel=function(){b.go("organizations.articles.index",{organizationId:c})}}]),angular.module("phundusApp").controller("OrganizationsArticlesFilesCtrl",["$scope","organizationId","articleShortId",function(a,b,c){a.url="/api/v0/articles/"+c+"/files",a.hasPreview=!0}]),angular.module("phundusApp").controller("OrganizationsArticlesStockCtrl",["$scope","organizationId","articleShortId","ArticlesStock","Alert",function(a,b,c,d,e){a.organizationId=b,a.articleId=c,a.stock=null,d.get({ownerId:b,articleId:c},function(b){a.stock=b},function(){e.error("Fehler beim Laden des Bestandes.");
})}]),angular.module("phundusApp").controller("ManageOrganizationMembersCtrl",["$scope","organizationId","Members","Alert",function(a,b,c,d){c.query({organizationId:b},function(b){a.rowCollection=b.results,a.displayedCollection=[].concat(a.rowCollection)},function(){d.error("Fehler beim Laden der Mitglieder.")}),a.toggleIsLocked=function(a){a.isLockedSubmitting=!0,c.patch({organizationId:b,memberId:a.memberId,isLocked:a.isLocked},function(){a.isLockedSubmitting=!1},function(){a.isLocked=!a.isLocked,a.isLockedSubmitting=!1,d.error("Fehler beim Sperren/Entsperren des Benutzers.")})},a.toggleIsManager=function(a){a.isManagerSubmitting=!0,c.patch({organizationId:b,memberId:a.memberId,isManager:a.isManager},function(){a.isManagerSubmitting=!1},function(){a.isManager=!a.isManager,a.isManagerSubmitting=!1,d.error("Fehler beim Sperren/Entsperren des Benutzers.")})}}]),angular.module("phundusApp").controller("ManageOrganizationOrdersCtrl",["$scope","organizationId","Orders","Alert","$state","$uibModal",function(a,b,c,d,e,f){a.organizationId=b,c.query({organizationId:b},function(b){a.rowCollection=b.results,a.displayedCollection=[].concat(a.rowCollection)},function(){d.error("Fehler beim Laden der Bestellungen.")}),a.createOrder=function(){var g=f.open({templateUrl:"views/modals/create-order.html",controller:"CreateOrderModalInstCtrl",resolve:{ownerId:function(){return a.organizationId}}});g.result.then(function(f){c.post({ownerId:a.organizationId,lesseeId:f.id},function(a){e.go("manage.organization.order",{organizationId:b,orderId:a.orderId})},function(){d.error("Fehler beim Erstellen der Bestellung.")})})}}]),angular.module("phundusApp").controller("ManageOrganizationOrderCtrl",["$","$scope","organizationId","orderId","Orders","OrderItems","Alert","$window","$uibModal",function(a,b,c,d,e,f,g,h,i){b.organizationId=c,b.orderId=d,b.order=null,b.newItem={fromUtc:new Date,toUtc:new Date},e.get({orderId:d},function(a){b.order=a},function(){g.error("Fehler beim Laden der Bestellung.")}),b.canEdit=function(){return b.order&&"Pending"===b.order.status},b.canConfirm=function(){return b.canEdit()},b.canReject=function(){return b.canEdit()},b.canClose=function(){return b.order&&"Approved"===b.order.status},b.getTotal=function(){if(!b.order||!b.order.items)return 0;for(var a=0,c=0;c<b.order.items.length;c++)a+=parseFloat(b.order.items[c].itemTotal);return a},b.newItem={articleId:"",amount:1,fromUtc:new Date,toUtc:new Date,orderId:d},b.showAddItem=function(){var a=i.open({templateUrl:"views/modals/add-order-item.html",controller:"AddOrderItemModalInstCtrl",resolve:{lessorId:function(){return b.order.lessorId},orderId:function(){return d},item:function(){return b.newItem}}});a.result.then(function(a){b.newItem.fromUtc=a.fromUtc,b.newItem.toUtc=a.toUtc,b.newItem.amount=a.amount,f.post(a,function(a){b.order.items.push(a)},function(){g.error("Fehler beim Hinzufügen des Materials.")})})},b.editItem=function(a){b.saveValues={amount:a.amount,fromUtc:a.fromUtc,toUtc:a.toUtc,itemTotal:a.itemTotal},a.editing=!0},b.saveEditedItem=function(a){a.editing=!1,b.newItem.fromUtc=a.fromUtc,b.newItem.toUtc=a.toUtc,b.newItem.amount=a.amount,f.patch({orderId:b.order.orderId},a,function(b){a.amount=b.amount,a.fromUtc=b.fromUtc,a.toUtc=b.toUtc,a.isAvailable=b.isAvailable,a.unitPrice=b.unitPrice,a.itemTotal=b.itemTotal})},b.cancelEditing=function(a){a.editing=!1,a.amount=b.saveValues.amount,a.fromUtc=b.saveValues.fromUtc,a.toUtc=b.saveValues.toUtc,a.itemTotal=b.saveValues.itemTotal},b.calculateItemTotal=function(a){var b=Math.max(1,Math.ceil((new Date(a.toUtc)-new Date(a.fromUtc))/864e5));a.itemTotal=Math.round(100*a.unitPrice/7*b*a.amount)/100},b.removeItem=function(a){h.confirm('Möchten Sie die Position "'+a.text+'" wirklich löschen?')&&f["delete"]({orderId:b.order.orderId,orderItemId:a.orderItemId},function(){var c=b.order.items.indexOf(a);b.order.items.splice(c,1)})},b.confirmOrder=function(a){for(var c=0,d=0;d<b.order.items.length;d++)b.order.items[d].isAvailable||c++;var f="Möchten Sie die Bestellung wirklich bestätigen?";if(1===c?f="1 Position ist zur Zeit nicht verfügbar.\n\n"+f:c>1&&(f=c+" Positionen sind zur Zeit nicht verfügbar.\n\n"+f),h.confirm(f)){var g=a.status;a.status="Approved",e.patch({orderId:a.orderId,status:a.status},function(){},function(){a.status=g})}},b.rejectOrder=function(a){if(h.confirm("Möchten Sie die Bestellung wirklich ablehnen?")){var b=a.status;a.status="Rejected",e.patch({orderId:a.orderId,status:a.status},function(){},function(){a.status=b})}},b.closeOrder=function(a){if(h.confirm("Möchten Sie die Bestellung wirklich abschliessen?\n\nAusstehendes Material wird dann nicht mehr reserviert sein.")){var b=a.status;a.status="Closed",e.patch({orderId:a.orderId,status:a.status},function(){},function(){a.status=b})}}}]),angular.module("phundusApp").controller("SignUp",["$scope","Users","Organizations","Alert",function(a,b,c,d){a.user={},a.submitted=!1,c.query({},function(b){a.organizations=b.results},function(){d.error("Fehler beim Laden der Organisationen.")}),a.submit=function(){return a.form.$valid?(a.form.$submitting=!0,void b.post(a.user,function(){a.form.$submitting=!1,a.submitted=!0},function(b){console.log(b),a.form.$submitting=!1,d.error("Fehler bei der Registrierung: "+b.data.message)})):void d.error("Bitte überprüfe deine Eingaben.")}}]),angular.module("phundusApp").controller("ShopCtrl",["$timeout","$window",function(a,b){a(function(){b.location.href="#/shop"},0)}]),angular.module("phundusApp").controller("ShopIndexCtrl",["$scope","ShopItems","Alert",function(a,b,c){a.currentPage=1,a.limit=8;var d=function(d,e){b.get({q:d,lessorId:e,offset:a.limit*(a.currentPage-1),limit:a.limit},function(b){a.offset=b.offset,a.limit=b.limit,a.totalItems=b.total,a.currentPage=Math.ceil((a.offset+1)/a.limit),a.items=b.results},function(a){c.error("Fehler beim Laden der Artikel: "+a.data.message)})};a.searchQuery=d,a.$watch("currentPage",function(){d()})}]),angular.module("phundusApp").controller("ShopItemCtrl",["$scope","itemId","ShopItems","Lessors","Alert","Auth",function(a,b,c,d,e,f){var g=null;a.itemId=b,a.accessLevels=f.accessLevels,c.get({itemId:b},function(b){a.item=b,d.get({lessorId:b.lessor.lessorId},function(b){a.lessor=g=b},function(a){e.error("Fehler beim Laden des Vermieters: "+a.data.message)})},function(a){e.error("Fehler beim Laden des Artikels: "+a.data.message)}),a.canRent=function(){return g&&(g.publicRental||f.isMember(g.lessorId))}}]),angular.module("phundusApp").controller("ShopCheckoutCtrl",["_","$scope","userId","UsersCart","Lessors","Lessees","ShopOrders","Alert",function(a,b,c,d,e,f,g,h){d.get({userId:c},function(d){var g=a.groupBy(d.items,"ownerId"),i=a.reduce(g,function(b,c,d){return b.push({lessorId:d,items:c,total:a.sumBy(c,"itemTotal"),legal_notice:!1}),b},[]);b.orders=a.forEach(i,function(a){e.get({lessorId:a.lessorId},function(b){a.lessor=b},function(a){h.error("Fehler beim Laden des Vermieters: "+a.data.message)})}),f.get({lesseeId:c},function(c){a.forEach(b.orders,function(a){a.lessee=c,console.log(c)})},function(a){h.error("Fehler beim Laden des Mieters: "+a.data.message)})},function(a){h.error("Fehler beim Laden des Warenkorbes: "+a.data.message)}),b.canPlaceOrder=function(a){return a.legal_notice},b.placeOrder=function(a){a.placing=!0,g.post({lessorId:a.lessorId},function(){a.placing=!1,a.placed=!0},function(b){a.placing=!1,a.placed=!1,h.error("Fehler beim Bestellen der Materialien: "+b.data.message)})}}]),angular.module("phundusApp").controller("ShopCartCtrl",["_","$scope","userId","UsersCart","UsersCartItems","ShopItemsAvailabilityCheck","Alert","$timeout","$state",function(a,b,c,d,e,f,g,h,i){var j=function(b){b.availabilityChecking=!0,h(function(){var c=a.pick(b,["fromUtc","toUtc","quantity"]);c.articleId=b.articleGuid,c.itemId=b.articleGuid,f.post(c,function(a){b.isAvailable=a.isAvailable,b.availabilityChecking=!1},function(a){b.isAvailable=!1,b.availabilityChecking=!1,g.error("Fehler beim Prüfen der Verfügbarkeit: "+a.data.message)})},100)};b.checkAvailability=j;var k=function(c){c&&a.forEach(b.cart.items,function(a){j(a)})};d.get({userId:c},function(a){b.cart=a,k(b.cart.items)},function(a){g.error("Fehler beim Laden des Warenkorbes: "+a.data.message)}),b.canEdit=function(){return!0},b.editItem=function(a){b.saveValues={quantity:a.quantity,fromUtc:a.fromUtc,toUtc:a.toUtc,isAvailable:a.isAvailable},a.editing=!0},b.cancelEditing=function(a){a.editing=!1,a.quantity=b.saveValues.quantity,a.fromUtc=b.saveValues.fromUtc,a.toUtc=b.saveValues.toUtc,a.isAvailable=b.saveValues.isAvailable},b.saveEditedItem=function(a){e.patch({userId:c,cartItemId:a.cartItemId},a,function(){a.editing=!1,b.calculateDaysAndItemTotal(a),j(a)},function(a){g.error(a.data.message)})},b.removeItem=function(a){e["delete"]({userId:c,cartItemId:a.cartItemId},function(){var c=b.cart.items.indexOf(a);b.cart.items.splice(c,1),b.cartCleared=0===b.cart.items.length})},b.calculateDaysAndItemTotal=function(a){var b=new Date(a.toUtc)-new Date(a.fromUtc)+1;a.days=Math.max(1,Math.ceil(b/864e5)),a.itemTotal=Math.max(1,Math.round(a.unitPricePerWeek/7*a.days*a.quantity))},b.getTotal=function(){if(!b.cart||!b.cart.items)return 0;for(var a=0,c=0;c<b.cart.items.length;c++)a+=parseFloat(b.cart.items[c].itemTotal);return a},b.canGoToCheckout=function(){return b.cart?a.every(b.cart.items,function(a){return!a.editing&&a.isAvailable&&!a.availabilityChecking}):!1},b.goToCheckout=function(){b.canGoToCheckout()&&i.go("checkout")},b.clearCart=function(){b.clearingCart=!0,d["delete"]({userId:c},function(){b.clearingCart=!1,b.cart.items=[],b.cartCleared=!0},function(a){b.clearingCart=!1,g.error("Fehler beim Leeren des Warenkorbs: "+a.data.message)})}}]),angular.module("phundusApp").controller("UsersCtrl",["$scope","userId","Users","Auth","Alert",function(a,b,c,d,e){a.userId=b,a.isHome=b+""==d.user.userId+"",a.user=null,c.get({userId:b},function(b){a.user=b},function(){e.error("Fehler beim Laden des Benutzers.")})}]),angular.module("phundusApp").controller("UsersHomeCtrl",["$scope","userId","Stores","Alert",function(a,b,c,d){a.openStore=function(){a.isOpeningStore=!0,c.post({userId:a.user.userId},function(b){a.isOpeningStore=!1,a.user.store=b,d.success("Deine Materialstelle wurde erfolgreich eröffnet.")},function(){a.isOpeningStore=!1,d.error("Fehler beim Eröffnen deiner Materialstelle.")})}}]),angular.module("phundusApp").controller("UsersArticlesIndexCtrl",["_","$scope","userId","$window","Stores","Articles","Alert","$uibModal","$state","Auth",function(a,b,c,d,e,f,g,h,i,j){b.loading=!0,b.store=null,b.articles=null,e.query({ownerId:j.user.userId},function(a){return 0===a.stores.length?void(b.loading=!1):(b.store=a.stores[0],void f.query({ownerId:c},function(a){b.articles=a.results,b.displayedArticles=[].concat(b.articles),b.loading=!1},function(){g.error("Fehler beim Laden der Artikel."),b.loading=!1}))}),b["delete"]=function(c,e){d.confirm('Möchtest du den Artikel "'+e+'" wirklich löschen?')&&f["delete"]({articleId:c},function(){g.success('Der Artikel "'+e+'" wurder erfolgreich gelöscht.'),a.remove(b.displayedArticles,{id:c}),a.remove(b.articles,{id:c})},function(){g.error('Fehler beim Löschen des Artikels "'+e+'".')})},b.createArticle=function(){var a=h.open({templateUrl:"views/modals/create-article.html",controller:"CreateArticleModalInstCtrl",resolve:{ownerId:function(){return c}}});a.result.then(function(a){f.post(a,function(a){i.go("user.articles.article.details",{userId:c,articleId:a.articleId,articleShortId:a.articleShortId})},function(){g.error("Fehler beim Erstellen des Materials.")})})}}]),angular.module("phundusApp").controller("UsersArticlesDetailsCtrl",["_","$scope","$state","userId","articleShortId","Articles","Alert",function(a,b,c,d,e,f,g){b.userId=d,b.articleId=e,b.article=null,f.get({ownerId:d,articleId:e},function(c){b.article=c,b.pricesFormReset=a.pick(c,["publicPrice","memberPrice"]),b.pricesFormModel=angular.copy(b.pricesFormReset)},function(){g.error("Fehler beim Laden des Artikels.")}),b.submit=function(){b.form.$submitting=!0,f.patch({ownerId:d,articleId:e,name:b.article.name,brand:b.article.brand,price:b.article.price,grossStock:b.article.grossStock,color:b.article.color},function(){b.form.$submitting=!1,g.success("Das Material wurde erfolgreich gespeichert.")},function(){b.form.$submitting=!1,g.error("Fehler beim Speichern des Material.")})},b.cancel=function(){c.go("user.articles.articles",{userId:d})},b.submitPrices=function(a,c){console.log(c),a.$submitting=!0,f.patch({articleId:e,prices:c},function(){b.pricesFormReset=angular.copy(b.pricesFormModel),a.$setPristine(),a.$submitting=!1,g.success("Die Einstellungen wurden erfolgreich gespeichert.")},function(b){a.$submitting=!1,g.error("Fehler beim Speichern der Einstellungen: "+(angular.isDefined(b.message)?b.message:"Unbekannter Fehler."))})},b.resetPrices=function(a,b,c){angular.copy(c,b),a.$setPristine()}}]),angular.module("phundusApp").controller("UsersArticlesDescriptionCtrl",["$scope","$state","userId","articleShortId","Articles","Alert",function(a,b,c,d,e,f){a.userId=c,a.articleId=d,a.data={},e.get({ownerId:c,articleId:d},function(b){a.data.description=b.description},function(){f.error("Fehler beim Laden der Beschreibung.")}),a.submit=function(){a.form.$submitting=!0,e.patch({ownerId:c,articleId:d,description:a.data.description},function(){a.form.$submitting=!1,f.success("Die Beschreibung wurde erfolgreich gespeichert.")},function(){a.form.$submitting=!1,f.error("Fehler beim Speichern der Beschreibung.")})},a.cancel=function(){b.go("user.articles.articles",{userId:c})}}]),angular.module("phundusApp").controller("UsersArticlesSpecificationCtrl",["$scope","$state","userId","articleShortId","Articles","Alert",function(a,b,c,d,e,f){a.userId=c,a.articleId=d,a.data={},e.get({ownerId:c,articleId:d},function(b){a.data.specification=b.specification},function(){f.error("Fehler beim Laden der Spezifikation.")}),a.submit=function(){a.form.$submitting=!0,e.patch({ownerId:c,articleId:d,specification:a.data.specification},function(){a.form.$submitting=!1,f.success("Die Spezifikation wurde erfolgreich gespeichert.")},function(){a.form.$submitting=!1,f.error("Fehler beim Speichern der Spezifikation.")})},a.cancel=function(){b.go("user.articles.articles",{userId:c})}}]),angular.module("phundusApp").controller("UsersArticlesFilesCtrl",["$scope","userId","articleShortId",function(a,b,c){a.url="/api/v0/articles/"+c+"/files",a.hasPreview=!0}]),angular.module("phundusApp").controller("UsersArticlesStockCtrl",["$scope","userId","articleShortId","ArticlesStock","Alert",function(a,b,c,d,e){a.userId=b,a.articleId=c,a.stock=null,d.get({ownerId:b,articleId:c},function(b){a.stock=b},function(){e.error("Fehler beim Laden des Bestandes.")})}]),angular.module("phundusApp").controller("ManageUserOrdersCtrl",["$scope","userId","Orders","Alert",function(a,b,c,d){c.query({userId:b},function(b){a.rowCollection=b.results,a.displayedCollection=[].concat(a.rowCollection)},function(){d.error("Fehler beim Laden der Bestellungen.")})}]),angular.module("phundusApp").controller("ManageUserOrderCtrl",["$","$scope","userId","orderId","Orders","OrderItems","Auth","Alert","$window","$uibModal",function(a,b,c,d,e,f,g,h,i,j){b.userId=c,b.orderId=d,b.order=null,b.isLessor=function(){return b.order&&b.order.lessorId===g.user.userId},e.get({orderId:d},function(a){b.order=a},function(){h.error("Fehler beim Laden der Bestellung.")}),b.canEdit=function(){return b.isLessor()&&b.order&&"Pending"===b.order.status},b.canConfirm=function(){return b.isLessor()&&b.canEdit()},b.canReject=function(){return b.isLessor()&&b.canEdit()},b.canClose=function(){return b.isLessor()&&b.order&&"Approved"===b.order.status},b.getTotal=function(){if(!b.order||!b.order.items)return 0;for(var a=0,c=0;c<b.order.items.length;c++)a+=parseFloat(b.order.items[c].itemTotal);return a},b.newItem={articleId:"",amount:1,fromUtc:new Date,toUtc:new Date,orderId:d},b.showAddItem=function(){var a=j.open({templateUrl:"views/modals/add-order-item.html",controller:"AddOrderItemModalInstCtrl",resolve:{lessorId:function(){return b.order.lessorId},orderId:function(){return d},item:function(){return b.newItem}}});a.result.then(function(a){b.newItem.fromUtc=a.fromUtc,b.newItem.toUtc=a.toUtc,b.newItem.amount=a.amount,f.post(a,function(a){b.order.items.push(a)},function(){h.error("Fehler beim Hinzufügen des Materials.")})})},b.editItem=function(a){b.saveValues={amount:a.amount,fromUtc:a.fromUtc,toUtc:a.toUtc,itemTotal:a.itemTotal},a.editing=!0},b.saveEditedItem=function(a){a.editing=!1,b.newItem.fromUtc=a.fromUtc,b.newItem.toUtc=a.toUtc,b.newItem.amount=a.amount,f.patch({orderId:b.order.orderId},a,function(b){a.amount=b.amount,a.fromUtc=b.fromUtc,a.toUtc=b.toUtc,a.isAvailable=b.isAvailable,a.unitPrice=b.unitPrice,a.itemTotal=b.itemTotal})},b.cancelEditing=function(a){a.editing=!1,a.amount=b.saveValues.amount,a.fromUtc=b.saveValues.fromUtc,a.toUtc=b.saveValues.toUtc,a.itemTotal=b.saveValues.itemTotal},b.calculateItemTotal=function(a){var b=Math.max(1,Math.ceil((new Date(a.toUtc)-new Date(a.fromUtc))/864e5));a.itemTotal=Math.round(100*a.unitPrice/7*b*a.amount)/100},b.removeItem=function(a){i.confirm('Möchten Sie die Position "'+a.text+'" wirklich löschen?')&&f["delete"]({orderId:b.order.orderId,orderItemId:a.orderItemId},function(){var c=b.order.items.indexOf(a);b.order.items.splice(c,1)})},b.confirmOrder=function(a){for(var c=0,d=0;d<b.order.items.length;d++)b.order.items[d].isAvailable||c++;var f="Möchten Sie die Bestellung wirklich bestätigen?";if(1===c?f="1 Position ist zur Zeit nicht verfügbar.\n\n"+f:c>1&&(f=c+" Positionen sind zur Zeit nicht verfügbar.\n\n"+f),i.confirm(f)){var g=a.status;a.status="Approved",e.patch({orderId:a.orderId,status:a.status},function(){},function(){a.status=g})}},b.rejectOrder=function(a){if(i.confirm("Möchten Sie die Bestellung wirklich ablehnen?")){var b=a.status;a.status="Rejected",e.patch({orderId:a.orderId,status:a.status},function(){},function(){a.status=b})}},b.closeOrder=function(a){if(i.confirm("Möchten Sie die Bestellung wirklich abschliessen?\n\nAusstehendes Material wird dann nicht mehr reserviert sein.")){var b=a.status;a.status="Closed",e.patch({orderId:a.orderId,status:a.status},function(){},function(){a.status=b})}}}]),angular.module("phundusApp").directive("hasError",[function(){return{restrict:"A",link:function(a,b,c){var d,e,f,g=c.hasError,h=g.split(".")[0];a.$watch(h+".$submitted",function(a){d=a,i()}),a.$watch(g+".$invalid",function(a){e=a,i()}),a.$watch(g+".$touched",function(a){f=a,i()});var i=function(){e&&f||e&&d?b.addClass("has-error"):b.removeClass("has-error")}}}}]),angular.module("phundusApp").directive("phCheckbox",[function(){return{restrict:"E",transclude:!0,scope:{spin:"="},template:'<div data-ng-class="{\'checkbox\': true}" data-ng-hide="spin" data-ng-transclude></div><span class="glyphicon glyphicon-refresh glyphicon-spin" data-ng-show="spin"></span>'}}]),angular.module("phundusApp").directive("phDate",[function(){return{restrict:"E",replace:!0,scope:{value:"=",format:"@"},link:function(a){a.format=a.format||"mediumDate"},template:"<span title=\"{{value | date:'medium'}}\">{{value | date:format}}</span>"}}]),angular.module("phundusApp").directive("phEditable",["$parse",function(a){return{restrict:"A",scope:!1,link:function(b,c,d){var e,f=b[d.name],g=a(d.phEditable);f.$show=function(){e=angular.copy(g(b)),f.$visible=!0},f.$cancel=function(){f.$visible=!1,g.assign(b,e)}}}}]),angular.module("phundusApp").directive("phGuid",[function(){return{restrict:"E",replace:!0,scope:{value:"=value"},template:'<span title="{{value}}">{{value | guid}}</span>'}}]),angular.module("phundusApp").directive("phHistoryBack",["$window",function(a){return{restrict:"A",link:function(b,c){c.bind("click",function(){a.history.back()})}}}]),angular.module("phundusApp").directive("phOrganizationNavbar",["Auth",function(a){return{restrict:"E",replace:"true",scope:{organizationId:"=organizationId"},link:function(b){b.accessLevels=a.accessLevels,b.userRoles=a.userRoles},templateUrl:"views/directives/ph-organization-navbar.html"}}]),angular.module("phundusApp").directive("phOrganizationArticleNavbar",["Auth",function(a){return{restrict:"E",replace:"true",scope:{organizationId:"=",articleId:"=",articleShortId:"="},link:function(b){b.accessLevels=a.accessLevels,b.userRoles=a.userRoles},templateUrl:"views/directives/ph-organization-article-navbar.html"}}]),angular.module("phundusApp").directive("phShopSearch",["Lessors","Alert",function(a,b){return{restrict:"E",replace:!0,scope:{submit:"="},templateUrl:"views/directives/ph-shop-search.html",link:function(c){a.get(function(a){c.lessors=a.results},function(a){b.error("Fehler beim Laden der Vermieter: "+a.data.message)})}}}]),angular.module("phundusApp").directive("phShopItemImages",[function(){return{restrict:"E",replace:!0,scope:{images:"="},templateUrl:"views/directives/ph-shop-item-images.html",link:function(a){a.$watch("images",function(b){if(b){var c=a.slides=[],d=0;b.forEach(function(a){c.push({image:a.url,id:d++})})}})}}}]),angular.module("phundusApp").directive("phShopItemDocuments",[function(){return{restrict:"E",replace:!0,scope:{documents:"="},templateUrl:"views/directives/ph-shop-item-documents.html"}}]),angular.module("phundusApp").directive("phShopItemAvailability",["ShopItemAvailability","Alert",function(a,b){return{restrict:"E",replace:!0,scope:{itemId:"="},templateUrl:"views/directives/ph-shop-item-availability.html",link:function(c){a.get({itemId:c.itemId},function(a){c.availabilities=a.result},function(a){b.error("Fehler beim Laden der Verfügbarkeit: "+a.data.message)})}}}]),angular.module("phundusApp").directive("phShopItemAddToCart",["_","$filter","ShopItemsAvailabilityCheck","UsersCartItems","Alert","Auth","PriceCalculator","Shop",function(a,b,c,d,e,f,g,h){return{restrict:"E",replace:!0,scope:{item:"="},templateUrl:"views/directives/ph-shop-item-add-to-cart.html",link:function(i){var j=null;console.log(h);var k=i.addToCartFormModel={userId:f.user.userId,fromUtc:h.fromUtc,toUtc:h.toUtc,quantity:1,isAvailable:!1,availabilityChecking:!1};i.addToCartForm.$setPristine(!1),i.addToCartForm.$setDirty(!0),i.$watch("item",function(a){a&&(j=g(a.lessor.lessorId,a.publicPrice,a.memberPrice),k.itemId=k.articleId=a.itemId,k.pricePerWeek=b("number")(j.getPrice(),2),l())});var l=function(){if(void 0!==k.itemId){k.availabilityChecking=!0;var b=a.pick(k,["articleId","itemId","fromUtc","toUtc","quantity"]);c.post(b,function(a){k.isAvailable=a.isAvailable,k.availabilityChecking=!1},function(a){k.isAvailable=!1,k.availabilityChecking=!1,e.error("Fehler beim Prüfen der Verfügbarkeit: "+a.data.message)})}};i.checkAvailability=l,i.$watch("addToCartFormModel.fromUtc",l),i.$watch("addToCartFormModel.toUtc",l),i.$watch("addToCartFormModel.quantity",l),i.submit=function(){if(k.availabilityChecking||!k.isAvailable)return void e.error("Das Material ist im gewählten Zeitraum mit dieser Menge nicht verfügbar.");var b=a.pick(k,["fromUtc","toUtc","quantity"]);b.articleGuid=k.itemId,b.userId=f.user.userId,d.post(b,function(){h.fromUtc=b.fromUtc,h.toUtc=b.toUtc,e.success("Der Artikel wurde erfolgreich dem Warenkorb hinzugefügt.")},function(a){e.error("Fehler beim Hinzufügen des Artikels in den Warenkorb: "+a.data.message)})},i.total=function(){return j?j.getTotal(k.fromUtc,k.toUtc,k.quantity,!0):void 0}}}}]),angular.module("phundusApp").directive("phStore",["$timeout","Stores","Alert","leafletData","leafletMarkersHelpers",function(a,b,c,d,e){return{restrict:"E",replace:"true",scope:{loaded:"=",store:"=",isEditable:"="},link:function(f){var g={lat:46.80121,lng:8.226692};console.log("link",f.store),a(function(){d.getMap().then(function(a){a.setView(g,7)})},0);var h=function(){if(!f.coordinateForm.$visible&&f.store&&f.store.coordinate){if(!angular.isNumber(f.store.coordinate.latitude)||!angular.isNumber(f.store.coordinate.longitude))return;a(function(){d.getMap().then(function(a){var b={lat:f.store.coordinate.latitude,lng:f.store.coordinate.longitude};a.setView(b,16),f.marker?f.marker.setLatLng(b):(f.marker=e.createMarker(b,{draggable:!0}),f.marker.addTo(a))})},500)}};h(),f.fromMap=function(){d.getMap().then(function(a){var b=a.getCenter();f.store.coordinate={latitude:b.lat,longitude:b.lng},f.coordinateForm.$setDirty()})},f.$watch("store.coordinate.latitude",function(){h()}),f.$watch("store.coordinate.longitude",function(){h()}),f.updateAddress=function(){f.addressForm.$submitting=!0,b.patch({storeId:f.store.storeId,address:f.store.address},function(){f.addressForm.$submitting=!1,f.addressForm.$visible=!1},function(){f.addressForm.$submitting=!1,c.error("Fehler beim Speichern der Adresse.")})},f.updateOpeningHours=function(){f.openingHoursForm.$submitting=!0,b.patch({storeId:f.store.storeId,openingHours:f.store.openingHours},function(){f.openingHoursForm.$submitting=!1,f.openingHoursForm.$visible=!1},function(){f.openingHoursForm.$submitting=!1,c.error("Fehler beim Speichern der Öffnungszeiten.")})},f.updateCoordinate=function(){f.coordinateForm.$submitting=!0,b.patch({storeId:f.store.storeId,coordinate:f.store.coordinate},function(){f.coordinateForm.$submitting=!1,f.coordinateForm.$visible=!1,h()},function(){f.coordinateForm.$submitting=!1,c.error("Fehler beim Speichern der Koordinate.")})}},templateUrl:"views/directives/ph-store.html"}}]),angular.module("phundusApp").directive("phSubmit",function(){return{restrict:"E",replace:!0,scope:{form:"=",text:"@"},template:'<button class="btn" type="submit" data-ng-disabled="form.$invalid || form.$submitting || form.$pending || form.$pristine"><span class="glyphicon glyphicon-refresh glyphicon-spin" aria-hidden="true" data-ng-show="form.$submitting"></span> {{text}}</button>'}}),angular.module("phundusApp").directive("phUserArticleNavbar",["Auth",function(a){return{restrict:"E",replace:"true",scope:{userId:"=",articleId:"=",articleShortId:"="},link:function(b){b.accessLevels=a.accessLevels,b.userRoles=a.userRoles},templateUrl:"views/directives/ph-user-article-navbar.html"}}]),angular.module("phundusApp").directive("phUserNavbar",["Auth",function(a){return{restrict:"E",replace:"true",scope:!1,link:function(b){b.accessLevels=a.accessLevels,b.userRoles=a.userRoles,b.isHome=b.userId+""==a.user.userId+""},templateUrl:"views/directives/ph-user-navbar.html"}}]),angular.module("phundusApp").directive("phUserVcard",[function(){return{restrict:"E",replace:"true",scope:{user:"=",isEditable:"=",isHome:"="},templateUrl:"views/directives/ph-user-vcard.html"}}]),angular.module("phundusApp").directive("isUniqueUsername",["$q","$http",function(a,b){return{restrict:"A",require:"ngModel",link:function(c,d,e,f){f.$asyncValidators.isUnique=function(c,d){return b.post("/api/v0/username-check",{username:d}).then(function(b){return b.data.validUsername?!0:a.reject(b.data.errorMessage)})}}}}]).directive("isUniqueEmailAddress",["$q","$http",function(a,b){return{restrict:"A",require:"ngModel",link:function(c,d,e,f){f.$asyncValidators.isUnique=function(c,d){return b.post("/api/v0/email-address-check",{emailAddress:d}).then(function(b){return b.data.validEmailAddress?!0:a.reject(b.data.errorMessage)})}}}}]).directive("bothOrNone",[function(){return{restrict:"A",require:"ngModel",scope:{otherModelValue:"=bothOrNone"},link:function(a,b,c,d){console.log("otherModelValue",a.otherModelValue),d.$validators.bothOrNone=function(b){b=b||null;var c=a.otherModelValue||null,d=!1;return null!==b?d=!0:null===b&&null===c?d=!0:null===b&&null!==c&&(d=!1),d},a.$watch("otherModelValue",function(){d.$validate()})}}}]).directive("compareTo",[function(){return{restrict:"A",require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(a,b,c,d){d.$validators.compareTo=function(b){return b===a.otherModelValue},a.$watch("otherModelValue",function(){d.$validate()})}}}]),angular.module("phundusApp").filter("guid",function(){return function(a,b){return void 0===a||null===a?null:(b=b||5,a.substring(0,b))}}),angular.module("phundusApp").filter("replace",function(){return function(a,b,c){return void 0===a||null===a?null:a.replace(new RegExp(b,"mg"),c)}}),angular.module("phundusApp").factory("Alert",["$timeout","uuid4",function(a,b){var c={},d=function(a,b){delete c[a][b]},e=function(e,f){var g=b.generate();c[e]=c[e]||{},c[e][g]=f,a(d,4500,!0,e,g)};return{alerts:c,dismiss:function(a,b){d(a,b)},danger:function(a){e("danger",a)},error:function(a){e("danger",a)},info:function(a){e("info",a)},success:function(a){e("success",a)},warning:function(a){e("warning",a)}}}]),angular.module("phundusApp").factory("Auth",["$http","$cookies","_",function(a,b,c){function d(a){angular.extend(j,a),k=c.find(a.memberships,{selected:!0}),f()}function e(a){c.forEach(j.memberships,function(b){b.selected=b===a}),k=a,f()}function f(){if(k){var a=i.manager.bitMask;k.isManager?j.role.bitMask=j.role.bitMask|a:j.role.bitMask=j.role.bitMask&~a}}function g(a){if(!a)return 0;var b=c.find(j.memberships,{organizationId:a});return b&&b.isManager?i.manager.bitMask:0}var h=window.routingConfig.accessLevels,i=window.routingConfig.userRoles,j=b.getObject("ph.user")||{username:"",role:i["public"]},k=c.find(j.memberships,{selected:!0});return f(),{authorize:function(a,b,c){return void 0===b&&(b=j.role),a.bitMask&(b.bitMask|g(c))},isLoggedIn:function(a){return void 0===a&&(a=j),a.role.title===i.user.title||a.role.title===i.admin.title},isMember:function(a,b){return void 0===b&&(b=j),b.memberships&&b.memberships.some(function(b){return b.organizationId===a})},login:function(c,e,f){a.post("/api/v0/sessions",{username:c.username,password:c.password,rememberme:c.rememberme}).success(function(a){b.putObject("ph.user",a,{secure:!1}),d(a),e(a)}).error(f)},logout:function(c,e){b.remove("ph.user"),a["delete"]("/api/v0/sessions").success(function(){d({memberships:void 0,username:"",role:i["public"]}),c()}).error(e)},select:function(b,c,d){e(b),a.get("/organization/select/"+b.organizationId).success(function(a){c&&c(a)}).error(d)},accessLevels:h,userRoles:i,user:j}}]),angular.module("phundusApp").factory("Shop",[function(){var a=new Date,b=new Date;return b.setDate(b.getDate()+7),{fromUtc:a,toUtc:b}}]),angular.module("phundusApp").factory("PriceCalculator",["Auth",function(a){return function(b,c,d){var e=function(){return d&&d>0&&a.isMember(b)?d:c},f=function(a,b){return Math.max(1,Math.ceil((b-a)/864e5))},g=function(a,b,c,d){var g=f(a,b),h=Math.round(100*e()/7*g*c)/100;return d?Math.max(1,Math.round(h)):h};return{getDays:f,getPrice:e,getTotal:g}}}]),angular.module("phundusApp").config(["$resourceProvider",function(a){angular.extend(a.defaults.actions,{patch:{method:"PATCH"},post:{method:"POST"},query:{method:"GET",isArray:!1}})}]).factory("AccountChangeEmailAddress",["$resource",function(a){return a("/api/account/change-email-address")}]).factory("AccountChangePassword",["$resource",function(a){return a("/api/account/change-password")}]).factory("AccountResetPassword",["$resource",function(a){return a("/api/account/reset-password")}]).factory("AdminOrganizations",["$resource",function(a){return a("/api/v0/admin/organizations/:organizationId",{organizationId:"@organizationId"})}]).factory("AdminUsers",["$resource",function(a){return a("/api/v0/admin/users/:userId",{userId:"@userId"})}]).factory("Applications",["$resource",function(a){return a("/api/v0/organizations/:organizationId/applications/:applicationId",{organizationId:"@organizationId",applicationId:"@id"},{query:{method:"GET",isArray:!0}})}]).factory("Articles",["$resource",function(a){return a("/api/v0/articles/:articleId",{articleId:"@articleId"})}]).factory("ArticlesActions",["$resource",function(a){return a("/api/v0/articles/:articleId/actions",{articleId:"@articleId"})}]).factory("ArticlesStock",["$resource",function(a){return a("/api/v0/articles/:articleId/stock",{articleId:"@articleId"})}]).factory("Contracts",["$resource",function(a){return a("/api/v0/contracts/:contractId",{contractId:"@contractId"})}]).factory("ContractItems",["$resource",function(a){return a("/api/v0/contracts/:contractId/items/:contractItemId",{
contractId:"@contractId",contractItemId:"@contractItemId"})}]).factory("EventLog",["$resource",function(a){return a("/api/v0/event-log",{},{query:{method:"GET",isArray:!0}})}]).factory("Feedback",["$resource",function(a){return a("/api/v0/feedback")}]).factory("Lessees",["$resource",function(a){return a("/api/v0/lessees/:lesseeId",{lesseeId:"@lesseeId"})}]).factory("Lessors",["$resource",function(a){return a("/api/v0/lessors/:lessorId",{lessorId:"@lessorId"})}]).factory("Mails",["$resource",function(a){return a("/api/v0/mails/:mailId",{mailId:"@mailId"})}]).factory("Members",["$resource",function(a){return a("/api/v0/organizations/:organizationId/members/:memberId",{organizationId:"@organizationId",memberId:"@memberId"})}]).factory("Orders",["$resource",function(a){return a("/api/v0/orders/:orderId",{orderId:"@orderId"})}]).factory("OrderItems",["$resource",function(a){return a("/api/v0/orders/:orderId/items/:orderItemId",{orderId:"@orderId",orderItemId:"@orderItemId"})}]).factory("Stores",["$resource",function(a){return a("/api/v0/stores/:storeId",{storeId:"@storeId"})}]).factory("Organizations",["$resource",function(a){return a("/api/v0/organizations/:organizationId",{organizationId:"@organizationId"})}]).factory("OrganizationSettings",["$resource",function(a){return a("/api/v0/organizations/:organizationId/settings",{organizationId:"@organizationId"})}]).factory("Users",["$resource",function(a){return a("/api/v0/users/:userId",{userId:"@userId"})}]).factory("UsersCart",["$resource",function(a){return a("/api/v0/users/:userId/cart",{userId:"@userId"})}]).factory("UsersCartItems",["$resource",function(a){return a("/api/v0/users/:userId/cart/items/:cartItemId",{userId:"@userId",cartItemId:"@cartItemId"})}]).factory("Relationships",["$http",function(a){return{get:function(b,c,d){a.get("/api/v0/organizations/"+b+"/relationships").success(c).error(d)}}}]).factory("SchemaUpdate",["$resource",function(a){return a("/api/v0/schema-update")}]).factory("ShopItems",["$resource",function(a){return a("/api/v0/shop/items/:itemId",{itemId:"@itemId"})}]).factory("ShopItemAvailability",["$resource",function(a){return a("/api/v0/shop/items/:itemId/availability",{itemId:"@itemId"})}]).factory("ShopItemsAvailabilityCheck",["$resource",function(a){return a("/api/v0/shop/items/:itemId/availability-check",{itemId:"@articleId"})}]).factory("ShopOrders",["$resource",function(a){return a("/api/v0/shop/orders")}]).factory("Validate",["$resource",function(a){return a("/api/v0/account/validate")}]),angular.module("phundusApp").service("uuid4",function(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";this.generate=function(){return a.replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})}}),angular.module("phundusApp").directive("accessLevel",["Auth",function(a){return{restrict:"A",link:function(b,c,d){function e(){f&&g&&(a.authorize(g,f,h)?c.css("display",i):c.css("display","none"))}var f,g,h,i=c.css("display");b.user=a.user,b.$watch("user",function(a){a.role&&(f=a.role),e()},!0),d.$observe("accessLevel",function(a){a&&(g=b.$eval(a)),e()}),d.$observe("organizationId",function(a){a&&(h=b.$eval(a)),e()})}}}]),angular.module("phundusApp").directive("activeNav",["$location",function(a){function b(a){return"/"!==a[a.length-1]&&(a+="/"),a}return{restrict:"A",link:function(c,d,e){var f=d[0];"A"!==d[0].tagName.toUpperCase()&&(f=d.find("a")[0]);var g=f.href;c.location=a,c.$watch("location.absUrl()",function(a){g=b(g),a=b(a),g===a||"nestedTop"===e.activeNav&&0===a.indexOf(g)?d.addClass("active"):d.removeClass("active")})}}}]),angular.module("phundusApp").run(["$templateCache",function(a){"use strict";a.put("views/404.html","<h2>404</h2> <p>Hier ist nichts zu finden.</p> <div ui-view></div>"),a.put("views/account/logged-out.html",'<div class="row"> <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6 col-sm-offset-1 col-md-offset-2 col-lg-offset-3"> <div class="page-header"> <h1>Danke <small>dass du s`phundus benutzt!</small> </h1> </div> <div role="alert" class="alert alert-success"> <strong>Alles klar!</strong> Du bist nun abgemeldet. </div> </div> </div>'),a.put("views/account/login.html",'<div class="row"> <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6 col-sm-offset-1 col-md-offset-2 col-lg-offset-3"> <div class="page-header"> <h1>Anmeldung</h1> </div> <form name="loginForm" novalidate> <div class="form-group" data-has-error="loginForm.username"> <!--<label class="control-label" for="username">E-Mail-Adresse</label>--> <input type="email" class="form-control input-lg" data-ng-model="username" placeholder="E-Mail-Adresse" id="username" name="username" required autofocus> </div> <div class="form-group" data-has-error="loginForm.password"> <!--<label class="control-label" for="password">Passwort</label>--> <input type="password" class="form-control input-lg" data-ng-model="password" placeholder="Passwort" id="password" name="password" required> </div> <div class="form-group"> <p> <ph-submit class="btn-primary btn-lg" data-ng-click="login()" data-form="loginForm" data-text="Anmelden"></ph-submit> </p> </div> </form> <div style="margin-top:40px"> <p> Passwort vergessen? Ein neues <a href="" data-ui-sref="anon.reset-password">anfordern</a>! </p> <p> Noch nicht dabei? Jetzt kostenlos <a href="" data-ui-sref="anon.signup">registrieren</a>. </p> </div> </div> </div> <div data-ng-show="isTestEnv"> <div class="row" style="margin-top: 20px"> <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6 col-sm-offset-1 col-md-offset-2 col-lg-offset-3"> <h3>Test-Umgebung</h3> <p>One-Click-Logins in der Test-Umgebung</p> <p> <button class="btn btn-default" type="button" data-ng-click="autoLogin(\'user@test.phundus.ch\')">user</button> <button class="btn btn-default" type="button" data-ng-click="autoLogin(\'user-1@test.phundus.ch\')">user-1 </button> <button class="btn btn-default" type="button" data-ng-click="autoLogin(\'user-2@test.phundus.ch\')">user-2 </button> </p> <p> <button class="btn btn-default" type="button" data-ng-click="autoLogin(\'chief@test.phundus.ch\')">chief</button> <button class="btn btn-default" type="button" data-ng-click="autoLogin(\'chief-1@test.phundus.ch\')">chief-1 </button> <button class="btn btn-default" type="button" data-ng-click="autoLogin(\'chief-2@test.phundus.ch\')">chief-2 </button> </p> <p> <button class="btn btn-default" type="button" data-ng-click="autoLogin(\'admin@test.phundus.ch\')">admin</button> <button class="btn btn-default" type="button" data-ng-click="autoLogin(\'admin-1@test.phundus.ch\')">admin-1 </button> <button class="btn btn-default" type="button" data-ng-click="autoLogin(\'admin-2@test.phundus.ch\')">admin-2 </button> </p> </div> </div> </div>'),a.put("views/account/logout.html",'<div class="row"> <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6 col-sm-offset-1 col-md-offset-2 col-lg-offset-3"> <div class="page-header"> <h1>Abmeldung</h1> </div> <div role="alert" class="alert alert-info" data-ng-hide="errorMessage"> <strong>Einen Moment!</strong> Du wirst gleich abgemeldet. </div> <div role="alert" class="alert alert-danger" data-ng-show="errorMessage"> <strong>Hmm...</strong> {{errorMessage}} </div> </div> </div>'),a.put("views/account/reset-password.html",'<div class="row" data-ng-show="submitted"> <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3"> <div class="page-header"> <h1>Passwort zurücksetzen</h1> </div> <div role="alert" class="alert alert-success"> <strong>Alles klar!</strong> Ein neues Passwort wurde an die angegebene E-Mail-Adresse gesendet. </div> </div> </div> <div class="row" data-ng-hide="submitted"> <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3"> <div class="page-header"> <h1>Passwort zurücksetzen</h1> </div> <form name="form" novalidate> <div class="form-group" data-has-error="form.emailAddress"> <label class="control-label" for="emailAddress">E-Mail-Adresse</label> <input type="email" class="form-control input-lg" id="emailAddress" name="emailAddress" data-ng-model="resetPassword.emailAddress" required> <div role="alert" data-ng-messages="form.emailAddress.$error" data-ng-show="form.emailAddress.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group"> <ph-submit class="btn-primary btn-lg" data-ng-click="submit()" data-form="form" data-text="Password zurücksetzen"></ph-submit> </div> </form> </div> </div>'),a.put("views/account/signup.html",'<div class="row"> <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6 col-sm-offset-1 col-md-offset-2 col-lg-offset-3"> <div class="page-header"> <h1>Registrierung</h1> </div> </div> </div> <div class="row" data-ng-show="submitted"> <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6 col-sm-offset-1 col-md-offset-2 col-lg-offset-3"> <p>Um die Registrierung abzuschliessen, musst du deine E-Mail-Adresse bestätigen. Dazu wurde dir ein E-Mail geschickt, in welchem sich einen Link befindet, um die Registrierung abzuschliessen.</p> <p>Falls du eine Organisation ausgewählt hast, wird nun deine Mitgliedschaftsanfrage manuell überprüft. Gewisse Materialien sowie die Vorzugspreise der Organisation stehen dir bis dahin noch nicht zur Verfügung. Du erhälst eine Benachrichtigung per E-Mail sobald du für die Organisation freigegeben wurdest.</p> </div> </div> <div class="row" data-ng-hide="submitted"> <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6 col-sm-offset-1 col-md-offset-2 col-lg-offset-3"> <p>Für die Anmeldung ist die Eingabe der persönlichen J+S Personen Nummer erforderlich. Die J+S Anerkennung muss nicht gültig sein, die Nummer dient nur zur Erkennung ob eine Tätigkeit in einem Jugendverband der Nutzergruppe 3 (Lagersport und Trekking) vorhanden war. Die Nummer findest du auf deinem J+S Ausweis im Kreditkartenformat oder durch Rückfrage bei deinem J+S Coach.</p> <p>Mit der Anmeldung bestätigst du verantwortungsbewusst mit den Materialen umzugehen. Dir ist ersichtlich, dass du Teil einer sehr grossen Interessensgemeinschaft bist und vermeidest Nachlässigkeiten. Bestätigte Buchungen können nicht rückgängig gemacht werden. Der Mietbetrag ist beim Abholen des Material bar zu bezahlen. Bei Unsachgemässer Anwendung kannst du jederzeit vom phundus ausgeschlossen werden.</p> </div> </div> <div class="row" data-ng-hide="submitted"> <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6 col-sm-offset-1 col-md-offset-2 col-lg-offset-3"> <form class="form-horizontal" name="form" novalidate> <fieldset> <legend>Benutzerkonto</legend> <div class="form-group"> <label class="col-sm-5 control-label" for="emailAddress">E-Mail-Adresse</label> <div class="col-sm-7" data-has-error="form.emailAddress"> <input type="email" class="form-control" id="emailAddress" name="emailAddress" data-ng-model="user.emailAddress" data-ng-model-options="{ debounce: 500 }" required is-unique-email-address> <div role="alert" data-ng-messages="form.emailAddress.$error" data-ng-show="form.emailAddress.$touched || form.$submitted"> <span class="help-block" data-ng-message="isUnique">Die E-Mail-Adresse wird bereits verwendet.</span> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <label class="col-sm-5 control-label" for="password">Passwort</label> <div class="col-sm-7" data-has-error="form.password"> <input type="password" class="form-control" id="password" name="password" data-ng-model="user.password" required> <div role="alert" data-ng-messages="form.password.$error" data-ng-show="form.password.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <label class="col-sm-5 control-label" for="confirmPassword">Passwort (Wiederholung)</label> <div class="col-sm-7" data-has-error="form.confirmPassword"> <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" data-ng-model="user.confirmPassword" required data-compare-to="user.password"> <div role="alert" data-ng-messages="form.confirmPassword.$error" data-ng-show="form.confirmPassword.$touched || form.$submitted"> <div class="help-block" data-ng-message="compareTo">Die Passwort-Wiederholung stimmt nicht mit dem Passwort überein. </div> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> </fieldset> <fieldset> <legend>Kontakt</legend> <div class="form-group"> <label class="col-sm-5 control-label" for="firstName">Vorname</label> <div class="col-sm-7" data-has-error="form.firstName"> <input type="text" class="form-control" id="firstName" name="firstName" data-ng-model="user.firstName" required> <div role="alert" data-ng-messages="form.firstName.$error" data-ng-show="form.firstName.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <label class="col-sm-5 control-label" for="lastName">Nachname</label> <div class="col-sm-7" data-has-error="form.lastName"> <input type="text" class="form-control" id="lastName" name="lastName" data-ng-model="user.lastName" required> <div role="alert" data-ng-messages="form.lastName.$error" data-ng-show="form.lastName.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <label class="col-sm-5 control-label" for="street">Strasse</label> <div class="col-sm-7" data-has-error="form.street"> <input type="text" class="form-control" id="street" name="street" data-ng-model="user.street" required> <div role="alert" data-ng-messages="form.street.$error" data-ng-show="form.street.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <label class="col-sm-5 control-label" for="postcode">Postleitzahl</label> <div class="col-sm-7" data-has-error="form.postcode"> <input type="number" class="form-control" id="postcode" name="postcode" data-ng-model="user.postcode" required min="1000" max="9999"> <div role="alert" data-ng-messages="form.postcode.$error" data-ng-show="form.postcode.$touched || form.$submitted"> <span class="help-block" data-ng-message="number, min, max">Die Postleitzahl ist ungültig.</span> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <label class="col-sm-5 control-label" for="city">Ort</label> <div class="col-sm-7" data-has-error="form.city"> <input type="text" class="form-control" id="city" name="city" data-ng-model="user.city" required> <div role="alert" data-ng-messages="form.city.$error" data-ng-show="form.city.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <label class="col-sm-5 control-label" for="mobilePhone">Mobiltelefon</label> <div class="col-sm-7" data-has-error="form.mobilePhone"> <input type="text" class="form-control" id="mobilePhone" name="mobilePhone" data-ng-model="user.mobilePhone" required> <div role="alert" data-ng-messages="form.mobilePhone.$error" data-ng-show="form.mobilePhone.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> </fieldset> <fieldset> <legend>Mitgliedschaft</legend> <div class="form-group"> <label class="col-sm-5 control-label" for="organization">Ich bin Mitglied folgender Organisation</label> <div class="col-sm-7"> <select class="form-control" id="organization" name="organizationId" data-ng-model="user.organizationId" data-ng-options="organization.organizationId as organization.name for organization in organizations"> <option></option> </select> <span class="help-block"><span class="glyphicon glyphicon-info-sign"></span> Weitere Mitgliedschaften kannst du nach der Registrierung über die jeweilige Organisationsseite beantragen.</span> </div> </div> </fieldset> <div class="form-group"> <div class="col-sm-offset-5 col-sm-7"> <ph-submit class="btn-primary" data-ng-click="submit()" data-form="form" data-text="Registrieren"></ph-submit> <a class="btn-default btn" href="/">Abbrechen</a> </div> </div> </form> </div> </div>'),a.put("views/admin/eventlog.html",'<p>Die letzten 20 Ereignisse.</p> <table class="table"> <thead> <tr> <th>Datum</th> <th>Typ</th> <th>Text</th> </tr> </thead> <tbody> <tr data-ng-repeat="event in eventLog"> <td>{{event.occuredOnUtc | date: \'medium\'}}</td> <td>{{event.name}}</td> <td>{{event.text}}</td> </tr> </tbody> </table>'),a.put("views/admin/mails.html",'<table class="table table-hover" data-st-table="displayedCollection" data-st-safe-src="rowCollection"> <thead> <tr> <th colspan="4"><input data-st-search class="form-control" type="search" placeholder="Suchen..."></th> </tr> <tr> <th data-st-sort="date">Datum</th> <th data-st-sort="subject">Betreff</th> <th>Empfänger</th> <th class="text-right"><a class="btn btn-danger" data-ng-click="delete()">Alle löschen</a></th> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedCollection"> <td>{{row.date|date:\'dd.MM.yyyy HH:mm:ss\'}}</td> <td>{{row.subject}}</td> <td><span data-ng-repeat="to in row.to">{{to}}</span></td> <td class="text-right"> <a class="btn btn-default btn-sm" href="/api/v0/mails/{{row.mailId}}/html" target="_blank" data-ng-show="row.hasHtmlPart">HTML</a> <a class="btn btn-default btn-sm" href="/api/v0/mails/{{row.mailId}}/text" target="_blank" data-ng-show="row.hasTextPart">Text</a> <a class="btn btn-danger btn-sm" href="" data-ng-click="delete(row)">Löschen</a></td> </tr> </tbody> </table> <div class="alert alert-info" data-ng-show="!loading && rowCollection.length == 0"> <strong>Nichts gefunden!</strong> Es sind keine E-Mails vorhanden. </div> <div class="alert alert-info" data-ng-show="!loading && displayedCollection.length == 0 && rowCollection.length > 0"> <strong>Nichts gefunden!</strong> Deine Suche liefert keine Ergebnisse. </div>'),a.put("views/admin/organizations.html",'<table class="table table-hover" data-st-table="displayedCollection" data-st-safe-src="rowCollection"> <thead> <tr> <th colspan="7"><input data-st-search class="form-control" type="search" placeholder="Suchen..."></th> </tr> <tr> <th data-st-sort="organizationId">Id</th> <th data-st-sort="name">Name</th> <th data-st-sort="establishedAtUtc">Erstellt</th> <th class="text-right"><button type="button" class="btn btn-primary" data-ng-click="establishOrganization()">Neue Organisation</button></th> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedCollection"> <td><ph-guid data-value="row.organizationId"></ph-guid></td> <td>{{row.name}}</td> <td><ph-date data-value="row.establishedAtUtc"></ph-date></td> <td></td> </tr> </tbody> </table> <div class="alert alert-info" data-ng-show="rowCollection.length == 0"> <strong>Nichts gefunden!</strong> Es sind keine Organisationen vorhanden. </div> <div class="alert alert-info" data-ng-show="displayedCollection.length == 0 && rowCollection.length > 0"> <strong>Nichts gefunden!</strong> Deine Suche liefert keine Ergebnisse. </div>'),a.put("views/admin/users.html",'<table class="table table-hover" data-st-table="displayedCollection" data-st-safe-src="rowCollection"> <thead> <tr> <th colspan="9"><input data-st-search class="form-control" type="search" placeholder="Suchen..."></th> </tr> <tr> <th data-st-sort="userId">Id</th> <th data-st-sort="firstName">Vorname</th> <th data-st-sort="lastName">Nachname</th> <th data-st-sort="emailAddress">E-Mail-Adresse</th> <th data-st-sort="signedUpAtUtc">Registriert am</th> <th data-st-sort="lastLogInAtUtc">Letztes Login</th> <th data-st-sort="isApproved">Bestätigt</th> <th data-st-sort="isAdmin">Admin</th> <th data-st-sort="isLocked">Gesperrt</th> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedCollection"> <td><ph-guid value="row.userId"></ph-guid></td> <td>{{row.firstName}}</td> <td>{{row.lastName}}</td> <td>{{row.emailAddress}}</td> <td><ph-date value="row.signedUpAtUtc"></ph-date></td> <td><ph-date value="row.lastLogInAtUtc"></ph-date></td> <td> <ph-checkbox data-spin="row.isApprovedSubmitting"> <input type="checkbox" data-ng-model="row.isApproved" data-ng-change="toggleIsApproved(row)" data-ng-disabled="row.isApproved"> <label></label> </ph-checkbox> </td> <td> <ph-checkbox class="checkbox-danger" data-spin="row.isAdminSubmitting"> <input type="checkbox" data-ng-model="row.isAdmin" data-ng-change="toggleIsAdmin(row)"> <label></label> </ph-checkbox> </td> <td> <ph-checkbox class="checkbox-warning" data-spin="row.isLockedSubmitting"> <input type="checkbox" data-ng-model="row.isLocked" data-ng-change="toggleIsLocked(row)"> <label></label> </ph-checkbox> </td> </tr> </tbody> </table> <div class="alert alert-info" data-ng-show="rowCollection.length == 0"> <strong>Nichts gefunden!</strong> Es sind keine Benutzer vorhanden. </div> <div class="alert alert-info" data-ng-show="displayedCollection.length == 0 && rowCollection.length > 0"> <strong>Nichts gefunden!</strong> Deine Suche liefert keine Ergebnisse. </div>'),a.put("views/debug.html",'<h2>Debug</h2> <p>Host: {{host}}</p> <p>IsTestEnv: {{isTestEnv}}</p> <p><button class="btn btn-default" data-ng-click="toggleCartPopover()">Zeige Warenkorb-Meldung</button></p> <h2>Test Alerts</h2> <form> <div class="form-group"> <input type="text" class="form-control" id="inputAlertMsg" data-ng-model="alertMsg"> </div> <button class="btn btn-default" data-ng-click="addError()">Add error</button> <button class="btn btn-default" data-ng-click="addDanger()">Add danger</button> <button class="btn btn-default" data-ng-click="addWarning()">Add warning</button> <button class="btn btn-default" data-ng-click="addSuccess()">Add success</button> </form> <h2>Status</h2> <pre>{{status|json}}</pre> <h2>Cookies</h2> <pre>{{cookies|json}}</pre>'),a.put("views/directives/ph-organization-article-navbar.html",'<ul class="nav nav-tabs" style="margin-bottom:10px"> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="organizations.articles.edit.details({organizationId: organizationId, articleShortId: articleShortId, articleId: articleId})">#{{articleShortId}}</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="organizations.articles.edit.description({organizationId: organizationId, articleShortId: articleShortId, articleId: articleId})">Beschreibung</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="organizations.articles.edit.specification({organizationId: organizationId, articleShortId: articleShortId, articleId: articleId})">Spezifikation</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="organizations.articles.edit.stock({organizationId: organizationId, articleShortId: articleShortId, articleId: articleId})">Bestand</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="organizations.articles.edit.files({organizationId: organizationId, articleShortId: articleShortId, articleId: articleId})">Dateien</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="organizations.articles.edit.actions({organizationId: organizationId, articleShortId: articleShortId, articleId: articleId})" title="Aktivitäten"><span class="glyphicon glyphicon-flash"></span></a> </li> </ul>'),a.put("views/directives/ph-organization-navbar.html",'<ul class="nav nav-tabs" style="margin-bottom:10px" data-access-level="accessLevels.manager" data-organization-id="organizationId"> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="public.organization({organizationId: organizationId})" title="Profil"><span class="glyphicon glyphicon-home"></span></a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="organizations.stores.index({organizationId: organizationId})">Materialstelle</a> </li> <li role="presentation" data-ui-sref-active="active" active-nav="nestedTop"> <a href="" data-ui-sref="manage.organization.orders({organizationId: organizationId})">Bestellungen</a> </li> <li role="presentation" data-ui-sref-active="active" active-nav="nestedTop"> <a href="" data-ui-sref="organizations.articles.index({organizationId: organizationId})">Material</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="manage.organization.members({organizationId: organizationId})">Mitglieder</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="manage.organization.applications({organizationId: organizationId})">Beitrittsanfragen</a> </li> <li role="presentation" class="pull-right" data-ui-sref-active="active"> <a href="" data-ui-sref="organizations.settings({organizationId: organizationId})" title="Einstellungen"><span class="glyphicon glyphicon-cog"></span></a> </li> <li role="presentation" class="pull-right" data-ui-sref-active="active"> <a href="" data-ui-sref="manage.organization.files({organizationId: organizationId})" title="Dateien"><span class="glyphicon glyphicon-file"></span></a> </li> </ul>'),a.put("views/directives/ph-shop-item-add-to-cart.html",'<div> <form name="addToCartForm" novalidate> <div class="form-group" data-has-error="addToCartForm.fromUtc"> <label class="control-label" for="fromUtc">Von</label> <p class="input-group"> <input type="text" class="form-control" id="fromUtc" name="fromUtc" data-ng-model="addToCartFormModel.fromUtc" required data-uib-datepicker-popup="mediumDate" data-is-open="fromUtcIsOpen"> <span class="input-group-btn"> <button type="button" class="btn btn-default" data-ng-click="fromUtcIsOpen = true"> <i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </div> <div class="form-group" data-has-error="addToCartForm.toUtc"> <label class="control-label" for="toUtc">Bis</label> <p class="input-group"> <input type="text" class="form-control" id="toUtc" name="toUtc" data-ng-model="addToCartFormModel.toUtc" required data-uib-datepicker-popup="mediumDate" data-is-open="toUtcIsOpen"> <span class="input-group-btn"> <button type="button" class="btn btn-default" data-ng-click="toUtcIsOpen = true"> <i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </div> <div class="col-xs-6 form-group" style="margin-left:0;padding-left:0"> <label class="control-label" for="pricePerWeek">Preis / Woche</label> <input type="text" class="form-control" id="pricePerWeek" name="pricePerWeek" data-ng-model="addToCartFormModel.pricePerWeek" readonly> </div> <div class="col-offset-xs-6 col-xs-6 from-group" style="margin-right:0;padding-right:0" data-has-error="addToCartForm.quantity"> <label class="control-label" for="quantity">Anzahl</label> <input type="number" class="form-control" id="quantity" name="quantity" data-ng-model="addToCartFormModel.quantity" required min="1"> </div> <div class="col-xs-12" style="margin:0;padding:0"> <button type="button" class="btn btn-success" data-ng-show="addToCartFormModel.isAvailable && !addToCartFormModel.availabilityChecking" data-ng-click="checkAvailability(addToCartFormModel)" title="Verfügbar!"><span class="glyphicon glyphicon-ok"></span> </button> <button type="button" class="btn btn-danger" data-ng-show="!addToCartFormModel.isAvailable && !addToCartFormModel.availabilityChecking" data-ng-click="checkAvailability(addToCartFormModel)" title="Nicht verfügbar!"> <span class="glyphicon glyphicon-remove"></span> </button> <button type="button" class="btn btn-default" data-ng-show="addToCartFormModel.availabilityChecking"><span class="glyphicon glyphicon-refresh glyphicon-spin" title="Verfügbarkeit wird geprüft..."></span> </button> <ph-submit class="btn-primary" data-ng-click="submit()" data-form="addToCartForm" data-text="{{total()|number:2}} CHF | Hinzufügen"></ph-submit> </div> </form> </div>'),a.put("views/directives/ph-shop-item-availability.html",'<table class="table table-bordered table-hover table-striped" data-st-table="availabilities"> <thead> <tr> <th>Datum</th> <th>Anzahl</th> </tr> </thead> <tbody> <tr data-ng-repeat="each in availabilities"> <td>{{each.fromUtc | date:\'mediumDate\'}}</td> <td>{{each.amount}}</td> </tr> </tbody> </table>'),a.put("views/directives/ph-shop-item-documents.html",'<table class="table table-bordered table-hover table-striped" data-st-table="documents"> <thead> <tr> <th data-st-sort="fileName" data-st-sort-default="true">Name</th> <th data-st-sort="fileLength">Grösse</th> </tr> </thead> <tbody> <tr data-ng-repeat="document in documents"> <td><a href="{{document.url}}" target="_blank">{{document.fileName}}</a></td> <td>{{document.fileLength | formatFileSize}}</td> </tr> </tbody> </table>'),a.put("views/directives/ph-shop-item-images.html",'<div> <uib-carousel interval="5000" no-wrap="false"> <uib-slide ng-repeat="slide in slides" active="slide.active" index="slide.id"> <img ng-src="{{slide.image}}" style="margin:auto;height:300px"> </uib-slide> </uib-carousel> </div>'),a.put("views/directives/ph-shop-search.html",'<div class="row search-box"> <div class="col-xs-12"> <form class="form-inline"> <div class="form-group"> <label class="sr-only" for="searchQuery">Search query</label> <input type="text" class="form-control" id="searchQuery" placeholder="Suchen" data-ng-model="searchQuery"> </div> in <div class="form-group"> <label class="sr-only" for="lessor">Lessor</label> <select class="form-control" id="lessor" name="lessorId" data-ng-model="lessorId" data-ng-options="each.lessorGuid as each.name for each in lessors"> <option value="">allen Organisationen</option> </select> </div> <button type="submit" class="btn btn-primary" data-ng-click="submit(searchQuery, lessorId)">phinden!</button> </form> </div> </div>'),a.put("views/directives/ph-store.html",'<div data-ng-show="store" class="store"> <form name="addressForm" ph-editable="store.address" class="form-horizontal" novalidate> <div class="form-group"> <label class="col-sm-3">Adresse <button type="button" class="btn btn-default btn-sm pull-right" data-ng-click="addressForm.$show()" data-ng-hide="addressForm.$visible"> <span class="glyphicon glyphicon-pencil"></span> </button> </label> <div class="col-xs-12 col-sm-9" data-ng-hide="addressForm.$visible"> <p style="white-space:pre">{{store.address}}</p> </div> <div class="col-xs-12 col-sm-9" data-has-error="addressForm.address"> <div data-ng-show="addressForm.$visible"> <textarea class="form-control" data-ng-model="store.address" rows="4" name="address" required>{{store.address}}</textarea> </div> </div> </div> <div class="form-group" data-ng-show="addressForm.$visible"> <div class="col-sm-offset-3 col-sm-9"> <ph-submit class="btn-primary" data-ng-click="updateAddress()" data-form="addressForm" data-text="Speichern"></ph-submit> <button type="button" class="btn btn-default" data-ng-click="addressForm.$cancel()"> Abbrechen </button> </div> </div> </form> <form name="openingHoursForm" ph-editable="store.openingHours" class="form-horizontal" novalidate> <div class="form-group"> <label class="col-sm-3">Öffnungszeiten <button type="button" class="btn btn-default btn-sm pull-right" data-ng-click="openingHoursForm.$show()" data-ng-hide="openingHoursForm.$visible"> <span class="glyphicon glyphicon-pencil"></span> </button> </label> <div class="col-xs-12 col-sm-9" data-ng-hide="openingHoursForm.$visible"> <p style="white-space:pre">{{store.openingHours}}</p> </div> <div class="col-xs-12 col-sm-9" data-has-error="openingHoursForm.openingHours"> <div data-ng-show="openingHoursForm.$visible"> <textarea class="form-control" data-ng-model="store.openingHours" rows="4" name="openingHours" required>{{store.openingHours}}</textarea> </div> </div> </div> <div class="form-group" data-ng-show="openingHoursForm.$visible"> <div class="col-sm-offset-3 col-sm-9"> <ph-submit class="btn-primary" data-ng-click="updateOpeningHours()" data-form="openingHoursForm" data-text="Speichern"></ph-submit> <button type="button" class="btn btn-default" data-ng-click="openingHoursForm.$cancel()"> Abbrechen </button> </div> </div> </form> <form name="coordinateForm" ph-editable="coordinate" class="form-horizontal" novalidate> <div class="form-group"> <label class="col-sm-3">Koordinaten <button type="button" class="btn btn-default btn-sm pull-right" data-ng-click="coordinateForm.$show()" data-ng-hide="coordinateForm.$visible"> <span class="glyphicon glyphicon-pencil"></span> </button> </label> <div class="col-xs-12 col-sm-9" data-ng-hide="coordinateForm.$visible"> <p>{{store.coordinate.latitude}}</p> <p>{{store.coordinate.longitude}}</p> </div> <div class="col-xs-12 col-sm-9" data-ng-show="coordinateForm.$visible" data-has-error="coordinateForm.latitude"> <div data-ng-show="coordinateForm.$visible"> <input type="number" class="form-control" id="latitude" name="latitude" data-ng-model="store.coordinate.latitude" data-both-or-none="store.coordinate.longitude"> <div role="alert" data-ng-messages="coordinateForm.latitude.$error" data-ng-show="coordinateForm.latitude.$touched || form.$submitted"> </div> </div> </div> </div> <div class="form-group"> <div class="col-xs-12 col-sm-offset-3 col-sm-9" data-ng-show="coordinateForm.$visible" data-has-error="coordinateForm.longitude"> <div data-ng-show="coordinateForm.$visible"> <input type="number" class="form-control" id="longitude" name="longitude" data-ng-model="store.coordinate.longitude" data-both-or-none="store.coordinate.latitude"> <div role="alert" data-ng-messages="coordinateForm.longitude.$error" data-ng-show="coordinateForm.longitude.$touched || form.$submitted"> </div> </div> </div> </div> <div class="form-group" data-ng-show="coordinateForm.$visible"> <div class="col-sm-offset-3 col-sm-9"> <button type="button" class="btn btn-default btn-sm" data-ng-disabled="coordinateForm.$submitting" data-ng-click="fromMap()" title="Koordinate von der Karte übertragen"><span class="glyphicon glyphicon-arrow-up"></span></button> <ph-submit class="btn-primary" data-ng-click="updateCoordinate()" data-form="coordinateForm" data-text="Speichern"></ph-submit> <button type="button" class="btn btn-default" data-ng-click="coordinateForm.$cancel()"> Abbrechen </button> </div> </div> </form> <div class="row"> <div class="col-sm-12"> <leaflet width="100%" height="400px" style="margin-bottom:10px"></leaflet> </div> </div> </div>'),
a.put("views/directives/ph-user-article-navbar.html",'<ul class="nav nav-tabs" style="margin-bottom:10px"> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="user.articles.article.details({userId: userId, articleId: articleId, articleShortId: articleShortId})">#{{articleShortId}}</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="user.articles.article.description({userId: userId, articleId: articleId, articleShortId: articleShortId})">Beschreibung</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="user.articles.article.specification({userId: userId, articleId: articleId, articleShortId: articleShortId})">Spezifikation</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="user.articles.article.stock({userId: userId, articleId: articleId, articleShortId: articleShortId})">Bestand</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="user.articles.article.files({userId: userId, articleId: articleId, articleShortId: articleShortId})">Dateien</a> </li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="user.articles.article.actions({userId: userId, articleId: articleId})" title="Aktivitäten"><span class="glyphicon glyphicon-flash"></span></a> </li> </ul>'),a.put("views/directives/ph-user-navbar.html",'<ul class="nav nav-tabs" style="margin-bottom:10px" data-ng-show="isHome"> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="user.home({userId: userId})" title="Profil"><span class="glyphicon glyphicon-user"></span></a> </li> <li role="presentation" data-ui-sref-active="active" active-nav="nestedTop" data-ng-show="user.store"> <a href="" data-ui-sref="user.articles.index({userId: userId})">Material</a> </li> <li role="presentation" data-ui-sref-active="active" active-nav="nestedTop"> <a href="" data-ui-sref="user.orders.index({userId: userId})">Bestellungen</a> </li> <li role="presentation" class="pull-right" data-ui-sref-active="active"> <a href="" data-ui-sref="user.account({userId: userId})" title="Einstellungen"><span class="glyphicon glyphicon-cog"></span></a> </li> </ul>'),a.put("views/directives/ph-user-vcard.html",'<div class="vcard"> <a class="vcard-avatar"> <img class="avatar img-responsive" src="" data-gravatar-src-once="user.email" data-gravatar-size="262"> </a> <h1 class="vcard-names"> <span class="vcard-fullname">{{user.fullName}}</span> </h1> <div class="vcard-memberships" data-ng-show="user.memberships.length > 0 || isHome"> <div class="panel panel-default"> <div class="panel-heading">Mitgliedschaften</div> <div class="panel-body" data-ng-hide="!isHome || user.memberships.length > 0"><a href="" data-ui-sref="public.organizations">Suche</a> und beantrage bei Organisationen die Mitgliedschaft um weitere Artikel auszuleihen oder von günstigeren Preisen zu profitieren!</div> <table class="table" data-ng-show="user.memberships.length"> <tr data-ng-repeat="membership in user.memberships"> <td><a href="/{{membership.organizationUrl}}"> {{membership.organizationName}}</a> </td> </tr> </table> </div> </div> </div>'),a.put("views/inventory/article-actions.html",'<div class="actions" data-ng-repeat="row in actions" data-ng-switch="row.type" style="margin-top:10px"> <strong data-ng-show="row.data.initiator">{{row.data.initiator.FullName}}</strong> <span data-ng-hide="row.data.initiator">Jemand</span> <span data-ng-switch-when="ArticleCreated">hat den Artikel <b>{{row.data.name}}</b> erfasst.</span> <span data-ng-switch-when="PricesChanged">hat die Preise angepasst.</span> <span data-ng-switch-when="SpecificationChanged">hat die Spezifikation aktualisiert.</span> <span data-ng-switch-when="DescriptionChanged">hat die Beschreibung aktualisiert.</span> <span data-ng-switch-when="ImageAdded">hat eine neue Datei hinzugefügt.</span> <span data-ng-switch-when="ImageRemoved">hat eine Datei entfernt.</span> <span data-ng-switch-default=""> {{row.name}} </span> <br> <span am-time-ago="row.occuredOnUtc" title="{{row.occuredOnUtc | date:\'medium\'}}" class="text-muted" style="display:inline-block"></span> </div>'),a.put("views/manage/edit-article-description.html",'<div class="row"> <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <form name="form"> <div class="form-group"> <textarea class="form-control" data-ui-tinymce rows="20" data-ng-model="data.description" autofocus></textarea> </div> <div class="form-group"> <ph-submit class="btn-primary" data-ng-click="submit()" data-form="form" data-text="Speichern"></ph-submit> <a class="btn btn-default" href="" data-ng-click="cancel()">Abbrechen</a> </div> </form> </div> </div>'),a.put("views/manage/edit-article-details.html",'<div class="row" data-ng-show="article"> <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6"> <form class="form-horizontal" name="form" novalidate> <div class="form-group"> <label class="control-label col-sm-3" for="name">Name</label> <div class="col-sm-9" data-has-error="form.name"> <input type="text" class="form-control" id="name" name="name" data-ng-model="article.name" required autofocus> <div role="alert" data-ng-messages="form.name.$error" data-ng-show="form.name.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <label class="control-label col-sm-3" for="brand">Marke</label> <div class="col-sm-9" data-has-error="form.brand"> <input type="text" class="form-control" id="brand" name="brand" data-ng-model="article.brand"> <div role="alert" data-ng-messages="form.brand.$error" data-ng-show="form.brand.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <label class="control-label col-sm-3" for="grossStock">Bestand (Brutto)</label> <div class="col-sm-9" data-has-error="form.grossStock"> <input type="number" class="form-control" id="grossStock" name="grossStock" data-ng-model="article.grossStock" min="0" required> <div role="alert" data-ng-messages="form.grossStock.$error" data-ng-show="form.grossStock.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <label class="control-label col-sm-3" for="color">Farbe</label> <div class="col-sm-9" data-has-error="form.color"> <input type="text" class="form-control" id="color" name="color" data-ng-model="article.color"> <div role="alert" data-ng-messages="form.color.$error" data-ng-show="form.color.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-3 col-sm-9"> <ph-submit class="btn-primary" data-ng-click="submit()" data-form="form" data-text="Speichern"></ph-submit> <a class="btn btn-default" href="" data-ng-click="cancel()">Abbrechen</a> </div> </div> </form> </div> <div class="col-xs-12 col-sm-10 col-md-4 col-lg-offset-2 col-lg-4"> <div class="panel panel-default"> <div class="panel-heading"> <h3 class="panel-title">Preis pro Woche</h3> </div> <div class="panel-body"> <form name="formPrices" novalidate> <div class="form-group" data-has-error="formPrices.memberPrice" data-ng-show="organizationId"> <label class="control-label" for="memberPrice">Mitglieder</label> <input type="number" class="form-control" id="memberPrice" name="memberPrice" data-ng-model="pricesFormModel.memberPrice" min="0.01"> <div role="alert" data-ng-messages="formPrices.memberPrice.$error" data-ng-show="formPrices.memberPrice.$touched || formPrices.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group" data-has-error="formPrices.publicPrice"> <label class="control-label" for="publicPrice">Externe</label> <input type="number" class="form-control" id="publicPrice" name="publicPrice" data-ng-model="pricesFormModel.publicPrice" min="0.01"> <div role="alert" data-ng-messages="formPrices.publicPrice.$error" data-ng-show="formPrices.publicPrice.$touched || formPrices.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group"> <ph-submit class="btn-primary" data-ng-click="submitPrices(formPrices, pricesFormModel)" data-form="formPrices" data-text="Speichern"></ph-submit> <button type="button" class="btn btn-default" data-ng-click="resetPrices(formPrices, pricesFormModel, pricesFormReset)"> Verwerfen </button> </div> </form> </div> </div> </div> </div>'),a.put("views/manage/edit-article-files.html",'<!-- The file upload form used as target for the file upload widget --> <form id="fileupload" action="" method="POST" enctype="multipart/form-data" data-ng-controller="MyFileUploadCtrl" data-file-upload="options" data-ng-class="{\'fileupload-processing\': processing() || loadingFiles}"> <!-- The fileupload-buttonbar contains buttons to add/delete files and start/cancel the upload --> <div class="row fileupload-buttonbar"> <div class="col-lg-7"> <!-- The fileinput-button span is used to style the file input field as button --> <span class="btn btn-success fileinput-button" ng-class="{disabled: disabled}"> <i class="glyphicon glyphicon-plus"></i> <span>Add files...</span> <input type="file" name="files[]" multiple ng-disabled="disabled"> </span> <button type="button" class="btn btn-primary start" data-ng-click="submit()"> <i class="glyphicon glyphicon-upload"></i> <span>Start upload</span> </button> <button type="button" class="btn btn-warning cancel" data-ng-click="cancel()"> <i class="glyphicon glyphicon-ban-circle"></i> <span>Cancel upload</span> </button> <!-- The global file processing state --> <span class="fileupload-process"></span> </div> <!-- The global progress state --> <div class="col-lg-5 fade" data-ng-class="{in: active()}"> <!-- The global progress bar --> <div class="progress progress-striped active" data-file-upload-progress="progress()"><div class="progress-bar progress-bar-success" data-ng-style="{width: num + \'%\'}"></div></div> <!-- The extended global progress state --> <div class="progress-extended">&nbsp;</div> </div> </div> <!-- The table listing the files available for upload/download --> <table class="table table-striped files ng-cloak"> <tr data-ng-repeat="file in queue" data-ng-class="{\'processing\': file.$processing()}"> <td style="width:50px" data-ng-show="hasPreview"> <ph-checkbox data-spin="file.isPreviewSubmitting"> <input type="checkbox" data-ng-model="file.isPreview" data-ng-change="toggleIsPreview(file)" data-ng-disabled="isPreviewSubmitting || file.isPreview || file.$state() == \'pending\' || file.$state() == \'rejected\' || file.$state() == \'resolved\'"> <label></label> </ph-checkbox> </td> <td data-ng-switch data-on="!!file.thumbnailUrl"> <div class="preview" data-ng-switch-when="true"> <a data-ng-href="{{file.url}}" title="{{file.name}}" download="{{file.name}}" data-gallery><img data-ng-src="{{file.thumbnailUrl}}" alt=""></a> </div> <div class="preview" data-ng-switch-default data-file-upload-preview="file"></div> </td> <td> <p class="name" data-ng-switch data-on="!!file.url"> <span data-ng-switch-when="true" data-ng-switch data-on="!!file.thumbnailUrl"> <a data-ng-switch-when="true" data-ng-href="{{file.url}}" title="{{file.name}}" download="{{file.name}}" data-gallery>{{file.name}}</a> <a data-ng-switch-default data-ng-href="{{file.url}}" title="{{file.name}}" download="{{file.name}}">{{file.name}}</a> </span> <span data-ng-switch-default>{{file.name}}</span> </p> <strong data-ng-show="file.error" class="error text-danger">{{file.error}}</strong> </td> <td> <p class="size">{{file.size | formatFileSize}}</p> <div class="progress progress-striped active fade" data-ng-class="{pending: \'in\'}[file.$state()]" data-file-upload-progress="file.$progress()"><div class="progress-bar progress-bar-success" data-ng-style="{width: num + \'%\'}"></div></div> </td> <td> <button type="button" class="btn btn-primary start" data-ng-click="file.$submit()" data-ng-hide="!file.$submit || options.autoUpload" data-ng-disabled="file.$state() == \'pending\' || file.$state() == \'rejected\'"> <i class="glyphicon glyphicon-upload"></i> <span>Start</span> </button> <button type="button" class="btn btn-warning cancel" data-ng-click="file.$cancel()" data-ng-hide="!file.$cancel"> <i class="glyphicon glyphicon-ban-circle"></i> <span>Cancel</span> </button> <button data-ng-controller="FileDestroyController" type="button" class="btn btn-danger destroy" data-ng-click="file.$destroy()" data-ng-hide="!file.$destroy"> <i class="glyphicon glyphicon-trash"></i> <span>Delete</span> </button> </td> </tr> </table> </form>'),a.put("views/manage/edit-article-specification.html",'<div class="row"> <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <form name="form"> <div class="form-group"> <textarea class="form-control" data-ui-tinymce rows="20" data-ng-model="data.specification" autofocus></textarea> </div> <div class="form-group"> <ph-submit class="btn-primary" data-ng-click="submit()" data-form="form" data-text="Speichern"></ph-submit> <a class="btn btn-default" href="" data-ng-click="cancel()">Abbrechen</a> </div> </form> </div> </div>'),a.put("views/manage/edit-article-stock.html",'<div class="row"> <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6"> <div class="panel panel-default"> <div class="panel-heading">Verfügbarkeit</div> <div class="panel-body"> <table class="table"> <thead> <tr> <th>Ab</th> <th>Anzahl</th> </tr> </thead> <tbody> <tr data-ng-repeat="row in stock.availabilities"> <td>{{row.fromUtc |date:\'dd.MM.yyyy\'}}</td> <td>{{row.amount}}</td> </tr> </tbody> </table> </div> </div> </div> <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6"> <div class="panel panel-default"> <div class="panel-heading">Reservationen</div> <div class="panel-body"> <table class="table"> <thead> <tr> <th>Von</th> <th>Bis</th> <th>Anzahl</th> </tr> </thead> <tbody> <tr data-ng-repeat="row in stock.reservations"> <td>{{row.fromUtc |date:\'dd.MM.yyyy\'}}</td> <td>{{row.toUtc |date:\'dd.MM.yyyy\'}}</td> <td>{{row.amount}}</td> </tr> </tbody> </table> </div> </div> </div> </div>'),a.put("views/messages.html",'<span class="help-block" data-ng-message="required">Dieses Feld erfordert eine Eingabe.</span> <span class="help-block" data-ng-message="minlength">Die Eingabe ist zu kurz.</span> <span class="help-block" data-ng-message="maxlength">Die Eingabe ist zu lang.</span> <span class="help-block" data-ng-message="min">Die Eingabe ist zu klein.</span> <span class="help-block" data-ng-message="max">Die Eingabe ist zu gross</span> <span class="help-block" data-ng-message="number">Die Eingabe ist keine gültige Zahl.</span> <span class="help-block" data-ng-message="integer">Die Eingabe ist keine gültige Zahl.</span> <span class="help-block" data-ng-message="email">Die E-Mail-Adresse ist ungültig.</span>'),a.put("views/modals/add-order-item.html",'<div class="modal-header"> <button type="button" class="close" data-ng-click="cancel()" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4>Artikel hinzufügen</h4> </div> <div class="modal-body"> <form class="form-horizontal" name="addItemForm" novalidate> <div class="form-group"> <label class="col-sm-3 control-label" for="inputArticle">Artikel</label> <div class="col-sm-9" data-ng-class="{\'has-error\':!addItemForm.inputArticleId.$valid && addItemForm.inputArticleId.$touched}"> <input type="text" data-ng-model="selected" class="form-control" id="inputArticleId" name="inputArticleId" data-uib-typeahead="article as article.name for article in getArticles($viewValue)" data-typeahead-loading="loadingLocations" data-typeahead-no-results="noResults" id="inputArticle" required> <!--<span class="help-block">Benutzer-Id oder E-Mail-Adresse</span>--> <span class="help-block" data-ng-show="addItemForm.inputArticleId.$error.required && addItemForm.inputArticleId.$touched">Erforderlich!</span> <span class="help-block"> <span data-ng-hide="loadingLocations || noResults">&nbsp;</span> <span data-ng-show="loadingLocations"><span class="glyphicon glyphicon-refresh"></span> Bitte warten...</span> <span data-ng-show="noResults"><span class="glyphicon glyphicon-remove"></span> Kein Material gefunden</span> </span> <!--<pre>Model: {{selected | json}}</pre>--> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label" for="fromUtc">Von</label> <div class="col-sm-9" data-ng-class="{\'has-error\':!addItemForm.fromUtc.$valid && addItemForm.fromUtc.$touched}"> <p class="input-group"> <input type="text" class="form-control" id="fromUtc" name="fromUtc" data-uib-datepicker-popup="mediumDate" data-ng-model="fromUtc" data-is-open="fromUtcIsOpen" required> <span class="input-group-btn"> <button type="button" class="btn btn-default" data-ng-click="fromUtcIsOpen = true"><i class="glyphicon glyphicon-calendar"></i></button> </span> </p> <span class="help-block" data-ng-show="addItemForm.fromUtc.$error.required && addItemForm.fromUtc.$touched">Erforderlich!</span> <span class="help-block" data-ng-show="addItemForm.fromUtc.$error.date && addItemForm.fromUtc.$touched">Ungültiges Datum!</span> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label" for="toUtc">Bis</label> <div class="col-sm-9" data-ng-class="{\'has-error\':!addItemForm.toUtc.$valid && addItemForm.toUtc.$touched}"> <p class="input-group"> <input type="text" class="form-control" id="toUtc" name="toUtc" data-uib-datepicker-popup="mediumDate" data-ng-model="toUtc" data-is-open="toUtcIsOpen" required> <span class="input-group-btn"> <button type="button" class="btn btn-default" data-ng-click="toUtcIsOpen = true"><i class="glyphicon glyphicon-calendar"></i></button> </span> </p> <span class="help-block" data-ng-show="addItemForm.toUtc.$error.required && addItemForm.toUtc.$touched">Erforderlich!</span> <span class="help-block" data-ng-show="addItemForm.toUtc.$error.date && addItemForm.toUtc.$touched">Ungültiges Datum!</span> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label" for="amount">Menge</label> <div class="col-sm-9" data-ng-class="{\'has-error\':!addItemForm.amount.$valid && addItemForm.amount.$touched}"> <input type="number" class="form-control" id="amount" name="amount" data-ng-model="amount" required min="0"> <span class="help-block" data-ng-show="addItemForm.amount.$error.required && addItemForm.amount.$touched">Erforderlich!</span> <span class="help-block" data-ng-show="addItemForm.amount.$error.number">Keine gültige Zahl!</span> <span class="help-block" data-ng-show="addItemForm.amount.$error.min || addItemForm.amount.$error.max">Die Menge muss grösser als 0 sein!</span> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" data-ng-click="ok()" data-ng-disabled="addItemForm.$invalid">Hinzufügen</button> <button class="btn btn-default" type="button" data-ng-click="cancel()">Abbrechen</button> </div>'),a.put("views/modals/create-article.html",'<div class="modal-header"> <button type="button" class="close" data-ng-click="cancel()" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4>Neues Material</h4> </div> <div class="modal-body"> <form class="form-horizontal" name="form" novalidate> <div class="form-group"> <label class="control-label col-sm-3" for="name">Name</label> <div class="col-sm-9" data-ng-class="{\'has-error\':!form.name.$valid && form.name.$touched}"> <input class="form-control" type="text" data-ng-model="name" id="name" name="name" required autofocus> </div> </div> <div class="form-group"> <label class="control-label col-sm-3" for="name">Bestand</label> <div class="col-sm-9" data-ng-class="{\'has-error\':!form.amount.$valid && form.amount.$touched}"> <input class="form-control" type="number" data-ng-model="amount" id="amount" name="amount" min="0" required> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" data-ng-click="ok()" data-ng-disabled="form.$invalid">Erstellen</button> <button class="btn btn-default" type="button" data-ng-click="cancel()">Abbrechen</button> </div>'),a.put("views/modals/create-order.html",'<div class="modal-header"> <button type="button" class="close" data-ng-click="cancel()" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4>Neue Bestellung</h4> </div> <div class="modal-body"> <form class="form-horizontal" name="form" novalidate> <div class="form-group"> <label class="control-label col-sm-3" for="lessee">Mieter</label> <div class="col-sm-9"> <input type="text" data-ng-model="selected" placeholder="" data-uib-typeahead="member as (member.firstName + \' \' + member.lastName) for member in getMembers($viewValue)" data-typeahead-loading="loadingLocations" data-typeahead-no-results="noResults" class="form-control" id="lessee" required> <!--<span class="help-block">Benutzer-Id oder E-Mail-Adresse</span>--> <span class="help-block"> <span data-ng-hide="loadingLocations || noResults">&nbsp;</span> <span data-ng-show="loadingLocations"><span class="glyphicon glyphicon-refresh"></span> Bitte warten...</span> <span data-ng-show="noResults"><span class="glyphicon glyphicon-remove"></span> Kein Mitglied gefunden</span> </span> <!--<pre>Model: {{selected | json}}</pre>--> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" data-ng-click="ok()" data-ng-disabled="form.$invalid">Erstellen</button> <button class="btn btn-default" type="button" data-ng-click="cancel()">Abbrechen</button> </div>'),a.put("views/organizations.html",'<div class="row"> <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <h2>Organisationen</h2> <table class="table table-hover" data-st-table="displayedOrganizations" data-st-safe-src="organizations"> <thead> <tr> <th colspan="2"> <input data-st-search class="form-control" type="search" placeholder="Suchen..."> </th> </tr> <tr> <th data-st-sort-default="true" data-st-sort="name">Name</th> <th data-st-sort="address">Kontakt</th> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedOrganizations"> <td data-ng-show="row.url"><a href="/{{row.url}}">{{row.name}}</a></td> <td data-ng-hide="row.url"><a href="" data-ui-sref="public.organization({organizationId: row.organizationId})">{{row.name}}</a></td> <td>{{row.address|replace:\' *[\\r\\n]+ *\':\', \'}}</td> </tr> </tbody> </table> </div> <div class="col-xs-12 col-sm-12 col-md-12 col-lg-5"> <!--<div class="jumbotron">\n      <h2>Du möchtest deine eigene Organisation haben?</h2>\n      <p>Kontaktiere das phundus-Team über die Feedback-Funktion und wir kümmern uns drum!</p>\n      <p><a class="btn btn-primary btn-lg" href="/feedback" role="button">Zum Formular</a></p>\n    </div>--> </div> </div>'),a.put("views/organizations/applications.html",'<table class="table table-hover" data-st-table="displayedCollection" data-st-safe-src="rowCollection"> <thead> <tr> <th colspan="7"> <input data-st-search class="form-control" type="search" placeholder="Suchen..."> </th> </tr> <tr> </tr><tr> <th data-st-sort="requestedAtUtc">Datum</th> <th data-st-sort="firstName">Vorname</th> <th data-st-sort="lastName">Nachname</th> <th data-st-sort="emailAddress">E-Mail-Adresse</th> <th data-st-sort="customMemberNumber">Nummer</th> <th></th> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedCollection"> <td><ph-date value="row.requestedAtUtc"></ph-date></td> <td>{{row.firstName}}</td> <td>{{row.lastName}}</td> <td>{{row.emailAddress}}</td> <td>{{row.customMemberNumber}}</td> <td class="text-right"> <button type="button" class="btn btn-success btn-sm" data-ng-disabled="row.isApproving || row.isRejecting" data-mwl-confirm data-on-confirm="approve(row)" data-title="Bestätigung" data-message="Möchtest du <strong>{{row.firstName}} {{row.lastName}}</strong> wirklich bestätigen?" data-confirm-text="Ja" data-cancel-text="Nein"><span class="glyphicon glyphicon-refresh glyphicon-spin" data-ng-show="row.isApproving"></span> Bestätigen</button> <button type="button" class="btn btn-default btn-sm" data-ng-disabled="row.isApproving || row.isRejecting" data-mwl-confirm data-on-confirm="reject(row)" data-title="Bestätigung" data-message="Möchtest du <strong>{{row.firstName}} {{row.lastName}}</strong> wirklich ablehnen?" data-confirm-text="Ja" data-cancel-text="Nein"><span class="glyphicon glyphicon-refresh glyphicon-spin" data-ng-show="row.isRejecting"></span> Ablehnen</button> </td> </tr> </tbody> </table> <div class="alert alert-info" data-ng-show="rowCollection.length == 0"> <strong>Nichts gefunden!</strong> Es sind keine Beitrittsanfragen vorhanden. </div> <div class="alert alert-info" data-ng-show="displayedCollection.length == 0 && rowCollection.length > 0"> <strong>Nichts gefunden!</strong> Deine Suche liefert keine Ergebnisse. </div>'),a.put("views/organizations/articles.html",'<table class="table table-hover" data-st-table="displayedArticles" data-st-safe-src="articles"> <thead> <tr> <th colspan="5"> <input data-st-search class="form-control" type="search" placeholder="Suchen..."> </th> </tr> <tr> <th data-st-sort="articleShortId">Id</th> <th data-st-sort-default="true" data-st-sort="name">Name</th> <th class="text-right" data-st-sort="grossStock">Bestand</th> <th class="text-right" data-st-sort="pricePublic">Preis</th> <th class="text-right" data-st-sort="priceMember">Mitglieder</th> <th class="text-right"> <a class="btn btn-primary" href="" data-ng-click="createArticle()">Neues Material</a> </th> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedArticles"> <td>{{row.articleShortId}}</td> <td>{{row.name}}</td> <td class="text-right">{{row.grossStock}}</td> <td class="text-right">{{row.publicPrice | number:2}}</td> <td class="text-right">{{row.memberPrice | number:2}}</td> <td class="text-right"> <a class="btn btn-default btn-sm" href="" data-ui-sref="organizations.articles.edit.details({organizationId: organizationId, articleId: row.articleId, articleShortId: row.articleShortId})">Bearbeiten</a> <a class="btn btn-danger btn-sm" href="" data-ng-click="delete(row.articleShortId, row.name)">Löschen</a> </td> </tr> </tbody> </table> <div class="alert alert-info" data-ng-show="articles.length == 0"> <strong>Nichts gefunden!</strong> Es sind keine Artikel vorhanden. </div> <div class="alert alert-info" data-ng-show="displayedArticles.length == 0 && articles.length > 0"> <strong>Nichts gefunden!</strong> Deine Suche liefert keine Ergebnisse. </div>'),a.put("views/organizations/edit-contact-details.html",'<form class="form-horizontal" name="form"> <!--\n          <div class="form-group">\n            <label class="col-sm-2 control-label" for="name">Name</label>\n            <div class="col-sm-10">\n              <input type="text" class="form-control" id="name" placeholder="Name" ng-model="settings.name" />\n            </div>\n          </div>\n\n          <div class="form-group">\n            <label class="col-sm-2 control-label" for="url">URL</label>\n            <div class="col-sm-10">\n              <input type="text" class="form-control" id="url" placeholder="Name" ng-model="settings.url" readonly="readonly" />\n              <span class="help-block">Die Startseite der Organisation kann direkt mit <strong>https://www.phundus.ch/{{settings.url}}</strong> verlinkt werden.</span>\n            </div>\n          </div>\n  --> <div class="form-group"> <label class="col-sm-3 control-label" for="postAddress">Anschrift / Adresse</label> <div class="col-sm-9" data-has-error="form.postAddress"> <textarea class="form-control" id="postAddress" name="postAddress" data-ng-model="contactDetails.postAddress" rows="4"></textarea> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label" for="phoneNumber">Telefonnummer</label> <div class="col-sm-9" data-has-error="form.phoneNumber"> <input type="text" class="form-control" id="phoneNumber" name="phoneNumber" data-ng-model="contactDetails.phoneNumber"> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label" for="emailAddress">E-Mail-Adresse</label> <div class="col-sm-9" data-has-error="form.emailAddress"> <input type="email" class="form-control" id="emailAddress" name="emailAddress" data-ng-model="contactDetails.emailAddress"> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label" for="website">Webseite</label> <div class="col-sm-9" data-has-error="form.website"> <input type="url" class="form-control" id="website" name="website" placeholder="https://www.domain.ch/" data-ng-model="contactDetails.website"> <span class="help-block">Die Webseite deiner Organisation, z.B. https://www.phundus.ch/.</span> </div> </div> <!--\n\n          <div class="form-group">\n            <label class="col-sm-2 control-label" for="documentTemplate">Dokumentvorlage</label>\n            <div class="col-sm-10">\n              <select class="form-control" id="documentTemplate" ng-model="settings.documentTemplate" ng-options="value.name as value.name for value in files">\n                <option value="">-- Weisse Seite --</option>\n              </select>\n            </div>\n          </div>\n  --> <div class="form-group"> <div class="col-sm-offset-3 col-sm-9"> <ph-submit class="btn-primary" data-ng-click="submit()" data-form="form" data-text="Speichern"></ph-submit> <button type="button" class="btn btn-default" data-ng-click="cancel()">Abbrechen</button> </div> </div> </form>'),a.put("views/organizations/edit-startpage.html",'<div class="row"> <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <form name="form"> <div class="form-group"> <textarea class="form-control" data-ui-tinymce rows="20" data-ng-model="data.startpage" autofocus></textarea> </div> <div class="form-group"> <ph-submit class="btn-primary" data-ng-click="submit()" data-form="form" data-text="Speichern"></ph-submit> <button type="button" class="btn btn-default" data-ng-click="cancel()">Abbrechen</button> </div> </form> </div> </div>'),a.put("views/organizations/files.html",'<div class="page-header"> <h1>Dateien</h1> </div> <!-- The file upload form used as target for the file upload widget --> <form id="fileupload" action="" method="POST" enctype="multipart/form-data" data-ng-controller="MyFileUploadCtrl" data-file-upload="options" data-ng-class="{\'fileupload-processing\': processing() || loadingFiles}"> <!-- The fileupload-buttonbar contains buttons to add/delete files and start/cancel the upload --> <div class="row fileupload-buttonbar"> <div class="col-lg-7"> <!-- The fileinput-button span is used to style the file input field as button --> <span class="btn btn-success fileinput-button" ng-class="{disabled: disabled}"> <i class="glyphicon glyphicon-plus"></i> <span>Add files...</span> <input type="file" name="files[]" multiple ng-disabled="disabled"> </span> <button type="button" class="btn btn-primary start" data-ng-click="submit()"> <i class="glyphicon glyphicon-upload"></i> <span>Start upload</span> </button> <button type="button" class="btn btn-warning cancel" data-ng-click="cancel()"> <i class="glyphicon glyphicon-ban-circle"></i> <span>Cancel upload</span> </button> <!-- The global file processing state --> <span class="fileupload-process"></span> </div> <!-- The global progress state --> <div class="col-lg-5 fade" data-ng-class="{in: active()}"> <!-- The global progress bar --> <div class="progress progress-striped active" data-file-upload-progress="progress()"><div class="progress-bar progress-bar-success" data-ng-style="{width: num + \'%\'}"></div></div> <!-- The extended global progress state --> <div class="progress-extended">&nbsp;</div> </div> </div> <!-- The table listing the files available for upload/download --> <table class="table table-striped files ng-cloak"> <tr data-ng-repeat="file in queue" data-ng-class="{\'processing\': file.$processing()}"> <td data-ng-switch data-on="!!file.thumbnailUrl"> <div class="preview" data-ng-switch-when="true"> <a data-ng-href="{{file.url}}" title="{{file.name}}" download="{{file.name}}" data-gallery><img data-ng-src="{{file.thumbnailUrl}}" alt=""></a> </div> <div class="preview" data-ng-switch-default data-file-upload-preview="file"></div> </td> <td> <p class="name" data-ng-switch data-on="!!file.url"> <span data-ng-switch-when="true" data-ng-switch data-on="!!file.thumbnailUrl"> <a data-ng-switch-when="true" data-ng-href="{{file.url}}" title="{{file.name}}" download="{{file.name}}" data-gallery>{{file.name}}</a> <a data-ng-switch-default data-ng-href="{{file.url}}" title="{{file.name}}" download="{{file.name}}">{{file.name}}</a> </span> <span data-ng-switch-default>{{file.name}}</span> </p> <strong data-ng-show="file.error" class="error text-danger">{{file.error}}</strong> </td> <td> <p class="size">{{file.size | formatFileSize}}</p> <div class="progress progress-striped active fade" data-ng-class="{pending: \'in\'}[file.$state()]" data-file-upload-progress="file.$progress()"><div class="progress-bar progress-bar-success" data-ng-style="{width: num + \'%\'}"></div></div> </td> <td> <button type="button" class="btn btn-primary start" data-ng-click="file.$submit()" data-ng-hide="!file.$submit || options.autoUpload" data-ng-disabled="file.$state() == \'pending\' || file.$state() == \'rejected\'"> <i class="glyphicon glyphicon-upload"></i> <span>Start</span> </button> <button type="button" class="btn btn-warning cancel" data-ng-click="file.$cancel()" data-ng-hide="!file.$cancel"> <i class="glyphicon glyphicon-ban-circle"></i> <span>Cancel</span> </button> <button data-ng-controller="FileDestroyController" type="button" class="btn btn-danger destroy" data-ng-click="file.$destroy()" data-ng-hide="!file.$destroy"> <i class="glyphicon glyphicon-trash"></i> <span>Delete</span> </button> </td> </tr> </table> </form>'),
a.put("views/organizations/home.html",'<ph-organization-navbar data-ng-show="organization" data-organization-id="organizationId"></ph-organization-navbar> <div class="row"> <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6"> <h2>{{organization.name}} <a class="btn btn-default btn-sm" href="" data-access-level="accessLevels.manager" data-organization-id="organizationId" data-ui-sref="organizations.startpage({organizationId: organizationId})"><span class="glyphicon glyphicon-pencil"></span></a></h2> <div data-ng-bind-html="startpage"></div> </div> <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6"> <h3>Mitgliedschaft</h3> <div data-ng-show="relationship" data-ng-switch="relationship.status"> <div data-ng-switch-when="member"> <p>Du bist Mitglied seit dem {{relationship.timestamp | date: \'mediumDate\'}}.</p> </div> <div data-ng-switch-when="application"> <p>Du hast die Mitgliedschaft am {{relationship.timestamp | date: \'mediumDate\'}} beantragt.</p> </div> <div data-ng-switch-when="rejected"> <p>Dein Antrag zur Mitgliedschaft wurde am {{relationship.timestamp | date: \'mediumDate\'}} abgelehnt.</p> <p>Du kannst die Mitgliedschaft erneut <button type="button" class="btn btn-default btn-sm" data-ng-disabled="isJoining" data-mwl-confirm data-on-confirm="join()" data-title="Bestätigung" data-message="Möchtest du der Organisation {{organization.name}} wirklich beitreten?" data-confirm-text="Ja" data-cancel-text="Nein"><span class="glyphicon glyphicon-refresh glyphicon-spin" data-ng-show="isJoining"></span> beantragen </button> . </p> </div> <div data-ng-switch-default> <p>Du kannst dieser Organisation <button type="button" class="btn btn-default btn-sm" data-ng-disabled="isJoining" data-mwl-confirm data-on-confirm="join()" data-title="Bestätigung" data-message="Möchtest du der Organisation {{organization.name}} wirklich beitreten?" data-confirm-text="Ja" data-cancel-text="Nein"><span class="glyphicon glyphicon-refresh glyphicon-spin" data-ng-show="isJoining"></span> beitreten </button> . </p> </div> </div> <div data-ng-show="hasContactOptions()"> <h3>Kontakt <a class="btn btn-default btn-sm" href="" data-access-level="accessLevels.manager" data-organization-id="organizationId" data-ui-sref="organizations.contact-details({organizationId: organizationId})"><span class="glyphicon glyphicon-pencil"></span></a></h3> <address data-ng-show="organization.address" style="white-space:pre">{{organization.address}}</address> <address> <div data-access-level="accessLevels.user" data-ng-show="organization.emailAddress"> E-Mail: {{organization.emailAddress|replace:\'@.*$\':\'\'}} AT <span style="display:none">null.</span><span>{{organization.emailAddress|replace:\'^.*@\':\'\'}}</span> </div> <div data-ng-show="organization.website">Webseite: <a href="{{organization.website}}">{{organization.website}}</a></div> </address> </div> <div data-ng-show="organization.stores[0]"> <h3>Materialstelle</h3> <address data-ng-show="organization.stores[0].address" style="white-space:pre">{{organization.stores[0].address}} </address> <div data-ng-show="organization.stores[0].openingHours" style="white-space:pre">{{organization.stores[0].openingHours}} </div> <div data-ng-show="organization.stores[0].coordinate"> <leaflet width="100%" height="400px" style="margin-bottom:10px"></leaflet> </div> <p></p> </div> </div> </div>'),a.put("views/organizations/members.html",'<table class="table table-hover" data-st-table="displayedCollection" data-st-safe-src="rowCollection"> <thead> <tr> <th colspan="7"> <input data-st-search class="form-control" type="search" placeholder="Suchen..."> </th> </tr> <tr> <th data-st-sort="memberId">Id</th> <th data-st-sort="firstName">Vorname</th> <th data-st-sort="lastName">Nachname</th> <th data-st-sort="emailAddress">E-Mail-Adresse</th> <th data-st-sort="jsNumber">J+S-Nummer</th> <th data-st-sort="role">Verwaltung</th> <th data-st-sort="isLocked">Gesperrt</th> <!--<th></th>--> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedCollection"> <td><ph-guid value="row.memberId"></ph-guid></td> <td>{{row.firstName}}</td> <td>{{row.lastName}}</td> <td>{{row.emailAddress}}</td> <td>{{row.jsNumber}}</td> <td> <ph-checkbox class="checkbox-danger" data-spin="row.isManagerSubmitting"> <input type="checkbox" data-ng-model="row.isManager" data-ng-change="toggleIsManager(row)"> <label></label> </ph-checkbox> </td> <td> <ph-checkbox class="checkbox-warning" data-spin="row.isLockedSubmitting"> <input type="checkbox" data-ng-model="row.isLocked" data-ng-change="toggleIsLocked(row)"> <label></label> </ph-checkbox> </td> </tr> </tbody> </table> <div class="alert alert-info" data-ng-show="rowCollection.length == 0"> <strong>Nichts gefunden!</strong> Es sind keine Mitglieder vorhanden. </div> <div class="alert alert-info" data-ng-show="displayedCollection.length == 0 && rowCollection.length > 0"> <strong>Nichts gefunden!</strong> Deine Suche liefert keine Ergebnisse. </div>'),a.put("views/organizations/order.html",'<h2>Bestellung {{order.orderId}}</h2> <div data-ng-show="order" class="row"> <div class="col-lg-4"> <p>Status: {{order.status | orderStatusText}}</p> <p>Vermieter: {{order.lessorName}}</p> <p>Erstellt: {{order.createdAtUtc | date:\'medium\'}}</p> <p>Bearbeitet: {{order.modifiedAtUtc | date:\'medium\'}}</p> </div> <div class="col-lg-4"> <p>{{order.lessee.name}}</p> <p>{{order.lessee.street}}</p> <p>{{order.lessee.postcode}} {{order.lessee.city}}</p> <p>{{order.lessee.memberNumber}}</p> </div> </div> <form name="orderForm" novalidate> <table data-ng-show="order" class="table table-bordered table-striped"> <thead> <tr> <th>#</th> <th>Artikel</th> <th>Verfügbar</th> <th>Von</th> <th>Bis</th> <th>Menge</th> <th>Stückpreis</th> <th>Total</th> <th data-ng-show="canEdit()"></th> </tr> </thead> <tbody> <tr data-ng-repeat="item in order.items"> <td>{{$index+1}}</td> <td>{{item.text}}</td> <td data-ng-show="item.isAvailable"><span class="glyphicon glyphicon-ok"></span></td> <td data-ng-show="!item.isAvailable"><span class="glyphicon glyphicon-remove"></span></td> <td data-ng-show="!item.editing">{{item.fromUtc | date:\'mediumDate\'}}</td> <td data-ng-show="!item.editing">{{item.toUtc | date:\'mediumDate\'}}</td> <td data-ng-show="!item.editing">{{item.amount}}</td> <td data-ng-show="item.editing" class="col-sm-2" data-ng-class="{\'has-error\':!orderForm.item_{{$index}}_fromUtc.$valid && orderForm.item_{{$index}}_fromUtc.$touched}"> <p class="input-group"> <input class="form-control" type="text" required data-ng-model="item.fromUtc" name="item_{{$index}}_fromUtc" data-uib-datepicker-popup="mediumDate" data-is-open="fromUtcIsOpen"> <span class="input-group-btn"> <button type="button" class="btn btn-default" data-ng-click="fromUtcIsOpen = true"> <i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </td> <td data-ng-show="item.editing" class="col-sm-2" data-ng-class="{\'has-error\':!orderForm.item_{{$index}}_toUtc.$valid && orderForm.item_{{$index}}_toUtc.$touched}"> <p class="input-group"> <input class="form-control" type="text" required data-ng-model="item.toUtc" name="item_{{$index}}_toUtc" data-uib-datepicker-popup="mediumDate" data-is-open="toUtcIsOpen"> <span class="input-group-btn"> <button type="button" class="btn btn-default" data-ng-click="toUtcIsOpen = true"> <i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </td> <td data-ng-show="item.editing" class="col-sm-1" data-ng-class="{\'has-error\':!orderForm.item_{{$index}}_amount.$valid && orderForm.item_{{$index}}_amount.$touched}"> <input class="form-control" type="number" required data-ng-model="item.amount" name="item_{{$index}}_amount"> </td> <td>{{item.unitPrice | number:2}}</td> <td data-ng-show="!item.editing">{{item.itemTotal | number:2}}</td> <td data-ng-show="item.editing" class="col-sm-2" data-ng-class="{\'has-error\':!orderForm.item_{{$index}}_itemTotal.$valid && orderForm.item_{{$index}}_itemTotal.$touched}"> <p class="input-group"> <input class="form-control" type="text" required data-ng-model="item.itemTotal" name="item_{{$index}}_itemTotal"> <span class="input-group-btn"> <button class="btn btn-default" data-ng-click="calculateItemTotal(item)" title="Preis berechnen"> <i class="glyphicon glyphicon-refresh"></i></button> </span> </p> </td> <td data-ng-show="canEdit() && !item.editing"> <a data-ng-show="canEdit()" class="btn btn-default" href="" data-ng-click="editItem(item)" title="Bearbeiten"><span class="glyphicon glyphicon-edit"></span></a> <a data-ng-show="canEdit()" class="btn btn-default" href="" data-ng-click="removeItem(item)" title="Entfernen"><span class="glyphicon glyphicon-remove"></span></a> </td> <td data-ng-show="item.editing"> <a class="btn btn-default" href="" data-ng-click="saveEditedItem(item)" title="Speichern"><span class="glyphicon glyphicon-ok"></span></a> <a class="btn btn-default" href="" data-ng-click="cancelEditing(item)" title="Verwerfen"><span class="glyphicon glyphicon-asterisk"></span></a> </td> </tr> <tr style="font-weight:bold"> <td colspan="7" style="text-align:right">Total</td> <td>{{getTotal() | number:2}}</td> <td data-ng-show="canEdit()"></td> </tr> </tbody> </table> </form> <div class="row"> <div class="col-sm-6"> <a class="btn btn-default" href="" ph-history-back>Zurück</a> <a data-ng-show="order" class="btn btn-default" href="/api/orders/{{order.orderId}}.pdf">PDF</a> </div> <div ng-show="order" class="col-sm-6" style="text-align:right"> <a class="btn btn-default" data-ng-show="canEdit()" href="" data-ng-click="showAddItem(order)">Artikel hinzufügen</a> <a class="btn btn-primary" data-ng-show="canConfirm()" href="" data-ng-click="confirmOrder(order)">Bestätigen</a> <a class="btn btn-danger" data-ng-show="canReject()" href="" data-ng-click="rejectOrder(order)">Ablehnen</a> <a class="btn btn-primary" data-ng-show="canClose()" href="" data-ng-click="closeOrder(order)">Abschliessen</a> </div> </div>'),a.put("views/organizations/orders.html",'<table class="table table-hover" data-st-table="displayedCollection" data-st-safe-src="rowCollection"> <thead> <tr> <th colspan="5"> <div class="col-md-3"> <select data-st-search="status" class="form-control"> <option value="">Alle</option> <option data-ng-repeat="row in rowCollection | unique:\'status\'" value="{{row.status}}">{{row.status | orderStatusText}} </option> </select> </div> <div class="col-md-9"> <input data-st-search class="form-control" type="search" placeholder="Suchen..."> </div> </th> </tr> <tr> <th data-st-sort-default="true" data-st-sort="orderId">Nummer</th> <th data-st-sort="createdAtUtc">Erstellt</th> <th data-st-sort="lesseeName">Mieter</th> <th data-st-sort="status">Status</th> <th class="text-right"> <a class="btn btn-primary" href="" data-ng-click="createOrder()">Neue Bestellung</a> </th> </tr> </thead> <tbody> <tr data-ng-repeat="order in displayedCollection"> <td>{{order.orderId}}</td> <td> <ph-date value="order.createdAtUtc"></ph-date> </td> <td>{{order.lessee.name}}</td> <td>{{order.status | orderStatusText}}</td> <td class="text-right"> <a class="btn btn-default btn-sm" href="" data-ui-sref="manage.organization.order({organizationId: organizationId, orderId: order.orderId})">Öffnen</a> <a class="btn btn-default btn-sm" href="/api/v0/orders/{{order.orderId}}.pdf">PDF</a> </td> </tr> </tbody> </table> <div class="alert alert-info" data-ng-show="rowCollection.length == 0"> <strong>Nichts gefunden!</strong> Es sind keine Bestellungen vorhanden. </div> <div class="alert alert-info" data-ng-show="displayedCollection.length == 0 && rowCollection.length > 0"> <strong>Nichts gefunden!</strong> Deine Suche liefert keine Ergebnisse. </div>'),a.put("views/organizations/settings.html",'<div class="page-header"> <h1>Einstellungen</h1> </div> <form class="form-horizontal" name="publicForm" novalidate> <div class="form-group"> <label class="col-sm-3 control-label" for="publicRental">Öffentlicher Verleih</label> <div class="col-sm-9" data-has-error="publicForm.publicRental"> <div class="checkbox"> <input class="styled" id="publicRental" name="publicRental" type="checkbox" data-ng-model="publicFormModel.publicRental"> <label for="publicRental"> Das Material der Organisation öffentlich zugänglich machen. Dadurch können Benutzer, die nicht Mitglied der Organisation sind, das Material in den Warenkorb legen und eine Bestellung an deine Organisation auslösen. </label> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-3 col-sm-9"> <ph-submit class="btn-primary" data-ng-click="submit(publicForm, publicFormModel)" data-form="publicForm" data-text="Speichern"></ph-submit> <button type="button" class="btn btn-default" data-ng-click="reset(publicFormModel, publicFormReset)">Verwerfen</button> </div> </div> </form>'),a.put("views/public/feedback.html",'<div class="row" data-ng-show="submitted"> <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3"> <div class="page-header"> <h1>Feedback</h1> </div> <p>Merci!</p> </div> </div> <div class="row" data-ng-hide="submitted"> <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3"> <div class="page-header"> <h1>Feedback</h1> </div> <form name="form" novalidate> <div class="form-group" data-has-error="form.emailAddress"> <label class="control-label" for="emailAddress">E-Mail-Adresse</label> <input type="email" class="form-control input-lg" id="emailAddress" name="emailAddress" data-ng-model="feedback.emailAddress" required> <div role="alert" data-ng-messages="form.emailAddress.$error" data-ng-show="form.emailAddress.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group" data-has-error="form.comment"> <label class="control-label" for="comment">Feedback</label> <textarea class="form-control input-lg" id="comment" name="comment" data-ng-model="feedback.comment" rows="10" required></textarea> <div role="alert" data-ng-messages="form.comment.$error" data-ng-show="form.comment.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group"> <ph-submit class="btn-primary btn-lg" data-ng-click="submit()" data-form="form" data-text="Senden"></ph-submit> </div> </form> </div> </div>'),a.put("views/public/validate-account.html",'<div class="row" data-ng-show="submitted"> <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3"> <div class="page-header"> <h1>Validierung</h1> </div> <p>Deine E-Mail-Adresse wurde erfolgreich bestätigt. Du kannst dich jetzt <a href="" data-ui-sref="anon.login">anmelden</a> und mit dieser E-Mail-Adresse und deinem Passwort den phundus durchstöbern und interessante Artikel gleich reservieren.</p> <p>Einige Organisation verleihen gewisses Material nur an ihre Mitglieder. Prüfe doch daher auch die verschiedenen Organisationen und beantrage eine Mitgliedschaft, wo du auch real dazugehörst.</p> <p>Wir wünschen dir viel Spass dabei!</p> </div> </div> <div class="row" data-ng-hide="submitted"> <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3"> <div class="page-header"> <h1>Validierung</h1> </div> <p>Hier wird die Richtigkeit deiner E-Mail-Adresse kontrolliert. Gibt dazu den Validierungs-Code ein, welcher an deine eingegebe E-Mail-Adresse versendet wurde.</p> <form name="form" novalidate> <div class="form-group" data-has-error="form.key"> <label class="control-label" for="key">Code</label> <input type="text" class="form-control input-lg" id="key" name="key" data-ng-model="validate.key" required> <div role="alert" data-ng-messages="form.key.$error" data-ng-show="form.key.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group"> <ph-submit class="btn-primary btn-lg" data-ng-click="submit()" data-form="form" data-text="Senden"></ph-submit> </div> </form> </div> </div>'),a.put("views/public/validate-email-address.html",'<div class="row" data-ng-show="submitted"> <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3"> <div class="page-header"> <h1>Validierung</h1> </div> <p>Deine E-Mail-Adresse wurde erfolgreich geändert.</p> <p>Du kannst dich nun <a href="" data-ui-sref="anon.login">anmelden</a>.</p> </div> </div> <div class="row" data-ng-hide="submitted"> <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3"> <div class="page-header"> <h1>Validierung</h1> </div> <p>Hier wird die Richtigkeit deiner E-Mail-Adresse kontrolliert. Gibt dazu den Validierungs-Code ein, welcher an deine eingegebe E-Mail-Adresse versendet wurde.</p> <form name="form" novalidate> <div class="form-group" data-has-error="form.key"> <label class="control-label" for="key">Code</label> <input type="text" class="form-control input-lg" id="key" name="key" data-ng-model="validate.key" required> <div role="alert" data-ng-messages="form.key.$error" data-ng-show="form.key.$touched || form.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group"> <ph-submit class="btn-primary btn-lg" data-ng-click="submit()" data-form="form" data-text="Senden"></ph-submit> </div> </form> </div> </div>'),a.put("views/shop/cart.html",'<div class="page-header"> <h1>Warenkorb</h1> </div> <form name="cartForm" novalidate> <table data-ng-show="cart.items.length > 0" class="table table-bordered table-striped"> <thead> <tr> <th>#</th> <th>Artikel</th> <th>Vermieter</th> <th class="text-center">Verfügbar</th> <th>Menge</th> <th>Von</th> <th>Bis</th> <th>Tage</th> <!--<th>Stückpreis/Woche</th>--> <th>Preis</th> <th></th> </tr> </thead> <tbody> <tr data-ng-repeat="item in cart.items"> <td>{{$index+1}}</td> <td>{{item.text}}</td> <td>{{item.ownerName}}</td> <td class="text-center"> <button type="button" class="btn btn-success" data-ng-show="item.isAvailable && !item.availabilityChecking" data-ng-click="checkAvailability(item)" title="Verfügbar!"><span class="glyphicon glyphicon-ok"></span></button> <button type="button" class="btn btn-danger" data-ng-show="!item.isAvailable && !item.availabilityChecking" data-ng-click="checkAvailability(item)" title="Nicht verfügbar!"> <span class="glyphicon glyphicon-remove"></span></button> <button type="button" class="btn btn-default" data-ng-show="item.availabilityChecking"><span class="glyphicon glyphicon-refresh glyphicon-spin" title="Verfügbarkeit wird geprüft..."></span></button> </td> <td data-ng-show="!item.editing">{{item.quantity}}</td> <td data-ng-show="item.editing" class="col-sm-1" data-ng-class="{\'has-error\':!cartForm.item_{{$index}}_quantity.$valid && cartForm.item_{{$index}}_quantity.$touched}"> <input class="form-control" type="number" required data-ng-model="item.quantity" name="item_{{$index}}_quantity"> </td> <td data-ng-show="!item.editing">{{item.fromUtc | date:\'mediumDate\'}}</td> <td data-ng-show="!item.editing">{{item.toUtc | date:\'mediumDate\'}}</td> <td data-ng-show="item.editing" class="col-sm-2" data-ng-class="{\'has-error\':!cartForm.item_{{$index}}_fromUtc.$valid && cartForm.item_{{$index}}_fromUtc.$touched}"> <p class="input-group"> <input class="form-control" type="text" required data-ng-model="item.fromUtc" name="item_{{$index}}_fromUtc" data-uib-datepicker-popup="mediumDate" data-is-open="fromUtcIsOpen"> <span class="input-group-btn"> <button type="button" class="btn btn-default" data-ng-click="fromUtcIsOpen = true"> <i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </td> <td data-ng-show="item.editing" class="col-sm-2" data-ng-class="{\'has-error\':!cartForm.item_{{$index}}_toUtc.$valid && cartForm.item_{{$index}}_toUtc.$touched}"> <p class="input-group"> <input class="form-control" type="text" required data-ng-model="item.toUtc" name="item_{{$index}}_toUtc" data-uib-datepicker-popup="mediumDate" data-is-open="toUtcIsOpen"> <span class="input-group-btn"> <button type="button" class="btn btn-default" data-ng-click="toUtcIsOpen = true"> <i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </td> <td>{{item.days}}</td> <!--<td>{{item.unitPricePerWeek | number:2}}</td>--> <td>{{item.itemTotal | number:2}}</td> <td data-ng-show="canEdit() && !item.editing"> <a data-ng-show="canEdit()" class="btn btn-default" href="" data-ng-click="editItem(item)" title="Bearbeiten"><span class="glyphicon glyphicon-edit"></span></a> <button type="button" data-ng-show="canEdit()" class="btn btn-default" data-mwl-confirm data-on-confirm="removeItem(item)" data-title="Bestätigung" data-message="Möchtest du <b>{{item.text}}</b> wirklich entfernen?" title="Artikel entfernen"><span class="glyphicon glyphicon-remove"></span></button> </td> <td data-ng-show="item.editing"> <a class="btn btn-default" href="" data-ng-click="saveEditedItem(item)" title="Speichern"><span class="glyphicon glyphicon-ok"></span></a> <a class="btn btn-default" href="" data-ng-click="cancelEditing(item)" title="Verwerfen"><span class="glyphicon glyphicon-asterisk"></span></a> </td> </tr> <tr style="font-weight:bold"> <td colspan="8" style="text-align:right">Total</td> <td>{{getTotal() | number:2}}</td> <td data-ng-show="canEdit()"></td> </tr> </tbody> </table> </form> <div class="row" data-ng-show="cart.items.length > 0"> <div class="col-xs-6 text-left"> <button type="button" class="btn btn-danger btn-lg" data-mwl-confirm data-on-confirm="clearCart()" data-title="Bestätigung" data-message="Möchtest du dein Warenkorb wirklich leeren?" data-ng-disabled="clearingCart" title="Warenkorb leeren"><span class="glyphicon glyphicon-refresh glyphicon-spin" data-ng-show="clearingCart"></span> Warenkorb leeren </button> </div> <div class="col-xs-6 text-right"> <button type="button" class="btn btn-primary btn-lg" data-ng-disabled="!canGoToCheckout()" data-ng-click="goToCheckout()">Weiter zur Bestellung </button>  </div> </div> <div class="alert alert-info" data-ng-show="cart.items.length == 0 && !cartCleared"> <strong>Nichts gefunden!</strong> Dein Warenkorb ist leer. </div> <div class="alert alert-success" data-ng-show="cart.items.length == 0 && cartCleared"> <strong>Jupp!</strong> Dein Warenkorb wurde erfolgreich geleert. </div>'),a.put("views/shop/checkout.html",'<div data-ng-repeat="order in orders"> <div class="page-header"> <h1>Bestellung <small>bei {{order.lessor.name}}</small> </h1> </div> <div data-ng-show="order.placed"> <div class="alert alert-success"> <p><strong>Vielen Dank!</strong> Die Bestellung wurde erfolgreich ausgeführt. </p></div> <p>Das Material ist nun im angegebenen Zeitraum für Dich reserviert.</p> <p>Die Materialstelle bearbeitet Deine Anfrage in den kommenden Tagen. Nach dieser manuellen Überprüfung erhältst Du eine Buchungsbestätigung an Deine registrierte E-Mail-Adresse.</p> </div> <div data-ng-hide="order.placed"> <div class="row"> <div class="col-xs-12 col-sm-12 col-md-6 col-lg-7"> <table class="table table-bordered table-striped"> <thead> <tr> <th>#</th> <th>Artikel</th> <th>Menge</th> <th>Von</th> <th>Bis</th> <th>Preis</th> </tr> </thead> <tbody> <tr data-ng-repeat="item in order.items"> <td>{{$index+1}}</td> <td>{{item.text}}</td> <td>{{item.quantity}}</td> <td>{{item.fromUtc | date:\'mediumDate\'}}</td> <td>{{item.toUtc | date:\'mediumDate\'}}</td> <td>{{item.itemTotal | number:2}}</td> </tr> <tr style="font-weight:bold"> <td colspan="5" class="text-right">Total</td> <td>{{order.total | number:2}}</td> </tr> </tbody> </table> </div> <div class="col-xs-12 col-sm-12 col-md-6 col-lg-5"> <div class="row"> <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"> <div class="panel panel-default"> <div class="panel-heading">Vermieter</div> <div class="panel-body"> <address style="white-space:pre-line; margin-bottom:0">{{order.lessor.address}}<br> <abbr title="Telefon">P:</abbr> {{order.lessor.phoneNumber}} <abbr title="E-Mail-Adresse">@:</abbr> {{order.lessor.emailAddress}} </address> </div> </div> </div> <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"> <div class="panel panel-default"> <div class="panel-heading">Mieter</div> <div class="panel-body"> <address style="white-space:pre-line; margin-bottom:0">{{order.lessee.name}}<br>{{order.lessee.address}}<br> <abbr title="Telefon">P:</abbr> {{order.lessee.phoneNumber}} <abbr title="E-Mail-Adresse">@:</abbr> {{order.lessee.emailAddress}} </address> </div> </div> </div> </div> </div> </div> <div class="row"> <div class="col-xs-12"> <p> Ich bin damit einverstanden, dass der Vermieter "{{order.lessor.name}}" und allfällige weitere mit dem Vermieter in Beziehung stehenden Personen meine Kontaktinformationen wie Adresse, Telefonnummern und E-Mail-Adressen einsiehen. </p> <p> Ich bin damit einverstanden, dass durch die Bestellung ein Vertrag nach OR Art. sowieso entsteht und ich für Schäden an den Gegenständen haftbar bin. Ich bin mir bewusst, dass meine persönliche Haftpflichtversichung sehr wahrscheinlich nicht für die Schäden aufkommt, da es sich um eine Ausleihe gegen Entgelt handelt. </p> <p> Ich bin mir bewusst, dass phundus und/oder die dahinter stehenden Personen nur als Plattformbetreiber auftreten und weder Einfluss auf die Abwicklung der Miete, noch für Schadenersatz oder Haftung belangt werden können. </p> </div> <div class="col-xs-12"> <div class="checkbox"> <input type="checkbox" value="" id="checkbox_{{$index}}_legal_notice" data-ng-model="order.legal_notice"> <label style="font-weight:normal" for="checkbox_{{$index}}_legal_notice"> Ich habe diese Hinweise gelesen und bin damit einverstanden. </label> </div> </div> </div> <div class="row"> <div class="col-xs-12 text-right"> <button type="button" class="btn btn-primary btn-lg" data-ng-click="placeOrder(order)" data-ng-disabled="!canPlaceOrder(order) || order.placing"><span class="glyphicon glyphicon-refresh glyphicon-spin" data-ng-show="order.placing"></span> Bestellung ausführen </button> </div> </div> </div> </div>'),a.put("views/shop/index.html",'<ph-shop-search data-submit="searchQuery"></ph-shop-search> <div class="row"> <div class="col-xs-6 col-md-3 shop-item" data-ng-repeat="each in items"> <a href="" data-ui-sref="public.shop-item({itemId: each.itemId})"> <div class="thumbnail"> <div data-ng-if="each.previewImageUrl"> <img class="img-responsive" ng-src="{{each.previewImageUrl}}.ashx?maxwidth=260&maxheight=180" alt=""> </div> <div data-ng-if="!each.previewImageUrl"> <img class="img-responsive" data-holder="holder.js/260x180?auto=yes" alt=""> </div> <div class="caption"> <h3>{{each.name}}</h3> <p>{{each.lessorName}}</p> <p>CHF {{each.publicPrice | number:2}} <span class="text-muted" data-ng-show="each.memberPrice > 0">({{each.memberPrice | number:2}})</span> / Woche</p> </div> </div> </a> </div> </div> <div class="row"> <div class="col-xs-12 text-center"> <uib-pagination total-items="totalItems" ng-model="currentPage" max-size="7" boundary-link-numbers="true" items-per-page="limit" class="pagination-lg" previous-text="&laquo;" next-text="&raquo;"></uib-pagination> </div> </div>'),a.put("views/shop/shop-item.html",'<div class="page-header"> <h1>{{item.name}} <small>{{item.lessor.name}}</small> </h1> </div> <div class="row" data-ng-show="item"> <div class="col-xs-12 col-md-6"> <ph-shop-item-images images="item.images"></ph-shop-item-images> </div> <div class="col-xs-12 col-md-3"> <div class="panel panel-default"> <div class="panel-heading">Vermieter</div> <div class="panel-body"> <address style="white-space:pre-line; margin-bottom:0">{{lessor.address}}<br> <abbr title="Telefon">P:</abbr> {{lessor.phoneNumber}} <abbr title="E-Mail-Adresse">@:</abbr> {{lessor.emailAddress}} </address> </div> </div> </div> <div class="col-xs-12 col-md-3"> <div data-access-level="accessLevels.user" data-ng-show="lessor"> <ph-shop-item-add-to-cart item="item" data-ng-show="canRent()"></ph-shop-item-add-to-cart> <div class="alert alert-info" data-ng-hide="canRent()"> Dieser Artikel steht nur den Mitglieder dieser Organisation zur Verfügung. </div> </div> <div class="alert alert-info" data-access-level="accessLevels.anon"> Melde dich an um Artikel auszuleihen. </div> </div> </div> <div class="row" style="margin-top:20px"> <uib-tabset class="col-xs-12"> <uib-tab heading="Beschreibung"><div data-ng-bind-html="item.description"></div></uib-tab> <uib-tab heading="Spezifikation"><div data-ng-bind-html="item.specification"></div></uib-tab> <uib-tab heading="Dokumente"> <ph-shop-item-documents documents="item.documents"></ph-shop-item-documents> </uib-tab> <uib-tab heading="Verfügbarkeit"> <ph-shop-item-availability item-id="itemId"></ph-shop-item-availability> </uib-tab> </uib-tabset> </div>'),a.put("views/users/account.html",'<div class="row"> <div class="col-xs-12 col-sm-6 col-md-6 col-lg-5"> <h2>E-Mail-Adresse ändern</h2> <form name="formChangeEmailAddress" novalidate> <div class="form-group" data-has-error="formChangeEmailAddress.password"> <label class="control-label" for="oldPassword">Aktuelles Passwort</label> <input type="password" class="form-control" id="password" name="password" data-ng-model="changeEmailAddress.password" required> <div role="alert" data-ng-messages="formChangeEmailAddress.password.$error" data-ng-show="formChangeEmailAddress.password.$touched || formChangeEmailAddress.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group" data-has-error="formChangeEmailAddress.newEmailAddress"> <label class="control-label" for="newEmailAddress">Neue E-Mail-Adresse</label> <input type="email" class="form-control input" id="newEmailAddress" name="newEmailAddress" data-ng-model="changeEmailAddress.newEmailAddress" required is-unique-email-address> <div role="alert" data-ng-messages="formChangeEmailAddress.newEmailAddress.$error" data-ng-show="formChangeEmailAddress.newEmailAddress.$touched || formChangeEmailAddress.$submitted"> <span class="help-block" data-ng-message="isUnique">Die E-Mail-Adresse wird bereits verwendet.</span> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group"> <ph-submit class="btn-primary btn" data-ng-click="submitChangeEmailAddress()" data-form="formChangeEmailAddress" data-text="Bestätigungs-E-Mail senden"></ph-submit> </div> </form> </div> <div class="col-xs-12 col-sm-6 col-md-6 col-lg-5 col-lg-offset-2"> <h2>Passwort ändern</h2> <form name="formChangePassword" novalidate> <div class="form-group" data-has-error="formChangePassword.oldPassword"> <label class="control-label" for="oldPassword">Aktuelles Passwort</label> <input type="password" class="form-control" id="oldPassword" name="oldPassword" data-ng-model="changePassword.oldPassword" required> <div role="alert" data-ng-messages="formChangePassword.oldPassword.$error" data-ng-show="formChangePassword.oldPassword.$touched || formChangePassword.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group" data-has-error="formChangePassword.newPassword"> <label class="control-label" for="newPassword">Neues Passwort</label> <input type="password" class="form-control" id="newPassword" name="newPassword" data-ng-model="changePassword.newPassword" required> <div role="alert" data-ng-messages="formChangePassword.newPassword.$error" data-ng-show="formChangePassword.newPassword.$touched || formChangePassword.$submitted"> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group" data-has-error="formChangePassword.confirmPassword"> <label class="control-label" for="confirmPassword">Passwort (Wiederholung)</label> <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" data-ng-model="changePassword.confirmPassword" required data-compare-to="changePassword.newPassword"> <div role="alert" data-ng-messages="formChangePassword.confirmPassword.$error" data-ng-show="formChangePassword.confirmPassword.$touched || formChangePassword.$submitted"> <div class="help-block" data-ng-message="compareTo">Die Passwort-Wiederholung stimmt nicht mit dem Passwort überein. </div> <div data-ng-messages-include="views/messages.html"></div> </div> </div> <div class="form-group"> <ph-submit class="btn-primary btn" data-ng-click="submitChangePassword()" data-form="formChangePassword" data-text="Passwort ändern"></ph-submit> </div> </form> </div> </div>'),
a.put("views/users/articles.html",'<div class="ng-cloak alert alert-info" data-ng-show="!store && !loading"> <strong>Keine Materialstelle!</strong> Bevor du dein Material erfassen und verwalten kannst, musst du <a href="" data-ui-sref="user.home({userId: userId})">deine Materialstelle</a> eröffnen. </div> <table class="table table-hover" data-ng-show="store && !loading" data-st-table="displayedArticles" data-st-safe-src="articles"> <thead> <tr> <th colspan="5"> <input data-st-search class="form-control" type="search" placeholder="Suchen..."> </th> </tr> <tr> <th data-st-sort="articleShortId">Id</th> <th data-st-sort-default="true" data-st-sort="name">Name</th> <th class="text-right" data-st-sort="grossStock">Bestand</th> <th class="text-right" data-st-sort="publicPrice">Preis</th> <th class="text-right"> <a class="btn btn-primary" href="" data-ng-click="createArticle()">Neues Material</a> </th> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedArticles"> <td>{{row.articleShortId}}</td> <td>{{row.name}}</td> <td class="text-right">{{row.grossStock}}</td> <td class="text-right">{{row.publicPrice | number:2}}</td> <td class="text-right"> <a class="btn btn-default btn-sm" href="" data-ui-sref="user.articles.article.details({userId: userId, articleId: row.articleId, articleShortId: row.articleShortId})">Bearbeiten</a> <a class="btn btn-danger btn-sm" href="" data-ng-click="delete(row.articleShortId, row.name)">Löschen</a> </td> </tr> </tbody> </table> <div class="alert alert-info" data-ng-show="store && !loading && articles.length == 0"> <strong>Nichts gefunden!</strong> Es sind keine Artikel vorhanden. </div> <div class="alert alert-info" data-ng-show="store && !loading && displayedArticles.length == 0 && articles.length > 0"> <strong>Nichts gefunden!</strong> Deine Suche liefert keine Ergebnisse. </div>'),a.put("views/users/home.html",'<div class="row"> <div class="col-sm-4 col-md-3 col-lg-3"> <ph-user-vcard data-user="user" data-ng-show="user" data-is-home="isHome"></ph-user-vcard> </div> <div class="col-sm-8 col-md-9 col-lg-9 col-xs-12"> <ph-store data-store="user.store" data-map="map" data-is-editable="isHome"></ph-store> <div data-ng-show="user && !user.store"> <div class="jumbotron" data-ng-show="isHome"> <p>Im Fall. Mit phundus kannst du auch dein eigenes Material vermieten. Ideal ist es wenn das Material Outdoorerfahrung oder Jugendaktivitäten unterstützt. Klicke dazu auf diesen Button und erfasse Standort mit Ansichtsauswahl auf der Karte und im Textfeld mögliche Zeiten wann das Material am ehesten übergeben werden kann. Anschliessend kannst du beliebiges Material erfassen, mit Pic’s ergänzen und bei Bedarf jederzeit bearbeiten. Probiere es aus!</p> <p class="text-right"> <button class="btn btn-primary btn-lg" data-ng-click="openStore()" data-ng-disabled="isOpeningStore"><span class="glyphicon glyphicon-refresh glyphicon-spin" data-ng-show="isOpeningStore"></span> Eigene Materialstelle eröffnen </button> </p> </div> <div class="jumbotron" data-ng-hide="isHome"> <p>Dieser Benutzer hat keine eigene Materialstelle eröffnet.</p> </div> </div> </div> </div> '),a.put("views/users/order.html",'<h2>Bestellung {{order.orderId}}</h2> <div data-ng-show="order" class="row"> <div class="col-lg-4"> <p>Status: {{order.status | orderStatusText}}</p> <p>Vermieter: {{order.lessorName}}</p> <p>Erstellt: {{order.createdAtUtc | date:\'medium\'}}</p> <p>Bearbeitet: {{order.modifiedAtUtc | date:\'medium\'}}</p> </div> <div class="col-lg-4"> <p>{{order.lessee.name}}</p> <p>{{order.lessee.street}}</p> <p>{{order.lessee.postcode}} {{order.lessee.city}}</p> <p>{{order.lessee.memberNumber}}</p> </div> </div> <form name="orderForm" novalidate> <table data-ng-show="order" class="table table-bordered table-striped"> <thead> <tr> <th>#</th> <th>Artikel</th> <th>Verfügbar</th> <th>Von</th> <th>Bis</th> <th>Menge</th> <th>Stückpreis</th> <th>Total</th> <th data-ng-show="canEdit()"></th> </tr> </thead> <tbody> <tr data-ng-repeat="item in order.items"> <td>{{$index+1}}</td> <td>{{item.text}}</td> <td data-ng-show="item.isAvailable"><span class="glyphicon glyphicon-ok"></span></td> <td data-ng-show="!item.isAvailable"><span class="glyphicon glyphicon-remove"></span></td> <td data-ng-show="!item.editing">{{item.fromUtc | date:\'mediumDate\'}}</td> <td data-ng-show="!item.editing">{{item.toUtc | date:\'mediumDate\'}}</td> <td data-ng-show="!item.editing">{{item.amount}}</td> <td data-ng-show="item.editing" class="col-sm-2" data-ng-class="{\'has-error\':!orderForm.item_{{$index}}_fromUtc.$valid && orderForm.item_{{$index}}_fromUtc.$touched}"> <p class="input-group"> <input class="form-control" type="text" required data-ng-model="item.fromUtc" name="item_{{$index}}_fromUtc" data-uib-datepicker-popup="mediumDate" data-is-open="fromUtcIsOpen"> <span class="input-group-btn"> <button type="button" class="btn btn-default" data-ng-click="fromUtcIsOpen = true"> <i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </td> <td data-ng-show="item.editing" class="col-sm-2" data-ng-class="{\'has-error\':!orderForm.item_{{$index}}_toUtc.$valid && orderForm.item_{{$index}}_toUtc.$touched}"> <p class="input-group"> <input class="form-control" type="text" required data-ng-model="item.toUtc" name="item_{{$index}}_toUtc" data-uib-datepicker-popup="mediumDate" data-is-open="toUtcIsOpen"> <span class="input-group-btn"> <button type="button" class="btn btn-default" data-ng-click="toUtcIsOpen = true"> <i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </td> <td data-ng-show="item.editing" class="col-sm-1" data-ng-class="{\'has-error\':!orderForm.item_{{$index}}_amount.$valid && orderForm.item_{{$index}}_amount.$touched}"> <input class="form-control" type="number" required data-ng-model="item.amount" name="item_{{$index}}_amount"> </td> <td>{{item.unitPrice | number:2}}</td> <td data-ng-show="!item.editing">{{item.itemTotal | number:2}}</td> <td data-ng-show="item.editing" class="col-sm-2" data-ng-class="{\'has-error\':!orderForm.item_{{$index}}_itemTotal.$valid && orderForm.item_{{$index}}_itemTotal.$touched}"> <p class="input-group"> <input class="form-control" type="text" required data-ng-model="item.itemTotal" name="item_{{$index}}_itemTotal"> <span class="input-group-btn"> <button class="btn btn-default" data-ng-click="calculateItemTotal(item)" title="Preis berechnen"> <i class="glyphicon glyphicon-refresh"></i></button> </span> </p> </td> <td data-ng-show="canEdit() && !item.editing"> <a data-ng-show="canEdit()" class="btn btn-default" href="" data-ng-click="editItem(item)" title="Bearbeiten"><span class="glyphicon glyphicon-edit"></span></a> <a data-ng-show="canEdit()" class="btn btn-default" href="" data-ng-click="removeItem(item)" title="Entfernen"><span class="glyphicon glyphicon-remove"></span></a> </td> <td data-ng-show="item.editing"> <a class="btn btn-default" href="" data-ng-click="saveEditedItem(item)" title="Speichern"><span class="glyphicon glyphicon-ok"></span></a> <a class="btn btn-default" href="" data-ng-click="cancelEditing(item)" title="Verwerfen"><span class="glyphicon glyphicon-asterisk"></span></a> </td> </tr> <tr style="font-weight:bold"> <td colspan="7" style="text-align:right">Total</td> <td>{{getTotal() | number:2}}</td> <td data-ng-show="canEdit()"></td> </tr> </tbody> </table> </form> <div class="row"> <div class="col-sm-6"> <a class="btn btn-default" href="" ph-history-back>Zurück</a> <a data-ng-show="order" class="btn btn-default" href="/api/orders/{{order.orderId}}.pdf">PDF</a> </div> <div ng-show="order" class="col-sm-6" style="text-align:right"> <a class="btn btn-default" data-ng-show="canEdit()" href="" data-ng-click="showAddItem(order)">Artikel hinzufügen</a> <a class="btn btn-primary" data-ng-show="canConfirm()" href="" data-ng-click="confirmOrder(order)">Bestätigen</a> <a class="btn btn-danger" data-ng-show="canReject()" href="" data-ng-click="rejectOrder(order)">Ablehnen</a> <a class="btn btn-primary" data-ng-show="canClose()" href="" data-ng-click="closeOrder(order)">Abschliessen</a> </div> </div>'),a.put("views/users/orders.html",'<table class="table table-hover" data-st-table="displayedCollection" data-st-safe-src="rowCollection"> <thead> <tr> <th colspan="6"> <div class="col-md-3"> <select data-st-search="status" class="form-control"> <option value="">Alle</option> <option data-ng-repeat="row in rowCollection | unique:\'status\'" value="{{row.status}}">{{row.status | orderStatusText}} </option> </select> </div> <div class="col-md-9"> <input data-st-search class="form-control" type="search" placeholder="Suchen..."> </div> </th> </tr> <tr> <th data-st-sort-default="true" data-st-sort="orderId">Nummer</th> <th data-st-sort="createdAtUtc">Erstellt</th> <th data-st-sort="lessorName">Vermieter</th> <th data-st-sort="lesseeName">Mieter</th> <th data-st-sort="status">Status</th> <th></th> </tr> </thead> <tbody> <tr data-ng-repeat="order in displayedCollection"> <td>{{order.orderId}}</td> <td> <ph-date value="order.createdAtUtc"></ph-date> </td> <td>{{order.lessorName}}</td> <td>{{order.lessee.name}}</td> <td>{{order.status | orderStatusText}}</td> <td class="text-right"> <a class="btn btn-default btn-sm" href="" data-ui-sref="user.orders.order({userId: userId, orderId: order.orderId})">Öffnen</a> <a class="btn btn-default btn-sm" href="/api/v0/orders/{{order.orderId}}.pdf">PDF</a> </td> </tr> </tbody> </table> <div class="alert alert-info" data-ng-show="rowCollection.length == 0"> <strong>Nichts gefunden!</strong> Es sind keine Bestellungen vorhanden. </div> <div class="alert alert-info" data-ng-show="displayedCollection.length == 0 && rowCollection.length > 0"> <strong>Nichts gefunden!</strong> Deine Suche liefert keine Ergebnisse. </div>')}]);