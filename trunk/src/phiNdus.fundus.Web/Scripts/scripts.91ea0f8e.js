!function(a){function b(a){var b="01",c={};for(var d in a){var e=parseInt(b,2);c[a[d]]={bitMask:e,title:a[d]},b=(e<<1).toString(2)}return c}function c(a,b){var c={};for(var d in a){var e,f;if("string"==typeof a[d])if("*"===a[d]){f="";for(e in b)f+="1";c[d]={bitMask:parseInt(f,2)}}else console.log("Access Control Error: Could not parse '"+a[d]+"' as access definition for level '"+d+"'");else{f=0;for(e in a[d])b.hasOwnProperty(a[d][e])?f|=b[a[d][e]].bitMask:console.log("Access Control Error: Could not find role '"+a[d][e]+"' in registered roles while building access for '"+d+"'");c[d]={bitMask:f}}}return c}var d={roles:["public","user","manager","admin"],accessLevels:{"public":"*",anon:["public"],user:["user","manager","admin"],manager:["manager","admin"],admin:["admin"]}};a.userRoles=b(d.roles),a.accessLevels=c(d.accessLevels,a.userRoles)}("undefined"==typeof exports?this.routingConfig={}:exports);var app=angular.module("phundusApp",["leaflet-directive","ngCookies","ngSanitize","smart-table","ui.gravatar","ui.router","uuid","xeditable"]).constant("_",window._).constant("$",window.$).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(a,b,c,d){var e=window.routingConfig.accessLevels;a.state("public",{"abstract":!0,template:"<ui-view/>",data:{access:e["public"]}}).state("public.shop",{url:"/",template:"<ui-view />",controller:"ShopCtrl"}).state("public.organizations",{url:"/organizations",templateUrl:"views/organizations.html",controller:"OrganizationsCtrl"}).state("public.organization",{url:"/organizations/:organizationId",templateUrl:"views/organization.html",controller:"OrganizationCtrl",resolve:{organizationId:["$stateParams",function(a){return a.organizationId}]}}).state("public.404",{url:"/404",templateUrl:"views/404.html"}).state("public.debug",{url:"/debug",templateUrl:"views/debug.html",controller:"DebugCtrl"}),a.state("anon",{"abstract":!0,template:"<ui-view/>",data:{access:e.anon}}).state("anon.register",{url:"/register",templateUrl:"views/register.html",controller:"RegisterCtrl"}).state("anon.login",{url:"/login",templateUrl:"views/login.html",controller:"LoginCtrl"}).state("anon.logout",{url:"/logout",templateUrl:"views/logout.html",controller:"LogoutCtrl"}).state("anon.goodbye",{url:"/goodbye",templateUrl:"views/goodbye.html"}),a.state("users",{"abstract":!0,url:"/users/:userId",templateUrl:"views/users.html",data:{access:e.user},controller:"UsersCtrl",resolve:{userId:["$stateParams",function(a){return a.userId}]}}).state("users.home",{url:"",templateUrl:"views/users/home.html",controller:"UsersHomeCtrl"}).state("users.articles",{"abstract":!0,template:"<ui-view></ui-view>"}).state("users.articles.index",{url:"/articles",templateUrl:"views/users/articles.html",controller:"UsersArticlesCtrl"}).state("users.articles.article",{"abstract":!0,url:"/articles/{articleId:[^/]+}",templateUrl:"views/users/article-pills.html",controller:"UsersArticlesArticleCtrl",resolve:{articleId:["$stateParams",function(a){return a.articleId}]}}).state("users.articles.article.details",{url:"",template:"<p>users.article.details</p>",controller:"UsersArticlesArticleDetailsCtrl"}).state("users.articles.article.files",{url:"/files",template:"<p>users.article.files</p>",controller:"UsersArticlesArticleFilesCtrl"}).state("users.articles.article.categories",{url:"/categories",template:"<p>users.article.categories</p>",controller:"UsersArticlesArticleCategoriesCtrl"}).state("users.orders",{url:"/orders",templateUrl:"views/users/orders.html",controller:"UsersOrdersCtrl"}),a.state("manage",{"abstract":!0,template:"<ui-view/>",data:{access:e.manager}}).state("manage.articles",{url:"/organizations/{organizationId}/articles",templateUrl:"views/manage/articles.html",controller:"ManageArticlesCtrl",resolve:{organizationId:["$stateParams",function(a){return a.organizationId}]}}),a.state("admin",{"abstract":!0,template:"<ui-view/>",data:{access:e.admin}}).state("admin.admin",{url:"/admin",templateUrl:"views/admin.html",controller:"AdminCtrl"}),b.otherwise("/404"),c.html5Mode(!1),b.rule(function(a,b){return"file"!==b.protocol()&&""===b.path()?"/":void 0}),d.interceptors.push(["$q","$location",function(a,b){return{responseError:function(c){return 401===c.status||403===c.status?(b.search("returnPath",encodeURI(b.path())),b.path("/#/login")):404===c.status&&b.path("/#/404"),a.reject(c)}}}])}]);angular.module("phundusApp").filter("orderStatusText",function(){return function(a){return{Pending:"Provisorisch",Approved:"Bestätigt",Rejected:"Abgelehnt",Closed:"Abgeschlossen"}[a]}}),app.run(["$rootScope","$state","Auth","Alert","editableOptions",function(a,b,c,d,e){a.$state=b,e.theme="bs3",a.$on("$stateChangeStart",function(a,e,f,g){"data"in e&&"access"in e.data?c.authorize(e.data.access,void 0,f.organizationId)||(d.error("Seems like you tried accessing a route you don't have access to..."),a.preventDefault(),"^"===g.url&&(c.isLoggedIn()?b.go("anon.login"):b.go("anon.login"))):(d.error("Access undefined for this state."),a.preventDefault())})}]),angular.module("phundusApp").controller("AdminCtrl",["$scope","Users","Auth","Alert",function(a,b,c,d){a.loading=!0,a.userRoles=c.userRoles,b.getAll(function(b){a.users=b,a.loading=!1},function(){d.error("Failed to fetch users."),a.loading=!1})}]),angular.module("phundusApp").controller("DebugCtrl",["$","$scope","$http","$cookies","$timeout","Alert",function(a,b,c,d,e,f){b.status={},c.get("/api/v0/status").success(function(a){b.status=a}),b.toggleCartPopover=function(){a("#popover-glyphicon-cart").popover("show"),e(function(){a("#popover-glyphicon-cart").popover("hide")},4e3,!0)},b.cookies=d.getAll(),b.alertMsg="Alert message",b.addError=function(){f.error(b.alertMsg)},b.addDanger=function(){f.danger(b.alertMsg)},b.addWarning=function(){f.warning(b.alertMsg)},b.addSuccess=function(){f.success(b.alertMsg)}}]),angular.module("phundusApp").controller("LoginCtrl",["$scope","$location","$window","Auth","Alert",function(a,b,c,d,e){a.rememberMe=!0,a.login=function(){d.login({username:a.username,password:a.password,rememberme:a.rememberMe},function(){var a=b.search().ReturnUrl;if(a)c.location.href=a;else{var d=b.search().returnPath||"/";delete b.search().returnPath,b.path(d)}},function(){e.error("Das angegebene Passwort ist nicht korrekt.")})}}]),angular.module("phundusApp").controller("LogoutCtrl",["$scope","$location","$window","Auth","Alert",function(a,b,c,d,e){d.isLoggedIn?d.logout(function(){b.path("/goodbye")},function(a){e.error(a)}):b.path("/goodbye")}]),angular.module("phundusApp").controller("NavCtrl",["$rootScope","$scope","$state","$location","$window","Auth","Alert","Organizations",function(a,b,c,d,e,f,g,h){a.alerts=g.alerts,a.dismissAlert=function(a,b){g.dismiss(a,b)},b.user=f.user,b.userRoles=f.userRoles,b.accessLevels=f.accessLevels,b.queryString="",b.search=function(){e.location.href="/shop/Search?queryString="+b.queryString},b.logout=function(){f.logout(function(){d.path("/goodbye")},function(a){g.error(a)})},b.establishOrganization=function(){var a=e.prompt("Name der neuen Organisation","");a&&h.post(a,function(a){g.success("Die Organisation wurde erfolgreich gegründet."),c.go("public.organization",{organizationId:a.organizationId})},function(){g.error("Fehler beim Gründen der Organisation.")})}}]),angular.module("phundusApp").controller("OrganizationsCtrl",["$scope","Organizations","Alert",function(a,b,c){a.loading=!0,b.getAll(function(b){a.organizations=b,a.displayedOrganizations=[].concat(a.organizations),a.loading=!1},function(){c.error("Fehler beim Laden der Organisationen."),a.loading=!1})}]).controller("OrganizationCtrl",["organizationId","$scope","$sce","$window","Alert","Auth","Organizations","Relationships","Applications","leafletData","leafletMarkersHelpers","$timeout",function(a,b,c,d,e,f,g,h,i,j,k,l){b.loading=!0,b.accessLevels=f.accessLevels,b.organization=null,b.organizationId=a,b.hasContactOptions=function(){return b.organization&&(b.organization.address||b.organization.emailAddress||b.organization.website)},g.get(a,function(d){b.organization=d,b.startpage=c.trustAsHtml(d.startpage),l(function(){b.organization.coordinate&&j.getMap().then(function(a){var c=b.organization.coordinate.split(","),d={lat:parseFloat(c[0]),lng:parseFloat(c[1])};a.setView(d,14),b.marker?b.marker.setLatLng(d):(b.marker=k.createMarker(d),b.marker.addTo(a))})},0),f.isLoggedIn()&&h.get(a,function(a){b.relationship=a},function(){e.error("Fehler beim Laden des Mitgliedschaftsstatus.")})},function(){e.error("Fehler beim Laden der Organisation.")}),b.join=function(){d.confirm("Möchtest du dieser Organisation wirklich beitreten?")&&i.post(a,{},function(){e.info("Die Mitgliedschaft wurde beantragt. Du erhältst ein E-Mail wenn ein Administrator diese bestätigt oder ablehnt."),b.relationship={status:"Application",timestamp:new Date}},function(){e.error("Fehler beim Beantragen der Mitgliedschaft.")})}}]),angular.module("phundusApp").controller("RegisterCtrl",[function(){}]),angular.module("phundusApp").controller("ShopCtrl",["$timeout","$window",function(a,b){a(function(){b.location.href="shop"},0)}]),angular.module("phundusApp").controller("UsersCtrl",["$scope","$state","$stateParams","Auth",function(a,b,c,d){a.state=b,a.userId=c.userId,a.isHome=a.userId+""==d.user.userId+""}]),angular.module("phundusApp").controller("UsersHomeCtrl",["$scope","$stateParams","Users","Stores","Auth","Alert",function(a,b,c,d,e,f){a.loaded=!1,a.isHome=!1,a.user=null,a.store=null,c.get(b.userId,function(b){a.user=b,a.store=a.user.store,a.isHome=a.user.userId===e.user.userId,a.loaded=!0},function(a){f.error("Failed to fetch user: "+a)}),a.openStore=function(){d.post(a.user.userId,function(b){a.store=b,f.success("Successfully opened your store!")},function(a){f.error("Failed to open your store: "+a)})}}]),angular.module("phundusApp").controller("UsersArticlesCtrl",["$scope",function(a){a.rowCollection=[{id:"1",caption:"hans"},{id:"2",caption:"peter"}],a.displayedCollection=[].concat(a.rowCollection)}]),angular.module("phundusApp").controller("UsersArticlesArticleCtrl",["$scope","userId","articleId",function(a,b,c){console.log("UsersArticlesArticleCtrl"),console.log("userId",b),console.log("articleId",c),a.userId=b,a.articleId=c}]).controller("UsersArticlesArticleDetailsCtrl",["$scope","userId","articleId",function(a,b,c){console.log("UsersArticlesArticleDetailsCtrl"),console.log("userId",b),console.log("articleId",c),a.userId=b,a.articleId=c}]).controller("UsersArticlesArticleFilesCtrl",["$scope","userId","articleId",function(a,b,c){console.log("UsersArticlesArticleFilesCtrl"),console.log("userId",b),console.log("articleId",c),a.userId=b,a.articleId=c}]).controller("UsersArticlesArticleCategoriesCtrl",["$scope","userId","articleId",function(a,b,c){console.log("UsersArticlesArticleCategoriesCtrl"),console.log("userId",b),console.log("articleId",c),a.userId=b,a.articleId=c}]),angular.module("phundusApp").controller("UsersOrdersCtrl",["$scope","Orders","Alert",function(a,b,c){b.getAll(function(b){a.rowCollection=b,a.displayedCollection=[].concat(a.rowCollection)},function(a){c.error(a)})}]),angular.module("phundusApp").controller("UsersContractsCtrl",["$scope",function(a){a.search={status:""},a.order="-createdUtc",a.orderBy=function(b){a.order===b?a.order="-"+b:a.order=b}}]),angular.module("phundusApp").controller("ManageArticlesCtrl",["_","$scope","$window","Articles","Auth","Alert","organizationId",function(a,b,c,d,e,f,g){b.loading=!0,b.userRoles=e.userRoles,b.organizationId=g,d.getAll(g,function(a){b.articles=a,b.displayedArticles=[].concat(b.articles),b.loading=!1},function(){f.error("Fehler beim Laden der Artikel."),b.loading=!1}),b["delete"]=function(e,h){c.confirm('Möchtest du den Artikel "'+h+'" wirklich löschen?')&&d["delete"](g,e,function(){f.success('Der Artikel "'+h+'" wurder erfolgreich gelöscht.'),a.remove(b.displayedArticles,{id:e}),a.remove(b.articles,{id:e})},function(){f.error('Fehler beim Löschen des Artikels "'+h+'".')})}}]),angular.module("phundusApp").directive("phManageNavbar",["Auth",function(a){return{restrict:"E",replace:"true",scope:{organizationId:"=organizationId"},link:function(b){b.accessLevels=a.accessLevels,b.userRoles=a.userRoles},templateUrl:"views/directives/ph-manage-navbar.html"}}]),angular.module("phundusApp").directive("phUserVcard",[function(){return{restrict:"E",replace:"true",scope:{user:"=",isEditable:"="},templateUrl:"views/directives/ph-user-vcard.html"}}]),angular.module("phundusApp").directive("phUserStore",["$timeout","Stores","Alert","leafletData","leafletMarkersHelpers",function(a,b,c,d,e){return{restrict:"E",replace:"true",scope:{store:"=",isEditable:"="},link:function(f){var g={lat:46.80121,lng:8.226692};console.log(d),a(function(){d.getMap().then(function(a){a.setView(g,7)})},0);var h=function(){f.store&&f.store.coordinate&&a(function(){d.getMap().then(function(a){var b={lat:f.store.coordinate.latitude,lng:f.store.coordinate.longitude};a.setView(b,16),f.marker?f.marker.setLatLng(b):(f.marker=e.createMarker(b,{draggable:!0}),f.marker.addTo(a))})},500)};h(),f.fromMap=function(){d.getMap().then(function(a){var b=a.getCenter();f.userStoreCoordinateForm.latitude.$setViewValue(b.lat),f.userStoreCoordinateForm.latitude.$render(),f.userStoreCoordinateForm.longitude.$setViewValue(b.lng),f.userStoreCoordinateForm.longitude.$render()})},f.$watch("store.coordinate.latitude",function(){h()}),f.$watch("store.coordinate.longitude",function(){h()}),f.updateAddress=function(a){b.putAddress(f.store.storeId,a.address,function(){},function(a){c.danger(a)})},f.updateOpeningHours=function(a){b.putOpeningHours(f.store.storeId,a.openingHours,function(){},function(a){c.danger(a)})},f.updateCoordinate=function(a){b.putCoordinate(f.store.storeId,a,function(){},function(a){c.danger(a)})}},templateUrl:"views/directives/ph-user-store.html"}}]),angular.module("phundusApp").filter("replace",function(){return function(a,b,c){return void 0===a||null===a?null:a.replace(new RegExp(b,"mg"),c)}}),angular.module("phundusApp").factory("Alert",["$timeout","uuid4",function(a,b){var c={},d=function(a,b){delete c[a][b]},e=function(e,f){var g=b.generate();c[e]=c[e]||{},c[e][g]=f,a(d,1e4,!0,e,g)};return{alerts:c,dismiss:function(a,b){d(a,b)},danger:function(a){e("danger",a)},error:function(a){e("danger",a)},info:function(a){e("info",a)},success:function(a){e("success",a)},warning:function(a){e("warning",a)}}}]),angular.module("phundusApp").factory("Auth",["$http","$cookies","_",function(a,b,c){function d(a){angular.extend(j,a),k=c.find(a.memberships,{selected:!0}),f()}function e(a){c.forEach(j.memberships,function(b){b.selected=b===a}),k=a,f()}function f(){if(k){var a=i.manager.bitMask;k.isManager?j.role.bitMask=j.role.bitMask|a:j.role.bitMask=j.role.bitMask&~a}}function g(a){if(!a)return 0;var b=c.find(j.memberships,{organizationId:a});return b&&b.isManager?i.manager.bitMask:0}var h=window.routingConfig.accessLevels,i=window.routingConfig.userRoles,j=b.getObject("ph.user")||{username:"",role:i["public"]},k=c.find(j.memberships,{selected:!0});return f(),{authorize:function(a,b,c){return void 0===b&&(b=j.role),a.bitMask&(b.bitMask|g(c))},isLoggedIn:function(a){return void 0===a&&(a=j),a.role.title===i.user.title||a.role.title===i.admin.title},login:function(c,e,f){a.post("/api/v0/sessions",{username:c.username,password:c.password,rememberme:c.rememberme}).success(function(a){b.putObject("ph.user",a,{secure:!1}),d(a),e(a)}).error(f)},logout:function(c,e){b.remove("ph.user"),a["delete"]("/api/v0/sessions").success(function(){d({memberships:void 0,username:"",role:i["public"]}),c()}).error(e)},select:function(b,c,d){e(b),a.get("/organization/select/"+b.organizationId).success(function(a){c&&c(a)}).error(d)},accessLevels:h,userRoles:i,user:j}}]),angular.module("phundusApp").factory("Contracts",["$http",function(a){return{getAll:function(b,c){a.get("/api/contracts").success(b).error(c)}}}]).factory("Orders",["$http",function(a){return{getAll:function(b,c){a.get("/api/orders").success(b).error(c)}}}]).factory("Stores",["$http",function(a){return{get:function(b,c,d){a.get("/api/v1/stores/"+b).success(c).error(d)},post:function(b,c,d){a.post("/api/v1/stores",{userId:b}).success(c).error(d)},putAddress:function(b,c,d,e){a.put("/api/v1/stores/"+b+"/address",{address:c}).success(d).error(e)},putOpeningHours:function(b,c,d,e){a.put("/api/v1/stores/"+b+"/opening-hours",{openingHours:c}).success(d).error(e)},putCoordinate:function(b,c,d,e){a.put("/api/v1/stores/"+b+"/coordinate",{coordinate:{latitude:parseFloat(c.latitude),longitude:parseFloat(c.longitude)}}).success(d).error(e)}}}]).factory("Users",["$http",function(a){return{getAll:function(b,c){a.get("/api/v0/users").success(b).error(c)},get:function(b,c,d){a.get("/api/v0/users/"+b).success(c).error(d)}}}]).factory("Organizations",["$http",function(a){return{getAll:function(b,c){a.get("/api/v0/organizations").success(b).error(c)},get:function(b,c,d){a.get("/api/v0/organizations/"+b).success(c).error(d)},post:function(b,c,d){a.post("/api/v0/organizations",{name:b}).success(c).error(d)}}}]).factory("Relationships",["$http",function(a){return{get:function(b,c,d){a.get("/api/v0/organizations/"+b+"/relationships").success(c).error(d)}}}]).factory("Applications",["$http",function(a){return{post:function(b,c,d,e){a.post("/api/v0/organizations/"+b+"/applications",c).success(d).error(e)}}}]).factory("Articles",["$http",function(a){return{getAll:function(b,c,d){a.get("/api/v0/organizations/"+b+"/articles").success(c).error(d)},"delete":function(b,c,d,e){a["delete"]("/api/v0/organizations/"+b+"/articles/"+c).success(d).error(e)}}}]),angular.module("phundusApp").directive("accessLevel",["Auth",function(a){return{restrict:"A",link:function(b,c,d){function e(){f&&g&&(a.authorize(g,f,h)?c.css("display",i):c.css("display","none"))}var f,g,h,i=c.css("display");b.user=a.user,b.$watch("user",function(a){a.role&&(f=a.role),e()},!0),d.$observe("accessLevel",function(a){a&&(g=b.$eval(a)),e()}),d.$observe("organizationId",function(a){a&&(h=b.$eval(a)),e()})}}}]),angular.module("phundusApp").directive("activeNav",["$location",function(a){function b(a){return"/"!==a[a.length-1]&&(a+="/"),a}return{restrict:"A",link:function(c,d,e){var f=d[0];"A"!==d[0].tagName.toUpperCase()&&(f=d.find("a")[0]);var g=f.href;c.location=a,c.$watch("location.absUrl()",function(a){g=b(g),a=b(a),g===a||"nestedTop"===e.activeNav&&0===a.indexOf(g)?d.addClass("active"):d.removeClass("active")})}}}]),angular.module("phundusApp").run(["$templateCache",function(a){"use strict";a.put("views/404.html","<h1>404</h1> <p>Hier ist nichts zu finden.</p> <div ui-view></div>"),a.put("views/admin.html",'<h1>admin</h1> <p>This view is visible to users with the administrator role.</p> <table class="table table-striped" data-ng-hide="loading"> <thead> <tr> <th>#</th> <th>Username</th> <th>Role</th> </tr> </thead> <tbody> <tr data-ng-repeat="user in users"> <td>{{user.id}}</td> <td>{{user.username}}</td> <td> <span class="label" data-ng-class="{&quot;label-info&quot;: user.role.title == userRoles.user.title, &quot;label-success&quot;: user.role.title == userRoles.admin.title}"> {{user.role.title}} </span> </td> </tr> </tbody> </table>'),a.put("views/debug.html",'<h1>Debug</h1> <p><button class="btn btn-default" data-ng-click="toggleCartPopover()">Zeige Warenkorb-Meldung</button></p> <h2>Test Alerts</h2> <form> <div class="form-group"> <input type="text" class="form-control" id="inputAlertMsg" data-ng-model="alertMsg"> </div> <button class="btn btn-default" data-ng-click="addError()">Add error</button> <button class="btn btn-default" data-ng-click="addDanger()">Add danger</button> <button class="btn btn-default" data-ng-click="addWarning()">Add warning</button> <button class="btn btn-default" data-ng-click="addSuccess()">Add success</button> </form> <h2>Status</h2> <pre>{{status|json}}</pre> <h2>Cookies</h2> <pre>{{cookies|json}}</pre>'),a.put("views/directives/ph-manage-navbar.html",'<ul class="nav nav-tabs" data-access-level="accessLevels.manager" data-organization-id="organizationId"> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="public.organization({organizationId: organizationId})">Home</a> </li> <li role="presentation"><a href="/management/{{organizationId}}#/orders">Bestellungen</a></li> <li role="presentation" data-ui-sref-active="active"> <a href="" data-ui-sref="manage.articles({organizationId: organizationId})">Material</a> </li> <li role="presentation"><a href="/management/{{organizationId}}#/members">Mitglieder</a></li> <li role="presentation"><a href="/management/{{organizationId}}#/applications">Beitrittsanfragen</a></li> <li role="presentation"><a href="/management/{{organizationId}}#/settings">Einstellungen</a></li> <li role="presentation"><a href="/management/{{organizationId}}#/files">Dateien</a></li> </ul>'),a.put("views/directives/ph-user-store.html",'<div data-ng-show="store" class="store"> <h2>Materialstelle</h2> <div class="row"> <div class="col-sm-3"> <label>Adresse</label> </div> <div class="col-sm-9"> <p data-ng-hide="isEditable" style="white-space:pre">{{store.address}}</p> <form data-editable-form name="userStoreAddressForm" data-ng-show="isEditable" data-onbeforesave="updateAddress($data)"> <div class="form-group"> <button type="button" class="btn btn-default pull-right" data-ng-click="userStoreAddressForm.$show()" data-ng-show="!userStoreAddressForm.$visible" title="Bearbeiten"> <span class="glyphicon glyphicon-edit"></span> </button> <p> <span style="white-space:pre" data-editable-textarea="store.address" data-e-rows="5" data-e-name="address">{{store.address}}</span> </p> </div> <div class="form-group" data-ng-show="userStoreAddressForm.$visible"> <button type="submit" class="btn btn-primary" data-ng-disabled="userStoreAddressForm.$waiting"> Speichern </button> <button type="button" class="btn btn-default" data-ng-disabled="userStoreAddressForm.$waiting" data-ng-click="userStoreAddressForm.$cancel()"> Verwerfen </button> </div> </form> </div> </div> <div class="row"> <div class="col-sm-3"> <label>Öffnungszeiten</label> </div> <div class="col-sm-9"> <p data-ng-hide="isEditable" style="white-space:pre">{{store.openingHours}}</p> <form data-editable-form name="userStoreOpeningHoursForm" data-ng-show="isEditable" data-onbeforesave="updateOpeningHours($data)"> <div class="form-group"> <button type="button" class="btn btn-default pull-right" data-ng-click="userStoreOpeningHoursForm.$show()" data-ng-show="!userStoreOpeningHoursForm.$visible" title="Bearbeiten"> <span class="glyphicon glyphicon-edit"></span> </button> <p> <span style="white-space:pre" data-editable-textarea="store.openingHours" data-e-rows="5" data-e-name="openingHours">{{store.openingHours}}</span> </p> </div> <div class="form-group" data-ng-show="userStoreOpeningHoursForm.$visible"> <button type="submit" class="btn btn-primary" data-ng-disabled="userStoreOpeningHoursForm.$waiting"> Speichern </button> <button type="button" class="btn btn-default" data-ng-disabled="userStoreOpeningHoursForm.$waiting" data-ng-click="userStoreOpeningHoursForm.$cancel()"> Verwerfen </button> </div> </form> </div> </div> <div class="row" data-ng-show="isEditable"> <div class="col-sm-3"> <label>Koordinaten</label> <p data-ng-show="userStoreCoordinateForm.$visible">Latitude / Longitude</p> </div> <div class="col-sm-9"> <p data-ng-hide="isEditable">{{store.coordinate.latitude}}</p> <p data-ng-hide="isEditable">{{store.coordinate.longitude}}</p> <button type="button" class="btn btn-default pull-right" data-ng-click="userStoreCoordinateForm.$show()" data-ng-show="!userStoreCoordinateForm.$visible" title="Bearbeiten"> <span class="glyphicon glyphicon-edit"></span> </button> <form data-editable-form name="userStoreCoordinateForm" data-ng-show="isEditable" data-onbeforesave="updateCoordinate($data)"> <div class="form-group"> <p><span data-editable-text="store.coordinate.latitude" data-e-name="latitude">{{store.coordinate.latitude}}</span></p> <p><span data-editable-text="store.coordinate.longitude" data-e-name="longitude">{{store.coordinate.longitude}}</span></p> </div> <div class="form-group" data-ng-show="userStoreCoordinateForm.$visible"> <button type="button" class="btn btn-default" data-ng-disabled="userStoreCoorindateForm.$waiting" data-ng-click="fromMap()" title="Koordinate von der Karte übertragen"><span class="glyphicon glyphicon-arrow-up"></span></button> <button type="submit" class="btn btn-primary" data-ng-disabled="userStoreCoordinateForm.$waiting"> Speichern </button> <button type="button" class="btn btn-default" data-ng-disabled="userStoreCoordinateForm.$waiting" data-ng-click="userStoreCoordinateForm.$cancel()"> Verwerfen </button> </div> </form> </div> </div> <div class="row"> <div class="col-sm-12"> <leaflet width="100%" height="400px" style="margin-bottom:10px"></leaflet> </div> </div> </div>'),a.put("views/directives/ph-user-vcard.html",'<div class="vcard"> <a class="vcard-avatar"> <img class="avatar" gravatar-src-once="user.email" gravatar-size="212"> </a> <h1 class="vcard-names"> <span class="vcard-fullname">{{user.fullName}}</span> <!--<span class="vcard-username">{{user.username}}</span>--> </h1> <!--\n  <ul class="vcard-details list-unstyled">\n    <li><span class="glyphicon glyphicon-envelope" aria-hidden="true"></span> <a href="mailto:{{user.email}}">{{user.email}}</a>\n    </li>\n  </ul>\n  --> <div class="vcard-memberships" data-ng-show="user.memberships.length"> <div class="panel panel-default"> <div class="panel-heading">Organisationen</div> <table class="table"> <tr data-ng-repeat="membership in user.memberships"> <td><a href="/{{membership.organizationFriendlyPath}}"> {{membership.organizationName}}</a> </td> </tr> </table> </div> </div> </div>'),a.put("views/goodbye.html","<h1>Abmelden</h1> <p>Auf ein andermal...</p>"),a.put("views/login.html",'<h1>Anmelden</h1> <div class="container-fluid"> <div class="row"> <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6"> <form class="form-horizontal" ng-submit="login()" name="loginForm"> <div class="form-group"> <label class="control-label col-sm-3" for="username">E-Mail-Adresse</label> <div class="col-sm-9"> <input class="form-control" type="text" data-ng-model="username" placeholder="E-Mail-Adresse" id="username" required autofocus> </div> </div> <div class="form-group"> <label class="control-label col-sm-3" for="password">Passwort</label> <div class="col-sm-9"> <input class="form-control" type="password" data-ng-model="password" placeholder="Passwort" id="password" required> </div> </div> <!--\n        <div class="form-group">\n          <div class="checkbox col-sm-offset-3 col-sm-9">\n            <label>\n              <input type="checkbox" data-ng-model="rememberMe" /> Angemeldet bleiben\n            </label>\n          </div>\n        </div>\n        --> <div class="form-group"> <div class="col-sm-offset-3 col-sm-9"> <!-- data-ng-disabled="loginForm.$invalid" --> <button class="btn btn-default" type="submit">Anmelden</button> &middot; <a href="/account/resetpassword">Password vergessen?</a> &middot; <a href="/account/signup">Registrieren</a> </div> </div> </form> </div> </div> </div>'),a.put("views/logout.html","<h1>Abmelden</h1> <p>Du wirst abgemeldet...</p>"),a.put("views/main.html",'<!--<div class="jumbotron">\n  <h1>\'Allo, \'Allo!</h1>\n  <p class="lead">&nbsp;\n    <img src="images/yeoman.8cb970fb.png" alt="I\'m Yeoman"><br>\n    Always a pleasure scaffolding your apps.\n  </p>\n  <p><a class="btn btn-lg btn-success" ng-href="shop">zum Shop</a></p>\n</div>--><!--<div class="row marketing">\n  <h4>HTML5 Boilerplate</h4>\n  <p>\n    HTML5 Boilerplate is a professional front-end template for building fast, robust, and adaptable web apps or sites.\n  </p>\n\n  <h4>Angular</h4>\n  <p>\n    AngularJS is a toolset for building the framework most suited to your application development.\n  </p>\n\n  <h4>Karma</h4>\n  <p>Spectacular Test Runner for JavaScript.</p>\n</div>--> <h1>public</h1> <p>main.html</p> <div ui-view></div>'),a.put("views/manage/articles.html",'<ph-manage-navbar data-organization-id="organizationId"></ph-manage-navbar> <table class="table table-hover" data-st-table="displayedArticles" data-st-safe-src="articles"> <thead> <tr> <th colspan="5"><input st-search class="form-control" type="search" placeholder="Suchen..."></th> </tr> <tr> <th data-st-sort-default="true" data-st-sort="id">Id</th> <th data-st-sort="name">Name</th> <th class="text-right" data-st-sort="grossStock">Bestand</th> <th class="text-right" data-st-sort="price">Preis</th> <th class="text-right"><a class="btn btn-primary btn-sm" href="/orgs/{{organizationId}}/article/create">Neues Material</a></th> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedArticles"> <td>{{row.id}}</td> <td>{{row.name}}</td> <td class="text-right">{{row.grossStock}}</td> <td class="text-right">{{row.price | number:2}}</td> <td class="text-right"> <a class="btn btn-default btn-xs" href="/orgs/{{organizationId}}/article/Edit/{{row.id}}">Bearbeiten</a> <a class="btn btn-danger btn-xs" href="" data-ng-click="delete(row.id, row.name)">Löschen</a> </td> </tr> </tbody> </table>'),a.put("views/organization.html",'<ph-manage-navbar data-ng-show="organization" data-organization-id="organizationId"></ph-manage-navbar> <div class="row"> <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6"> <h2>{{organization.name}}</h2> <div data-ng-bind-html="startpage"></div> </div> <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6"> <div data-ng-show="relationship"> <h3>Mitgliedschaft</h3> <div data-ng-show="relationship.status == \'None\'"> <p>Du kannst dieser Organisation <a data-ng-click="join()" class="btn btn-default btn-sm">beitreten</a>.</p> </div> <div data-ng-show="relationship.status == \'Member\'"> <p>Du bist Mitglied seit {{relationship.timestamp | date: \'dd.MM.yyyy\'}}.</p> </div> <div data-ng-show="relationship.status == \'Application\'"> <p>Du hast die Mitgliedschaft am {{relationship.timestamp | date: \'dd.MM.yyyy\'}} beantragt.</p> </div> <div data-ng-show="relationship.status == \'Rejected\'"> <p>Dein Antrag zur Mitgliedschaft am {{relationship.timestamp | date: \'dd.MM.yyyy\'}} abgelehnt.</p> <p>Du kannst die Mitgliedschaft erneut <a data-ng-click="join()" class="btn btn-default btn-sm">beantragen</a>.</p> </div> </div> <div data-ng-show="hasContactOptions()"> <h3>Kontakt</h3> <address data-ng-show="organization.address" data-ng-bind-html="organization.address|replace:\'\\r|\\n\':\'&lt;br&gt;\'"></address> <address> <div data-access-level="accessLevels.user" data-ng-show="organization.emailAddress"> E-Mail: {{organization.emailAddress|replace:\'@.*$\':\'\'}} AT <span style="display:none">null.</span><span>{{organization.emailAddress|replace:\'^.*@\':\'\'}}</span></div> <div data-ng-show="organization.website">Webseite: <a href="{{organization.website}}">{{organization.website}}</a></div> </address> </div> <div data-ng-show="organization.coordinate"> <h3>Karte</h3> <leaflet width="100%" height="400px" style="margin-bottom:10px"></leaflet> <p></p> </div> </div> </div>'),a.put("views/organizations.html",'<div class="row"> <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <h2>Organisationen</h2> <table class="table table-hover" data-st-table="displayedOrganizations" data-st-safe-src="organizations"> <thead> <tr> <th colspan="2"><input st-search class="form-control" type="search" placeholder="Suchen..."></th> </tr> <tr> <th data-st-sort-default="true" data-st-sort="name">Name</th> <th data-st-sort="address">Kontakt</th> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedOrganizations"> <td><a href="./{{row.url}}">{{row.name}}</a></td> <td>{{row.address|replace:\' *[\\r\\n]+ *\':\', \'}}</td> </tr> </tbody> </table> </div> <div class="col-xs-12 col-sm-12 col-md-12 col-lg-5"> <!--<div class="jumbotron">\n      <h2>Du möchtest deine eigene Organisation haben?</h2>\n      <p>Kontaktiere das phundus-Team über die Feedback-Funktion und wir kümmern uns drum!</p>\n      <p><a class="btn btn-primary btn-lg" href="/feedback" role="button">Zum Formular</a></p>\n    </div>--> </div> </div>'),
a.put("views/register.html","<h1>register</h1> <p>This is the register view.</p> <div ui-view></div>"),a.put("views/users.html",'<ul class="nav nav-tabs" style="margin-bottom:10px" data-ng-show="isHome"> <li ui-sref-active="active" role="presentation"> <a href="" ui-sref="users.home({userId: userId})"><span class="glyphicon glyphicon-user"></span></a> </li> <li ng-class="{ active: $state.includes(\'users.articles\')}" role="presentation"> <a href="" ui-sref="users.articles.index({userId: userId})">Material</a> </li> <li ui-sref-active="active" role="presentation"> <a href="" ui-sref="users.orders({userId: userId})">Bestellungen</a> </li> <!--<li ui-sref-active="active" role="presentation"><a href="" ui-sref="users.contracts({userId: userId})">Verträge</a></li>--> </ul> <ui-view>'),a.put("views/users/article-pills.html",'<div class="row"> <div class="col-sm-3"> <p class="text-center"> <a class="btn btn-default" href="" ui-sref="users.articles.index({userId: userId})"><span class="glyphicon glyphicon-arrow-left"></span> Zurück</a> </p> <ul class="nav nav-pills nav-stacked"> <li role="presentation" ui-sref-active="active"> <a href="" ui-sref="users.articles.article.details({userId: userId, articleId: articleId})">Eigenschaften</a> </li> <li role="presentation" ui-sref-active="active"> <a href="" ui-sref="users.articles.article.files({userId: userId, articleId: articleId})">Dateien</a> </li> <li role="presentation" ui-sref-active="active"> <a href="" ui-sref="users.articles.article.categories({userId: userId, articleId: articleId})">Kategorien</a> </li> </ul> </div> <div class="col-sm-9"> <ui-view></ui-view> </div> </div>'),a.put("views/users/articles.html",'<table class="table table-hover" data-st-table="displayedCollection" data-st-safe-src="rowCollection"> <thead> <tr> <th data-st-sort-default="true" data-st-sort="id">Id</th> <th data-st-sort="caption">Bezeichnung</th> <th class="text-right"><!--<a href="">Neues Material</a>--></th> </tr> </thead> <tbody> <tr data-ng-repeat="row in displayedCollection"> <td>{{row.id}}</td> <td>{{row.caption}}</td> <td class="text-right"><a href="" ui-sref="users.articles.article.details({userId: userId, articleId: row.id })">Edit</a></td> </tr> </tbody> </table>'),a.put("views/users/contracts.html",'<div class="alert alert-info" role="alert"> <p><strong>Notiz</strong></p> <p>Dieses Feature ist noch nicht implementiert.</p> </div>'),a.put("views/users/home.html",'<div class="row" data-ng-show="loaded"> <ph-user-vcard class="col-sm-4 col-xs-12" data-user="user"></ph-user-vcard> <div class="col-sm-8 col-xs-8" data-ng-hide="store"> <div class="jumbotron" data-ng-show="isHome"> <button class="btn btn-default" data-ng-click="openStore()">Eigene Materialstelle eröffnen</button> </div> <div class="jumbotron" data-ng-hide="isHome"> <p>Dieser Benutzer hat keine eigene Materialstelle eröffnet.</p> </div> </div> <ph-user-store class="col-sm-8 col-xs-12" data-store="store" data-map="map" data-is-editable="isHome"></ph-user-store> </div>'),a.put("views/users/orders.html",'<table class="table" data-st-table="displayedCollection" data-st-safe-src="rowCollection"> <thead> <tr> <th data-st-sort-default="true" data-st-sort="id">Nummer</th> <th data-st-sort="organizationName">Organisation</th> <th data-st-sort="createdUtc">Erstellt</th> <th data-st-sort="status">Status</th> <th data-st-sort="modifiedUtc">Bearbeitet</th> <th></th> </tr> </thead> <tbody> <tr data-ng-repeat="order in displayedCollection"> <td>{{order.orderId}}</td> <td>{{order.organizationName}}</td> <td> <ph-date value="order.createdUtc"></ph-date> </td> <td>{{order.status | orderStatusText}}</td> <td> <ph-date value="order.modifiedUtc"></ph-date> </td> <td class="text-right"> <!--\n      <a class="btn btn-default btn-small" data-ng-click="openOrder(order)">Öffnen</a>\n      --> <a class="btn btn-default btn-sm" href="/api/orders/{{order.orderId}}.pdf">PDF</a> </td> </tr> </tbody> </table>')}]);